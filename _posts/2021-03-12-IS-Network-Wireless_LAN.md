---
title: 정보보안 - 무선랜(Wireless LAN) 보안
date: '2021-03-12 15:00:00'
tags:
- 정보보안기사
- 네트워크
related: true
categories:
- IS_Certification
toc: true
---

# 무선 네트워크 유형
- WPAN : Wireless Personal Area Network
    + 별도의 무선장비가 필요없음
        * Bluetooth
        * USN (Ubiquotous Sensor Network)
    + 소규모 무선 네트워크
    + 단거리 네트워크
- WLAN : Wireless Local Area Network
    + 근거리 네트워크
        * 학교, 회사
    + 안전 관리가 중요
- WMAN : Wireless Metropolitan Area Network
    + 도시규모 네트워크
    + IEEE 802.16 표준 사용
        * WiMAX > Mobile WiMAX = Wibro

# 무선랜 표준
- **802.11 (1997)** : 주파수 대역 2.4GHz, 속도 20~100MBps
    + 전송방법 > ISM : Industrial Scientific Medical 3 종류
    + 암호화방식
        * WEP
            - 무선 AP 와 단말기 간 송수신
            - 공유 비밀키와 IV (초기벡터) 를 이용, 64 or 128 Bit 암호화
- 802.11a (1999) : 주파수 대역 5GHz, 속도 35~120MBps
    + 주파수가 다르므로 타 방식과 호환 X
        * Bluetooth 등의 간섭을 받지 않음 > 통신위성 등이 사용
- 802.11b (1999) : 주파수 대역 2.4GHz, 속도 38~140MBps
- 802.11g (2003) : 주파수 대역 2.4GHz, 속도 38~140MBps
    + 가장 많이 사용
- **802.11i (2004)** : 가장 보안상 안전한 방식으로 알려짐
    + 무선장비와 단말기 간의 가상인증기능 (EAP) 을 제공
        * Extensible Authentication Protocol
    + 인증과 데이터 암호화 강화
    + WPA
        * WPA 개인 > PSK 모드
            - PSK : 인증서버 설치 X > 소규모
            - CCMP 암호화 (WPA-2)
                + 128Bit AES 블록 암호화
                + Counter Mode, CBC MAC Mode 이용 
        * WPA 기업(엔터프라이즈) > Radius 인증
            - EAP / Radius : Radius 인증서버
            - TKIP 암호화 (WPA-1) : WEP(802.11) 의 문제점 보완
- 802.11n (2009) : 주파수 대역 2.4 ~ 5GHz, 속도 70~250MBps
    + MIMO 안테나, 수신장비를 통한 성능 향상 목적

# 무선랜 환경
- 상용 무선랜 환경
    + 이동통신사가 고객 서비스용으로 구축
    + USIM 이나 MAC, ID/PW 로 사용
- 공중 무선랜 환경
    + 공공기관, 호텔, 까페 등에서 불특정 다수에게 서비스
    + 보안상 취약
- 사설 무선랜 환경
    + 일반공유기를 통해 사용
- 기업 무선랜 환경
    + 기업 내부 업무용으로 구축

# 무선랜 네트워크 (WLAN) 유형 (802.11)
- 장비 설명
    + 단말기
    + 무선 AP
        * 유선랜 말단에 연결
        * 무선 네트워크 관련 여러 설정값을 가지고 있음
        * 무선표준에 따라 서비스 범위가 다름
    + 무선 브릿지
        * 2개 이상의 무선 랜을 연결하는 장비
    + 무선랜카드
        * 무선통신을 위해 전파를 송수신하는 장비
        * 단말기, AP 장비에 장착
    + 무선랜안테나
        * 무선전파를 멀리 송수신하기 위한 장비
        * 지향성 / 무지향성 : 방향의 유무
    + 사용자 인증서버
        * 무선랜 사용자의 인증을 위한 장비
        * 인증키 관리
- infrastructure 모드 (Client / Server)
    + 무선 AP와 단말기 간 통신
        * 단말기간 직접 통신이 불가, 무선 AP 를 경유 통신
    + 1개 이상의 무선 AP로 구성
        * 무선 AP 는 기업용 백본이나 초고속 인터넷 라인에 연결
        * BSS(Base Service Sets) : 무선 AP 와 무선단말기의 최소 규모 무선랜
        * DS(Distribution System) : 여러 개의 BSS를 포함
        * ESS(Extended Service Set) : 802.11 표준에서는 다수의 BSS 를 갖는 네트워크를 일컬음
- Ad-hoc 모드 (Peer to Peer)
    + AP 없이 단말기 간 통신
    + 보안 취약
        * 암호화의 신뢰성 구축 필요
            - 많은 단말기들을 그룹화
            - 그룹 별 대표 노드 설정 (서버노드 역할)
                + 그룹의 대표로 공개키를 교환
    + 성능 제한, 전원 제한
    + 라우팅 문제
        * 단말의 이동, 성능과 전원 제한 : Reactive Route (반응경로) 사용

# 무선랜 보안 취약점
- 무선인터넷 서비스의 취약점
    + WEP (Wired Equivalent Privacy) : 802.11 에서 없었고, 802.11b 에서 추가
        * 인증과정
        * 무선전송데이터의 암호화
        * 최근에는 사용하지 않음
    + 공격방법
        * AP DoS
        * 불법 AP (정보유출)
- 물리적 보안 취약점 (무선장비)
    + 무선 AP : 외부에 노출되어 있음
        * 문제점
            - 도난, 파손
            - 리셋에 의한 구성 설정 초기화
            - 전원차단
            - LAN 차단 (내부네트워크 케이블 절체)
        * 해결책
            - 비인가자 접근금지
    + 무선단말기 : 노트북, 스마트폰 등
        * 해결책
            - 로그인 등의 락, 비인가자 접근금지
- 기술적인 취약점
    + 도청 가능성이 높음
        * 문제점
            - 전파 이용 : 공기를 전송매체로 사용 (브로드캐스트)
            - AP 에서 전송하는 전파를 도청
            - 무선랜 분석 S/W 를 이용해 정보 획득 (Net Stumbler)
            - SSID : Service Set Identifier > 무선랜 구분 식별자
                + 무선랜 목록에 뜨는 이름과 비슷
            - 암호화 방식
            - 속도
        * 해결책
            - 전송시 암호화
    + 서비스거부 (DoS)
        * 문제점
            - 무선 AP에 대량의 무선 패킷을 전송
                + 강한 방해전파를 송신에 통신에 문제를 일으킴
                + 클라이언트는 SSID 를 이용 Probe Request 를 무선 AP에 전송
                + 무선 AP는 클라이언트에 Probe Response 전송
                + Attacker 는 대량으로 Probe Request 를 전송
                + 무선 AP는 Attacker 에게 Probe Response를 전송 (부하)
        * 해결책
            - 별도의 유선 LAN 을 마련
    + 불법 AP (Rogue AP)
        * 문제점
            - 설치 유무를 탐지하는 것은 어렵지 않으나, 장소를 특정하기 어려움
        * 해결책
            - 설치가 되지 않도록 함
    + 무선암호화
        * WEP
            - 64 bit key 이용
                + MAC Frame (비밀 공유키) 40 bit
                + IV (Initialization Vector) 24bit
            - RC4 알고리즘 (64 bit key)
                + 취약점이 많은 알고리즘 : 거의 사용하지 않음
            - 동일한 패스워드 문장으로 4개의 공유키를 생성하여 그중 1개를 택
            - 선택된 공유키, 키 ID, Value 값을 평문으로 상대에게 알려줌
            - IV 길이 24 비트의 길이가 너무 짧기 때문에 재사용이 될 수 있음
            - 키 길이 (64 bit) 가 너무 짧음ㄱ
        * WPA/WPA2 (WEP 보다 안전)
            - Preshared Key : PSK
                + 인증서버가 설치되어 있지 않은 소규모 망에서 사용
                + 인증단계에서 사용 (4Way-Handshaking)
                + PSK 값을 전송패킷의 수집을 통해 추측가능 취약점
                + 알아내기 어려움
                + 해결책
                    * 긴 길이의 비밀키 설정
                    * 추가적으로 인증서버 사용 권장
            - 802.1x / EAP
    + 비인가 접근 (SSID 노출)
        * 무선랜은 기본적으로 개방형 인증방식을 사용 > 별도 인증절차 없음
        * 브로드캐스팅 된 SSID 의 노출로 비인가 접근이 가능
        * 공격자는 공격에 사용되는 기본적 정보를 획득 가능
    + 비인가 접근 (MAC 주소 노출)
        * 무선랜 환경에서는 접근제어를 위해 MAC 주소를 필터링함
            - 무선랜카드의 MAC 주소를 이용해 무선랜 서비스 접속을 제한
        * 공격자는 정상사용자의 MAC 주소를 도용 > MAC 주소 필터링 무력화
        * 예:
            - Attacker : AA-BB-CC-01-02-03
            - AP : MAC 정보를 DB와 하여 관리
            - 정상건 : 
                + 1. Attacker : 접속 요청
                + 2. AP : MAC 확인
                + 3. AP : 접속제한
            - 비인가 접근 : > 내부 네트워크까지 접속할 수 있는 보안상 문제 발생
                + 1. Attacker : 정상사용자의 MAC 정보 수집
                + 2. Attacker : 정상사용자 MAC 도용
                + 3. Attacker : 접속 요청
                + 4. AP : MAC 확인
                + 5. AP : 접속허용
- 관리적인 취약점
    + 무선랜 장비에 대한 관리 미흡
        * 문제점
            - 대부분 기관에서는 AP 의 개수정도만 파악하고 있음
        * 해결책
            - AP, 무선랜카드 장비 운영 현황, 사용자 현황 등을 파악해야 함
            - 기본값, 초기값 재설정 필요
    + 사용자 보안 의식 결여
        * 문제점
            - 사용자 보안 정책을 따르지 않음
                + 보안기능 설정을 하지 않는 것
                + 협력업체, 외부 관계자에게 보안설정값, 암호키값 유출
        * 해결책
            - 무선랜 관리자, 사용자의 보안 의식 고취
    + 전파 출력에 대한 관리 부족
        * 문제점
            - 유선 네트워크 관리자가 무선 네트워크 관리를 겸하는 경우 전파 자원 관리의 미흡
            - 무선랜 채널 설정 미흡 (주파수 간섭이 일어나지 않도록 채널 설정 필요)
                + 주변 AP 와 3 채널 이상 떨어져야 전파 간섭이 일어나지 않음
        * 해결책
            - 전파 출력 조정이 필요 (외부로 전파가 유출되지 않도록 함)

# 무선랜 사용자 인증 취약성과 대응 기술

- SSID 설정과 폐쇄시스템 운영
    + SSID 설정
        * SSID : AP가 제공하는 무선랜망 구별을 위한 식별자
        * SSID 신호는 기본설정값 : 브로드캐스트로 제공
            - 무선랜 관리자가 SSID를 브로드캐스트 하지 않음 (숨김모드)
                + SSID 를 아는 사람만 접속 가능 (인가된 사용자)
                + 공격자는 SSID를 알아낼 수 있으나 시간/자원 소모 (분석도구 활용)
        * 읽고 기억하기 쉬운 값(기관이름 등)으로 설정
    + 폐쇄시스템 운영
        * 폐쇄시스템 : 네트워크에 개방된 자원이 없도록 관리
            - 공유폴더를 네트워크에 개방 X
            - 공유폴더를 반드시 사용해야 하는 경우 암호 설정, 사용자 설정
    + SSID 숨김 모드 + 접근제한 규칙 적용
        * USER : AP 에 연결 요청 (SSID 값을 미리 알아야 함/채널 값 바꿔가며 전송)
        * AP : USER 에 연결요청 응답
        * USER : AP 에 인증 정보 전송
        * AP : USER 접속 허용
        * (USER는 단말기 IP, 서브넷 MASK, GATEWAY, DNS 설정이 되어야 함)
        * (USER : AP 의 DHCP 활용)
- MAC 주소 인증
    + MAC 주소 필터링
        * 무선 LAN 카드에도 MAC 주소가 존재
        * 1. AP 에 무선 LAN 카드의 MAC 주소를 사전에 등록
            - 무선단말기의 MAC 주소를 일괄 등록해주는 작업이 필요
        * 2. 스위치 / 라우터에 MAC 주소 등록
            - 스위치 / 라우터에 부하가 걸리는 문제가 발생
                + 경로 설정, 데이터 전송 설정에 부하
        * 3. 인증 서버에 MAC 주소 등록
            - AP 에 저장하는 경우 AP의 메모리 소모
            - 인증서버 사용 시 MAC 주소 정보 저장 한계 극복
            - 각 AP마다 관리하던 MAC 주소를 한 곳에서 관리
            - 동적 WEP 적용 가능
            - IEEE 802.1X EAP 인증기능 사용 가능
    + 장점
        * 인가된 사용자만 접근
        * 간단한 보안설정
        * 여러 접근제어 수행 가능
    + 단점
        * 장비 관리에 노력 필요 (MAC 주소 노출 등 문제)
        * MAC 주소 관리 리소스 필요 (관리 어려움)
- WEP 인증 메커니즘
    + 개요
        * 유선에서 제공하는 수준의 보안을 제공하기 위한 목적
            - Data 암호화
            - 사용자 인증
    + 절차
        * 같은 공유키를 갖는 사용자를 정상적인 사용자로 인식
        * 사용자 : AP 연결 요청 (SSID)
        * AP : 임의의 문장 생성 후 원본 저장
        * AP : 연결 요청 응답 ( + 문장 전송)
        * 사용자 : 암호문 전송 (자신이 가진 공유키로 문장 암호화(WEP))
        * AP : 자신의 키로 복호화, 원본과 비교 후 연결 허용
    + 인증 메커니즘의 취약점
        * 단방향 인증방식에 대한 취약성
            - Clone AP (복제 AP) 로 인한 피해
                + 복제 AP 는 강력한 신호로 사용자를 속이고, 거짓 인증을 요구해 사용자 인증정보를 취득
                + 인증 결과에 관계없이 통신을 사용할 수 있게 해주고, 데이터를 스니핑
                + AP는 사용자를 검증하나, 사용자는 AP를 검증하지 않음
            - 업체나 기관에서 AP 가 정상 AP 인지 확인해야 함
        * 고정된 공유키 취약점
            - 무선 랜을 사용하는 모든 장비가 동일 고정 키를 사용
                + 키가 외부로 유출될 확률이 높음
            - 협력업체 직원, 방문객, 퇴사자 등을 통해 WEP 값이 외부로 노출 될 수 있음
                + WEP 값 주기적으로 변경 필요
                    * 사용자 / 무선랜 장비가 많을 경우 주기적 변경에 어려움
            - 동적 WEP
                + 무선 랜 환경에서 인증서버 적용
                    * 인증서버가 서로 다른 WEP 값을 배분
                    * 시간이 지나면 사용자에게 WEP 키 값을 갱신 요청
                + AP 가 동적 WEP (802.1X) 를 지원해야 함
                + 관리 패킷의 증가로 성능 저하가 있을 수 있음
                + 여전히 단방향 인증방식임
- EAP 인증 메커니즘 (확장 인증 프로토콜)
    + 개요
        * Extensible Authentication Protocol
        * 초기 PPP (Point to Point Protocol) 에서 사용될 수 있도록 개발
        * 현재 IEEE 802.1X (무선랜) 에서 사용
        * 다양한 인증방식 에서 사용할 수 있음
            - MD5, TLS, TTLS (터널 방식 TLS), PEAP ...
            - PPP, 802.3, 802.11 ...
    + 동작방식
        * USER : AP에 802.11 연결 요청 
            - EAPOL 프로토콜 : EAP over LAN - 랜을 통해 요청
        * AP : USER 에 연결 응답
        * USER : AP에 EAPOL-시작 메시지 전송 << 사용자 인증 방법 시작 부분
        * AP : USER에 EAPOL 요청메시지 + AP 식별자
        * USER : AP에 EAPOL 응답메시지 (사용자 명, 암호) + 식별자
        * AP : 인증서버에 RADIUS 접속 요청
        * 인증서버 : AP에 RADIUS 접속 Challenge 전송
        * AP : USER에 EAPOL 요청메시지 + Challenge
        * USER : AP에 EAPOL 응답 (Hash 메시지 전송)
        * AP : 인증서버에 RAIDUS 접속 요청
        * 인증서버 : USER 의 응답메시지 비교 후 AP에 접속 허용 전달
        * AP : USER에 EAPOL 인증 성공 
    + EAP 인증 방법
        * EAP-MD5
            - 단방향 인증방식 이용 
            - PW 기반
            - MD5 Challenge (MD5는 동적 WEP X)
            - 인증 소요시간이 짧음
        * EAP-TLS (인증서 기반, 양방향 인증, 인증서 관리, PW 방식보다 보안 강력)
            - AP : USER 에 연결 응답
            - USER : AP에 EAPOL-시작 메시지 전송 << 사용자 인증 방법 시작 부분
            - AP : USER에 EAPOL 요청메시지 + AP 식별자
            - USER : AP에 EAPOL 응답메시지 (사용자 명, 암호) + 식별자
            - AP : 인증서버에 RADIUS 접속 요청
            - (AP 는 중간에서 중계)
            - 인증서버 : USER에 EAP 요청/TLS Start 전송
            - USER : 인증서버에 TLS Client Hello 전송
            - 인증서버 : 서버 인증서정보, Server Hello 전송
            - USER : 서버 인증서를 토대로 서버인증, 클라이언트 인증서정보 전송
            - 인증서버 : Challenge Cipher Spec 전송
            - USER : 응답메시지 전송
            - 인증서버 : 인증성공 메시지 전송
        * EAP-TTLS (CHAP, OTP)
            - 인증서 개수가 줄어듬
            - 관리 용이
            - 사용자는 TTLS 서버로부터 부여된 인증서를 인증
            - 최종 사용자 익명성 보장
            - RADIUS DATABASE 재사용
            - 구성이 복잡
                + USER, AP, TTLS 서버, 인증서버
            - (앞 부분 생략)
            - TTLS서버 : USER 에 TTLS START 전송
            - USER : TTLS서버에 Client Hello 전송
            - (서버 인증정보 전송)
            - TTLS서버 : USER 에 암호에 관한 정보 전송
            - (TLS 터널에 관한 프로세스)
                + TTLS서버 : 인증서버에 Challenge 에 관한 정보 전송 (USER 가 요청함)
                + 인증서버 : TTLS 서버에 접속 허용 응답메시지 전송
                + TTLS서버 : USER 에 접속 성공 메시지 전송
        * PEAP
            - 터널링방식
            - 구성
                + USER, AP, PEAP서버, 인증서버
            - PEAP 서버를 이용하여 터널링을 구성하고 인증서버로 인증 (TTLS 와 유사)
            - 구현이 어려움 (접속 지연시간 발생 가능)
            - 관리 용이

# WEP 암호와 원리와 동작방식
- 개요
    + 동일한 공유키를 가진 사용자끼리 메시지 전송 가능
    + 공유키를 이용한 사용자인증 기능 제공
- 기본원리
    + AP와 무선단말기 간 공유키 사용
        * 송신 : 평문과 Key Stream(동일) 간 XOR 연산을 통해 암호문을 만들고 전송
        * 수신 : 암호문과 Key Stream(동일) 을 XOR 연산을 통해 평문으로 복호화
    + 동일 공유키의 반복사용에 따른 보안 취약점
        * PNRG(Pseudo Random Number Generator) : 키 값에 따라 발생하는 난수를 키스트림으로 이용함
-  WEP (위의 방법보다 개선)
    +  암호화과정
        *  공유키 대신 초기백터(IV) + WEP키를 결합
        *  WEP PRNG(RC4) 이용하여 KEY 스트림 생성
        *  평문 + ICV(Integrity Check Value) 과 XOR 연산
            -  ICV : CRC32 알고리즘으로 구성, 전송 도중 데이터 무결성 보장을 위함
        *  암호문 생성
        *  IV + 암호문 결합 -> 802.11 패킷으로 구성
            -  802.11 프레임 헤더 | IV | 암호문 | FCS (Frame Check Seq)
                +  패킷 프레임
            -  무선랜으로 전송
    +  복호화과정
        *  수신한 패킷 중 IV|암호문 부분 추출
        *  IV (추출) 와 공유키 결합
        *  WEP PRNG(RC4) 이용하여 KEY 스트림 생성
        *  암호문과 XOR 연산을 통해 평문|ICV 값 복호화
        *  평문을 뽑아내고, 평문을 CRC32 알고리즘을 통해 나온 값을 ICV 와 비교