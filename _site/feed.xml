<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.2.0">Jekyll</generator><link href="https://bluesplatter.com/feed.xml" rel="self" type="application/atom+xml" /><link href="https://bluesplatter.com/" rel="alternate" type="text/html" /><updated>2022-01-27T17:46:51+09:00</updated><id>https://bluesplatter.com/feed.xml</id><title type="html">Bluesplatter</title><subtitle>전문적이지 않은 정보들, 감상, 즉흥적인 내용들</subtitle><author><name>HY03</name><email>hyunik03@gmail.com</email></author><entry><title type="html">정보보안 - snort</title><link href="https://bluesplatter.com/is_certification/IS-IncidentAnalysis-snort/" rel="alternate" type="text/html" title="정보보안 - snort" /><published>2022-01-26T09:00:00+09:00</published><updated>2022-01-26T09:00:00+09:00</updated><id>https://bluesplatter.com/is_certification/IS-IncidentAnalysis-snort</id><content type="html" xml:base="https://bluesplatter.com/is_certification/IS-IncidentAnalysis-snort/">&lt;h1 id=&quot;snort&quot;&gt;snort&lt;/h1&gt;
&lt;ul&gt;
  &lt;li&gt;개요
    &lt;ul&gt;
      &lt;li&gt;IDS (네트워크 이상징후 감시) 중 하나
        &lt;ul&gt;
          &lt;li&gt;모든 트래픽을 감시하거나 샘플링을 통해 감시&lt;/li&gt;
          &lt;li&gt;미리 설정값을 저장&lt;/li&gt;
          &lt;li&gt;DB 와 비교, 알려진 공격 시그니처와 비교&lt;/li&gt;
          &lt;li&gt;공격자의 침입 경로 Block&lt;/li&gt;
          &lt;li&gt;사용자의 패턴을 분석해서 이상징후 탐지&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;마틴 로시가 1998 년에 sniffer and more 라는 표어 (네트워크 트래픽을 더 많이 감시) 로 개발&lt;/li&gt;
      &lt;li&gt;프로토콜 검색, 컨텐츠 분석, 웜, 취약점 공격시도 탐지, 포트스캔, CGI&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;기능
    &lt;ul&gt;
      &lt;li&gt;snort 의 운영모드
        &lt;ul&gt;
          &lt;li&gt;Sniffer Mode&lt;/li&gt;
          &lt;li&gt;Packet Logger Mode&lt;/li&gt;
          &lt;li&gt;Network IDS/IPS Mode&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;패킷 스니퍼
        &lt;ul&gt;
          &lt;li&gt;패킷 스니핑을 통해 계속 화면에 출력 -&amp;gt; 작은 네트워크 규모에서 사용&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;패킷 로거
        &lt;ul&gt;
          &lt;li&gt;로그 남기기&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;네트워크 IDS/IPS
        &lt;ul&gt;
          &lt;li&gt;네트워크 트래픽 분석을 통한 공격 탐지/차단&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;설치
    &lt;ul&gt;
      &lt;li&gt;RHEL (CentOS) 기준
        &lt;ul&gt;
          &lt;li&gt;DAQ (Data Acquistion Package) 설치&lt;/li&gt;
          &lt;li&gt;Snort 패키지 설치&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;Talos(제작사) 에서 Ruleset(최근 공격 패턴을 탐지할 수 있는) 을 만들어 배포&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Snort 구조
    &lt;ul&gt;
      &lt;li&gt;sniffer : 패킷을 보기 좋게 Decode&lt;/li&gt;
      &lt;li&gt;preprocessor : 비정상 헤더구조 패킷, 트래픽 구분&lt;/li&gt;
      &lt;li&gt;Detection Engine : Rule 기반의 탐지 엔진, 사전 정의된 Rule 에 매칭 되는지 확인, Payload 확인&lt;/li&gt;
      &lt;li&gt;Alert / logging : Ruleset 에 일치하는 패킷에 대한 처리방법, SMB, SNMP, trap 등을 활용해 저장&lt;/li&gt;
      &lt;li&gt;설정값 저장 위치 : &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc/snort/snort.conf&lt;/code&gt;
        &lt;ul&gt;
          &lt;li&gt;모니터링하고자 하는 Network 설정&lt;/li&gt;
          &lt;li&gt;Rules 위치 수정&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Snort 명령어
    &lt;ul&gt;
      &lt;li&gt;Sniffer Mode
        &lt;ul&gt;
          &lt;li&gt;TCP/IP 패킷 헤더를 출력 : &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;snort -v&lt;/code&gt;&lt;/li&gt;
          &lt;li&gt;TCP/ICMP/UDP 헤더와 IP를 출력 : &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;snort -vd&lt;/code&gt;&lt;/li&gt;
          &lt;li&gt;패킷 데이터를 추가해서 표현하기 위한 명령어 : &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;snort -vde&lt;/code&gt;&lt;/li&gt;
          &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-v&lt;/code&gt; : snort 를 패킷 sniffing 모드로 변경&lt;/li&gt;
          &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-d&lt;/code&gt; : 모든 네트워크 계층 포함&lt;/li&gt;
          &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-e&lt;/code&gt; : 데이터링크 계층의 헤더를 포함&lt;/li&gt;
          &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-c&lt;/code&gt; : 패킷 검출&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Snort Rule / Signature
    &lt;ul&gt;
      &lt;li&gt;Header
        &lt;ul&gt;
          &lt;li&gt;내용
            &lt;ul&gt;
              &lt;li&gt;처리방식&lt;/li&gt;
              &lt;li&gt;프로토콜&lt;/li&gt;
              &lt;li&gt;IP주소&lt;/li&gt;
              &lt;li&gt;포트번호&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;Rule 헤더 설정
            &lt;ul&gt;
              &lt;li&gt;Rule Actions
                &lt;ul&gt;
                  &lt;li&gt;패킷이 탐지되었을 때 처리방식&lt;/li&gt;
                  &lt;li&gt;8가지 유형이 존재
                    &lt;ul&gt;
                      &lt;li&gt;alert : 알람을 발생시키고 로그를 남김&lt;/li&gt;
                      &lt;li&gt;log : 패킷을 로그에 남김&lt;/li&gt;
                      &lt;li&gt;pass : 패킷을 무시함&lt;/li&gt;
                      &lt;li&gt;activate : alert 을 발생시키고, dynamic rule을 활성화&lt;/li&gt;
                      &lt;li&gt;dynamic : activate rule 에 의해 활성화 되고, log rule 과 동일하게 동작&lt;/li&gt;
                      &lt;li&gt;drop : 패킷을 차단하고 로그에 남김&lt;/li&gt;
                      &lt;li&gt;reject : 패킷을 차단하고 로그를 남김, 메시지를 전달
                        &lt;ul&gt;
                          &lt;li&gt;TCP : TCP RST&lt;/li&gt;
                          &lt;li&gt;UDP : ICMP port Unreachable&lt;/li&gt;
                        &lt;/ul&gt;
                      &lt;/li&gt;
                      &lt;li&gt;sdrop : 패킷을 차단하지만 로그를 남기지 않음 (silent drop)&lt;/li&gt;
                    &lt;/ul&gt;
                  &lt;/li&gt;
                  &lt;li&gt;Rule 이 매칭 되었을 때 처리방식&lt;/li&gt;
                &lt;/ul&gt;
              &lt;/li&gt;
              &lt;li&gt;Protocols
                &lt;ul&gt;
                  &lt;li&gt;탐지할 프로토콜을 설정.&lt;/li&gt;
                  &lt;li&gt;TCP, IP, UDP, ICMP&lt;/li&gt;
                &lt;/ul&gt;
              &lt;/li&gt;
              &lt;li&gt;IP Addresses
                &lt;ul&gt;
                  &lt;li&gt;출발지, 목적지 IP 주소.&lt;/li&gt;
                  &lt;li&gt;단일 IP, IP대역(CIDR표기), IP 리스트 (구분자:,) 등으로 표기, 부정연산자(!) 표현가능&lt;/li&gt;
                &lt;/ul&gt;
              &lt;/li&gt;
              &lt;li&gt;Port Numbers
                &lt;ul&gt;
                  &lt;li&gt;출발지, 목적지 Port&lt;/li&gt;
                  &lt;li&gt;단일 Port, Port Range (:이용), Port 리스트 표현
                    &lt;ul&gt;
                      &lt;li&gt;1:1023 : 1~1023&lt;/li&gt;
                      &lt;li&gt;:39910 : 1 ~ 39910&lt;/li&gt;
                    &lt;/ul&gt;
                  &lt;/li&gt;
                &lt;/ul&gt;
              &lt;/li&gt;
              &lt;li&gt;Direction Operator
                &lt;ul&gt;
                  &lt;li&gt;방향 지시자
                    &lt;ul&gt;
                      &lt;li&gt;출발지 -&amp;gt; 목적지 (단방향)&lt;/li&gt;
                      &lt;li&gt;출발지 &amp;lt;&amp;gt; 목적지 (양방향)&lt;/li&gt;
                      &lt;li&gt;출발지 &amp;lt;- 목적지 : 이러한 표현은 사용하지 않음&lt;/li&gt;
                    &lt;/ul&gt;
                  &lt;/li&gt;
                &lt;/ul&gt;
              &lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;형태 : &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;action protocol ipaddr port direction ipaddr port&lt;/code&gt;
            &lt;ul&gt;
              &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;alert tcp any any -&amp;gt; 192.168.59.0/24 80&lt;/code&gt;
                &lt;ul&gt;
                  &lt;li&gt;192.168.59 대역의 80 포트에 들어오는 패킷을 탐지&lt;/li&gt;
                &lt;/ul&gt;
              &lt;/li&gt;
              &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;log tcp $EXTERNAL_NET any &amp;lt;&amp;gt; $HOME_NET 80&lt;/code&gt;
                &lt;ul&gt;
                  &lt;li&gt;외부 네트워크 IP 에서 내부 네트워크 80 포트간 송수신되는 패킷을 탐지&lt;/li&gt;
                  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$EXTERNAL_NET&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$HOME_NET&lt;/code&gt; : &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;snort.conf&lt;/code&gt; 에 정의된 환경변수&lt;/li&gt;
                &lt;/ul&gt;
              &lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;Body : 옵션 설정
        &lt;ul&gt;
          &lt;li&gt;내용
            &lt;ul&gt;
              &lt;li&gt;패킷탐지 규칙을 명시&lt;/li&gt;
              &lt;li&gt;snort 설정 generator 를 사용하여 간편하게 입력하는 방법도 존재&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;종류
            &lt;ul&gt;
              &lt;li&gt;일반&lt;/li&gt;
              &lt;li&gt;Payload / 범위 관련&lt;/li&gt;
              &lt;li&gt;Payload / 정규표현식&lt;/li&gt;
              &lt;li&gt;Payload / HTTP&lt;/li&gt;
              &lt;li&gt;이벤트 제한 관련&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;일반 옵션 설정
            &lt;ul&gt;
              &lt;li&gt;msg : alert, log 출력 시 이벤트 명으로 사용&lt;/li&gt;
              &lt;li&gt;reference : rule 과 관련된 외부 취약점 정보 참조시 사용&lt;/li&gt;
              &lt;li&gt;sid : 룰 식별자
                &lt;ul&gt;
                  &lt;li&gt;99이하 : 시스템 예약 sid&lt;/li&gt;
                  &lt;li&gt;100 ~ 1000000 : snort 에서 배포하는 ruleset 에서 사용하는 sid&lt;/li&gt;
                  &lt;li&gt;1000001 이상 : 사용자가 정의한 rule sid&lt;/li&gt;
                &lt;/ul&gt;
              &lt;/li&gt;
              &lt;li&gt;classtype : 공격유형, 기본우선순위(위험도) 정의&lt;/li&gt;
              &lt;li&gt;priority : 위험도에 대한 숫자, classtype 에서 지정한 우선순위(위험도) 를 덮어씀&lt;/li&gt;
              &lt;li&gt;rev : revision - rule 수정횟수&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;&lt;strong&gt;Payload / 범위 관련&lt;/strong&gt; : 범위를 지정해주는 옵션을 사용하면 성능 향상, 오탐을 줄임
            &lt;ul&gt;
              &lt;li&gt;옵션
                &lt;ul&gt;
                  &lt;li&gt;&lt;strong&gt;content&lt;/strong&gt; : Payload 에서 검사할 문자열 설정 (전체 Payload 비교)
                    &lt;ul&gt;
                      &lt;li&gt;문자열 설정 시 text, text/binary, binary 형태 중 하나로 설정, 부정연산자 사용 가능
                        &lt;ul&gt;
                          &lt;li&gt;text 형식 : &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;content:&quot;문자열&lt;/code&gt;&lt;/li&gt;
                          &lt;li&gt;binary 형식 : &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;content:&quot;|FFFF|문자열&quot;&lt;/code&gt;
                            &lt;ul&gt;
                              &lt;li&gt;FF : 헥사 값 예시&lt;/li&gt;
                            &lt;/ul&gt;
                          &lt;/li&gt;
                          &lt;li&gt;text/binary 형식 : &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;content:&quot;|FFFF|&quot;&lt;/code&gt;&lt;/li&gt;
                          &lt;li&gt;!(부정연산자) : &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;content:!&quot;문자열&quot;&lt;/code&gt; - 문자열이 없는 것&lt;/li&gt;
                          &lt;li&gt;Escape(&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;\&lt;/code&gt;) 처리 필요 문자 : &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;&quot;&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;;&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;\&lt;/code&gt;&lt;/li&gt;
                        &lt;/ul&gt;
                      &lt;/li&gt;
                    &lt;/ul&gt;
                  &lt;/li&gt;
                  &lt;li&gt;uricontent : HTTP Client 의 요청 URI (전체 Payload X) 에서 검사할 문자열 설정&lt;/li&gt;
                  &lt;li&gt;&lt;strong&gt;offset&lt;/strong&gt; : Payload 에서 Content 문자열을 검사할 시작 위치를 지정
                    &lt;ul&gt;
                      &lt;li&gt;Payload 의 첫 번째 바이트 위치는 0 부터 시작&lt;/li&gt;
                    &lt;/ul&gt;
                  &lt;/li&gt;
                  &lt;li&gt;&lt;strong&gt;depth&lt;/strong&gt; : offset 부터 몇 바이트까지 검사할 것인지 지정&lt;/li&gt;
                  &lt;li&gt;&lt;strong&gt;distance&lt;/strong&gt; : &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;content:&quot;문자열&quot;&lt;/code&gt; 이 매치된 경우
                    &lt;ul&gt;
                      &lt;li&gt;이후부터 몇 바이트 떨어진 위치에서 다음 content를 검사할 것인지 지정&lt;/li&gt;
                    &lt;/ul&gt;
                  &lt;/li&gt;
                  &lt;li&gt;&lt;strong&gt;within&lt;/strong&gt; : &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;content:&quot;문자열&quot;&lt;/code&gt; 이 매치된 경우
                    &lt;ul&gt;
                      &lt;li&gt;distance 부터 몇 바이트 범위 내에서 다음 content를 검사할 것인지 지정&lt;/li&gt;
                    &lt;/ul&gt;
                  &lt;/li&gt;
                  &lt;li&gt;nocase : Payload 검사 시 대소문자를 구분하지 않음 (바이너리 형식도 동일)&lt;/li&gt;
                &lt;/ul&gt;
              &lt;/li&gt;
              &lt;li&gt;예시 (29:10)
                &lt;ul&gt;
                  &lt;li&gt;FTP root 로그인 시도 탐지 (제공 Ruleset 사용)
                    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;      alert tcp any any -&amp;gt; 10.10.10.0/24 21
      (msg:&quot;FTP root user access&quot;;content:&quot;USER root&quot;;nocase;sid:100100;)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;                    &lt;/div&gt;
                  &lt;/li&gt;
                  &lt;li&gt;테스트 (content)
                    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;      alert tcp $EXTERNAL_NET any -&amp;gt; $HOME_NET any
      (msg:&quot;[TEST]content_text&quot;;content:&quot;/etc/passwd&quot;;nocase;sid:1000020;)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;                    &lt;/div&gt;
                  &lt;/li&gt;
                  &lt;li&gt;테스트 (offset) - 3번째 바이트부터 (2) 3바이트 이내(2~4)에 5457 문자열이 있는지 확인
                    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;      alert tcp $EXTERNAL_NET any -&amp;gt; $HOME_NET any
      (msg:&quot;[TEST]offset&quot;;content:&quot;5457&quot;;offset:2;depth:3;nocase;sid:1000030;)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;                    &lt;/div&gt;
                  &lt;/li&gt;
                  &lt;li&gt;테스트 (distance, within) - 3번째 바이트부터 (2) 5바이트 이내 (2~6) 에서 369 문자열을 찾고, 4바이트 (7,8,9,A) 떨어진 위치 (B) 에서부터 3바이트 이내 (B,C,D) 에서 ABC 문자열을 찾아 만족하면 알림 출력
                    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;      alert tcp $EXTERNAL_NET any -&amp;gt; $HOME_NET any
      (msg:&quot;[TEST]distance, within&quot;;content:&quot;369&quot;;offset:2;depth:5;content:&quot;ABC&quot;;distance:4;within:3;nocase;sid:1000034;)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;                    &lt;/div&gt;
                  &lt;/li&gt;
                &lt;/ul&gt;
              &lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;Payload / 정규표현식
            &lt;ul&gt;
              &lt;li&gt;정규표현식 : 일정 규칙을 갖는 문자열을 표현하는 방식&lt;/li&gt;
              &lt;li&gt;옵션 : PCRE (Perl Compatible Regular Expression) - Snort 에서는 Perl 기반 정규표현을 사용
                &lt;ul&gt;
                  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;pcre=&quot;/정규표현삭/&quot;&lt;/code&gt;&lt;/li&gt;
                &lt;/ul&gt;
              &lt;/li&gt;
              &lt;li&gt;메타문자
                &lt;ul&gt;
                  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;\&lt;/code&gt; : escape 문자로 사용 (특수문자 기능 제거)&lt;/li&gt;
                  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;^&lt;/code&gt; : 캐럿. 다음에 나오는 문자는 문자열의 시작을 의미&lt;/li&gt;
                  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$&lt;/code&gt; : $ 앞의 문자는 문자열의 끝을 의미&lt;/li&gt;
                  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.&lt;/code&gt; : 임의의 문자 한 개를 의미함&lt;/li&gt;
                  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;[]&lt;/code&gt; : 집합 안에 지정한 문자들 중 하나와 일치
                    &lt;ul&gt;
                      &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;[a-zA-Z]&lt;/code&gt; : 소문자 a-z 사이 + 대문자 A-Z 사이 중 한 문자와 일치&lt;/li&gt;
                      &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;[0-9]&lt;/code&gt; : 0~9 사이의 숫자 중 하나&lt;/li&gt;
                    &lt;/ul&gt;
                  &lt;/li&gt;
                  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;[^]&lt;/code&gt; : 집합 안에 지정한 문자들을 제외한 임의의 문자 중 하나와 일치
                    &lt;ul&gt;
                      &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;[^0-9]&lt;/code&gt; : 숫자를 제외한 임의의 문자 중 하나와 일치&lt;/li&gt;
                    &lt;/ul&gt;
                  &lt;/li&gt;
                  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;|&lt;/code&gt; : OR, 항목을 묶을 때는 소괄호를 이용
                    &lt;ul&gt;
                      &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;(x|y|z)&lt;/code&gt; : x or y or z&lt;/li&gt;
                      &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;(tree|leaf|can)&lt;/code&gt; : tree or leaf or can&lt;/li&gt;
                    &lt;/ul&gt;
                  &lt;/li&gt;
                  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;*&lt;/code&gt; : * 앞에 나오는 문자가 0회 이상 나타남을 의미
                    &lt;ul&gt;
                      &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Hs*deo&lt;/code&gt; : Hssdeo(O), Hdeo(O), Hsdeo(O), Hssssdeo(O) …. Hudeo(X)&lt;/li&gt;
                    &lt;/ul&gt;
                  &lt;/li&gt;
                  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;+&lt;/code&gt; : + 앞에 나오는 문자가 1회 이상 나타남을 의미&lt;/li&gt;
                  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;?&lt;/code&gt; : ? 앞에 나오는 문자가 0회 또는 1회 이상 나타남을 의미
                    &lt;ul&gt;
                      &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;x?&lt;/code&gt; : x가 존재하거나 존재하지 않음&lt;/li&gt;
                    &lt;/ul&gt;
                  &lt;/li&gt;
                  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;x{n}&lt;/code&gt; : &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;{n}&lt;/code&gt; 앞에 오는 문자가 정확히 n 회 나타남
                    &lt;ul&gt;
                      &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Ha{3}deo&lt;/code&gt; : Haaadeo&lt;/li&gt;
                    &lt;/ul&gt;
                  &lt;/li&gt;
                  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;x{n,}&lt;/code&gt; : x를 n번 이상 반복함을 의미
                    &lt;ul&gt;
                      &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Ha{3,}deo&lt;/code&gt; : Haaadeo(O), Haaaadeo(O), …, Haadeo(X)&lt;/li&gt;
                    &lt;/ul&gt;
                  &lt;/li&gt;
                  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;x{n,m}&lt;/code&gt; : x를 n번 이상 m번 이하 반복함을 의미&lt;/li&gt;
                &lt;/ul&gt;
              &lt;/li&gt;
              &lt;li&gt;예시
                &lt;ul&gt;
                  &lt;li&gt;Get 또는 Post 로 시작하는 ‘=’ 나 ‘a=a’ 가 들어간 패킷 찾기
                    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;      alert tcp $EXTERNAL_NET any -&amp;gt; $HOME_NET any
      (msg:&quot;[TEST]pcre&quot;;content:&quot;+or+&quot;;
      content:&quot;%27%3D%27&quot;;nocase;
      distance:0;within:20;pcre=&quot;/^(GET|POST)/&quot;; sid:100050;)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;                    &lt;/div&gt;
                    &lt;ul&gt;
                      &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;+&lt;/code&gt; 는 space 를 의미&lt;/li&gt;
                      &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;%27%3D%27&lt;/code&gt; : a=a&lt;/li&gt;
                    &lt;/ul&gt;
                  &lt;/li&gt;
                &lt;/ul&gt;
              &lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;Payload / HTTP 관련 : HTTP 패킷에 대해 전체가 아닌 특정필드에서 패턴을 검사하는 기능 지원
            &lt;ul&gt;
              &lt;li&gt;HTTP 구조 : &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;GET /index.php HTTP/1.1&lt;/code&gt;&lt;/li&gt;
              &lt;li&gt;옵션 : 옵션에 raw 가 붙은 경우 (http_raw_*) 디코딩 없이 검사. (uri, header, cookie)
                &lt;ul&gt;
                  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;http_method&lt;/code&gt; : HTTP 요청 시 method 부분을 검사 (GET)&lt;/li&gt;
                  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;http_uri&lt;/code&gt; : HTTP URI 부분을 검사 (index.php)&lt;/li&gt;
                  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;http_header&lt;/code&gt; : HTTP의 Header 부분을 검사 (response/request)&lt;/li&gt;
                  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;http_cookie&lt;/code&gt; : HTTP의 Cookie 부분을 검사&lt;/li&gt;
                  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;http_client_body&lt;/code&gt; : HTTP client 의 Body 부분을 검사 (POST 요청에 대한 검사)&lt;/li&gt;
                  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;http_stat_code&lt;/code&gt; : HTTP 의 Status_code 부분을 검사 (HTTP/1.1 200 OK 의 200 부분)&lt;/li&gt;
                  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;http_stat_msg&lt;/code&gt; : HTTP 의 Status_msg 부분을 검사 (HTTP/1.1 200 OK 의 OK 부분)&lt;/li&gt;
                &lt;/ul&gt;
              &lt;/li&gt;
              &lt;li&gt;예시 : (20:30)&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;</content><author><name>HY03</name><email>hyunik03@gmail.com</email></author><category term="IS_Certification" /><category term="정보보안기사" /><category term="snort" /><summary type="html">snort 개요 IDS (네트워크 이상징후 감시) 중 하나 모든 트래픽을 감시하거나 샘플링을 통해 감시 미리 설정값을 저장 DB 와 비교, 알려진 공격 시그니처와 비교 공격자의 침입 경로 Block 사용자의 패턴을 분석해서 이상징후 탐지 마틴 로시가 1998 년에 sniffer and more 라는 표어 (네트워크 트래픽을 더 많이 감시) 로 개발 프로토콜 검색, 컨텐츠 분석, 웜, 취약점 공격시도 탐지, 포트스캔, CGI 기능 snort 의 운영모드 Sniffer Mode Packet Logger Mode Network IDS/IPS Mode 패킷 스니퍼 패킷 스니핑을 통해 계속 화면에 출력 -&amp;gt; 작은 네트워크 규모에서 사용 패킷 로거 로그 남기기 네트워크 IDS/IPS 네트워크 트래픽 분석을 통한 공격 탐지/차단 설치 RHEL (CentOS) 기준 DAQ (Data Acquistion Package) 설치 Snort 패키지 설치 Talos(제작사) 에서 Ruleset(최근 공격 패턴을 탐지할 수 있는) 을 만들어 배포 Snort 구조 sniffer : 패킷을 보기 좋게 Decode preprocessor : 비정상 헤더구조 패킷, 트래픽 구분 Detection Engine : Rule 기반의 탐지 엔진, 사전 정의된 Rule 에 매칭 되는지 확인, Payload 확인 Alert / logging : Ruleset 에 일치하는 패킷에 대한 처리방법, SMB, SNMP, trap 등을 활용해 저장 설정값 저장 위치 : /etc/snort/snort.conf 모니터링하고자 하는 Network 설정 Rules 위치 수정 Snort 명령어 Sniffer Mode TCP/IP 패킷 헤더를 출력 : snort -v TCP/ICMP/UDP 헤더와 IP를 출력 : snort -vd 패킷 데이터를 추가해서 표현하기 위한 명령어 : snort -vde -v : snort 를 패킷 sniffing 모드로 변경 -d : 모든 네트워크 계층 포함 -e : 데이터링크 계층의 헤더를 포함 -c : 패킷 검출 Snort Rule / Signature Header 내용 처리방식 프로토콜 IP주소 포트번호 Rule 헤더 설정 Rule Actions 패킷이 탐지되었을 때 처리방식 8가지 유형이 존재 alert : 알람을 발생시키고 로그를 남김 log : 패킷을 로그에 남김 pass : 패킷을 무시함 activate : alert 을 발생시키고, dynamic rule을 활성화 dynamic : activate rule 에 의해 활성화 되고, log rule 과 동일하게 동작 drop : 패킷을 차단하고 로그에 남김 reject : 패킷을 차단하고 로그를 남김, 메시지를 전달 TCP : TCP RST UDP : ICMP port Unreachable sdrop : 패킷을 차단하지만 로그를 남기지 않음 (silent drop) Rule 이 매칭 되었을 때 처리방식 Protocols 탐지할 프로토콜을 설정. TCP, IP, UDP, ICMP IP Addresses 출발지, 목적지 IP 주소. 단일 IP, IP대역(CIDR표기), IP 리스트 (구분자:,) 등으로 표기, 부정연산자(!) 표현가능 Port Numbers 출발지, 목적지 Port 단일 Port, Port Range (:이용), Port 리스트 표현 1:1023 : 1~1023 :39910 : 1 ~ 39910 Direction Operator 방향 지시자 출발지 -&amp;gt; 목적지 (단방향) 출발지 &amp;lt;&amp;gt; 목적지 (양방향) 출발지 &amp;lt;- 목적지 : 이러한 표현은 사용하지 않음 형태 : action protocol ipaddr port direction ipaddr port alert tcp any any -&amp;gt; 192.168.59.0/24 80 192.168.59 대역의 80 포트에 들어오는 패킷을 탐지 log tcp $EXTERNAL_NET any &amp;lt;&amp;gt; $HOME_NET 80 외부 네트워크 IP 에서 내부 네트워크 80 포트간 송수신되는 패킷을 탐지 $EXTERNAL_NET, $HOME_NET : snort.conf 에 정의된 환경변수 Body : 옵션 설정 내용 패킷탐지 규칙을 명시 snort 설정 generator 를 사용하여 간편하게 입력하는 방법도 존재 종류 일반 Payload / 범위 관련 Payload / 정규표현식 Payload / HTTP 이벤트 제한 관련 일반 옵션 설정 msg : alert, log 출력 시 이벤트 명으로 사용 reference : rule 과 관련된 외부 취약점 정보 참조시 사용 sid : 룰 식별자 99이하 : 시스템 예약 sid 100 ~ 1000000 : snort 에서 배포하는 ruleset 에서 사용하는 sid 1000001 이상 : 사용자가 정의한 rule sid classtype : 공격유형, 기본우선순위(위험도) 정의 priority : 위험도에 대한 숫자, classtype 에서 지정한 우선순위(위험도) 를 덮어씀 rev : revision - rule 수정횟수 Payload / 범위 관련 : 범위를 지정해주는 옵션을 사용하면 성능 향상, 오탐을 줄임 옵션 content : Payload 에서 검사할 문자열 설정 (전체 Payload 비교) 문자열 설정 시 text, text/binary, binary 형태 중 하나로 설정, 부정연산자 사용 가능 text 형식 : content:&quot;문자열 binary 형식 : content:&quot;|FFFF|문자열&quot; FF : 헥사 값 예시 text/binary 형식 : content:&quot;|FFFF|&quot; !(부정연산자) : content:!&quot;문자열&quot; - 문자열이 없는 것 Escape(\) 처리 필요 문자 : &quot;, ;, \ uricontent : HTTP Client 의 요청 URI (전체 Payload X) 에서 검사할 문자열 설정 offset : Payload 에서 Content 문자열을 검사할 시작 위치를 지정 Payload 의 첫 번째 바이트 위치는 0 부터 시작 depth : offset 부터 몇 바이트까지 검사할 것인지 지정 distance : content:&quot;문자열&quot; 이 매치된 경우 이후부터 몇 바이트 떨어진 위치에서 다음 content를 검사할 것인지 지정 within : content:&quot;문자열&quot; 이 매치된 경우 distance 부터 몇 바이트 범위 내에서 다음 content를 검사할 것인지 지정 nocase : Payload 검사 시 대소문자를 구분하지 않음 (바이너리 형식도 동일) 예시 (29:10) FTP root 로그인 시도 탐지 (제공 Ruleset 사용) alert tcp any any -&amp;gt; 10.10.10.0/24 21 (msg:&quot;FTP root user access&quot;;content:&quot;USER root&quot;;nocase;sid:100100;) 테스트 (content) alert tcp $EXTERNAL_NET any -&amp;gt; $HOME_NET any (msg:&quot;[TEST]content_text&quot;;content:&quot;/etc/passwd&quot;;nocase;sid:1000020;) 테스트 (offset) - 3번째 바이트부터 (2) 3바이트 이내(2~4)에 5457 문자열이 있는지 확인 alert tcp $EXTERNAL_NET any -&amp;gt; $HOME_NET any (msg:&quot;[TEST]offset&quot;;content:&quot;5457&quot;;offset:2;depth:3;nocase;sid:1000030;) 테스트 (distance, within) - 3번째 바이트부터 (2) 5바이트 이내 (2~6) 에서 369 문자열을 찾고, 4바이트 (7,8,9,A) 떨어진 위치 (B) 에서부터 3바이트 이내 (B,C,D) 에서 ABC 문자열을 찾아 만족하면 알림 출력 alert tcp $EXTERNAL_NET any -&amp;gt; $HOME_NET any (msg:&quot;[TEST]distance, within&quot;;content:&quot;369&quot;;offset:2;depth:5;content:&quot;ABC&quot;;distance:4;within:3;nocase;sid:1000034;) Payload / 정규표현식 정규표현식 : 일정 규칙을 갖는 문자열을 표현하는 방식 옵션 : PCRE (Perl Compatible Regular Expression) - Snort 에서는 Perl 기반 정규표현을 사용 pcre=&quot;/정규표현삭/&quot; 메타문자 \ : escape 문자로 사용 (특수문자 기능 제거) ^ : 캐럿. 다음에 나오는 문자는 문자열의 시작을 의미 $ : $ 앞의 문자는 문자열의 끝을 의미 . : 임의의 문자 한 개를 의미함 [] : 집합 안에 지정한 문자들 중 하나와 일치 [a-zA-Z] : 소문자 a-z 사이 + 대문자 A-Z 사이 중 한 문자와 일치 [0-9] : 0~9 사이의 숫자 중 하나 [^] : 집합 안에 지정한 문자들을 제외한 임의의 문자 중 하나와 일치 [^0-9] : 숫자를 제외한 임의의 문자 중 하나와 일치 | : OR, 항목을 묶을 때는 소괄호를 이용 (x|y|z) : x or y or z (tree|leaf|can) : tree or leaf or can * : * 앞에 나오는 문자가 0회 이상 나타남을 의미 Hs*deo : Hssdeo(O), Hdeo(O), Hsdeo(O), Hssssdeo(O) …. Hudeo(X) + : + 앞에 나오는 문자가 1회 이상 나타남을 의미 ? : ? 앞에 나오는 문자가 0회 또는 1회 이상 나타남을 의미 x? : x가 존재하거나 존재하지 않음 x{n} : {n} 앞에 오는 문자가 정확히 n 회 나타남 Ha{3}deo : Haaadeo x{n,} : x를 n번 이상 반복함을 의미 Ha{3,}deo : Haaadeo(O), Haaaadeo(O), …, Haadeo(X) x{n,m} : x를 n번 이상 m번 이하 반복함을 의미 예시 Get 또는 Post 로 시작하는 ‘=’ 나 ‘a=a’ 가 들어간 패킷 찾기 alert tcp $EXTERNAL_NET any -&amp;gt; $HOME_NET any (msg:&quot;[TEST]pcre&quot;;content:&quot;+or+&quot;; content:&quot;%27%3D%27&quot;;nocase; distance:0;within:20;pcre=&quot;/^(GET|POST)/&quot;; sid:100050;) + 는 space 를 의미 %27%3D%27 : a=a Payload / HTTP 관련 : HTTP 패킷에 대해 전체가 아닌 특정필드에서 패턴을 검사하는 기능 지원 HTTP 구조 : GET /index.php HTTP/1.1 옵션 : 옵션에 raw 가 붙은 경우 (http_raw_*) 디코딩 없이 검사. (uri, header, cookie) http_method : HTTP 요청 시 method 부분을 검사 (GET) http_uri : HTTP URI 부분을 검사 (index.php) http_header : HTTP의 Header 부분을 검사 (response/request) http_cookie : HTTP의 Cookie 부분을 검사 http_client_body : HTTP client 의 Body 부분을 검사 (POST 요청에 대한 검사) http_stat_code : HTTP 의 Status_code 부분을 검사 (HTTP/1.1 200 OK 의 200 부분) http_stat_msg : HTTP 의 Status_msg 부분을 검사 (HTTP/1.1 200 OK 의 OK 부분) 예시 : (20:30)</summary></entry><entry><title type="html">정보보안 - 데이터베이스 침해사고</title><link href="https://bluesplatter.com/is_certification/IS-IncidentAnalysis-DatabaseIntrusion/" rel="alternate" type="text/html" title="정보보안 - 데이터베이스 침해사고" /><published>2022-01-21T09:00:00+09:00</published><updated>2022-01-21T09:00:00+09:00</updated><id>https://bluesplatter.com/is_certification/IS-IncidentAnalysis-DatabaseIntrusion</id><content type="html" xml:base="https://bluesplatter.com/is_certification/IS-IncidentAnalysis-DatabaseIntrusion/">&lt;h1 id=&quot;데이터베이스-침해사고&quot;&gt;데이터베이스 침해사고&lt;/h1&gt;
&lt;ul&gt;
  &lt;li&gt;Data, 데이터베이스, DBMS
    &lt;ul&gt;
      &lt;li&gt;데이터와 정보
        &lt;ul&gt;
          &lt;li&gt;데이터 : 정보작성을 위한 필요자료, 특정목적에 대해 평가되지 않은 상태, 단순한 사실&lt;/li&gt;
          &lt;li&gt;정보 : 데이터를 추출, 분석, 비교 등의 가공절차를 통해 의사결정, 행동을 할 수 있는 의미있는 데이터&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;데이터베이스 : 데이터의 집합, 여러 응용시스템이 공유. Integrated, Stored, Operational&lt;/li&gt;
      &lt;li&gt;DBMS : 데이터를 통합적으로 생성, 관리, 저장하는 소프트웨어. MySQL, MSSQL, ORACLE, DB2 등
        &lt;ul&gt;
          &lt;li&gt;MySQL 서버가 침해사고의 대상이 되는 경우가 많음. (PHP)&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;MySQL 점검 항목
    &lt;ul&gt;
      &lt;li&gt;관리자 아이디를 default 로 사용하는지 점검
        &lt;ul&gt;
          &lt;li&gt;기본 패스워드 값은 누구나 알고 있음&lt;/li&gt;
          &lt;li&gt;무차별대입 / 사전대입 공격 - 추측 어려운 패스워드를 사용해야 함&lt;/li&gt;
          &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mysql -uroot -p&lt;/code&gt;&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;패스워드 설정 안된 계정 존재하는지 점검
        &lt;ul&gt;
          &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;select user, password from user&lt;/code&gt;&lt;/li&gt;
          &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;update user set password = [] where user = []&lt;/code&gt;&lt;/li&gt;
          &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;flush privileges;&lt;/code&gt; : 변경사항을 즉시 반영&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;Remote 에서 MySQL 서버로 접속이 가능한지 점검
        &lt;ul&gt;
          &lt;li&gt;기본 포트 : 3306/tcp
            &lt;ul&gt;
              &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;my.cnf&lt;/code&gt; 파일의 &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;[mysqld]&lt;/code&gt; 에 &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;skip-networking&lt;/code&gt; 추가 : 로컬 접속만 가능&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;MySQL 계정을 이용한 접속 가능한지 점검
        &lt;ul&gt;
          &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc/passwd&lt;/code&gt; 의 쉘 부분을 &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/bin/sh&lt;/code&gt; 대신 &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/bin/false&lt;/code&gt; 로 변경하여 원격 접속을 차단&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;시스템 사용자들의 DB에 대한 권한 설정이 올바른지 점검
        &lt;ul&gt;
          &lt;li&gt;필요 이상의 권한을 부여하지 않아야 함&lt;/li&gt;
          &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;select * from DB;&lt;/code&gt;&lt;/li&gt;
          &lt;li&gt;불필요한 권한을 &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Revoke&lt;/code&gt; 시킴&lt;/li&gt;
          &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;update db set update_priv = &apos;N&apos; where db=[]&lt;/code&gt;&lt;/li&gt;
          &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;flush privileges;&lt;/code&gt;&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;데이터베이스 내의 사용자별 접속/권한 설정이 올바른지 점검
        &lt;ul&gt;
          &lt;li&gt;dba 가 아닌 일반 user 가 중요 table 을 조작할 수 있음&lt;/li&gt;
          &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;select * from user;&lt;/code&gt;
            &lt;ul&gt;
              &lt;li&gt;
                &lt;table&gt;
                  &lt;tbody&gt;
                    &lt;tr&gt;
                      &lt;td&gt;Host&lt;/td&gt;
                      &lt;td&gt;User&lt;/td&gt;
                      &lt;td&gt;Password&lt;/td&gt;
                      &lt;td&gt;Select_priv&lt;/td&gt;
                      &lt;td&gt;…&lt;/td&gt;
                      &lt;td&gt;Process_priv&lt;/td&gt;
                      &lt;td&gt;File_priv&lt;/td&gt;
                    &lt;/tr&gt;
                  &lt;/tbody&gt;
                &lt;/table&gt;
              &lt;/li&gt;
              &lt;li&gt;File_priv : 파일에 대한 권한&lt;/li&gt;
              &lt;li&gt;Process_priv : 쓰레드 정보 확인 (쓰레드 중지 권한 포함)&lt;/li&gt;
              &lt;li&gt;Shutdown_priv : MySQL 서버의 실행을 중지시키는 권한&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;localhost 의 root 계정을 사용하지 않고 다른 DBA 계정을 만들어 사용하는 것이 바람직함&lt;/li&gt;
          &lt;li&gt;원격 Host 에서 root 계정등의 접근설정 확인
            &lt;ul&gt;
              &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;update user set process_priv=&quot;N&quot; where host = [ip] and user = &quot;root&quot;;&lt;/code&gt;&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;안정적인 MySQL 버전을 사용하고 있는지 점검&lt;/li&gt;
      &lt;li&gt;MySQL 의 데이터 디렉터리는 안전하게 보호되고 있는지 점검
        &lt;ul&gt;
          &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;my.cnf&lt;/code&gt; 파일에 대한 접근통제도 필요&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;MS-SQL 점검 항목
    &lt;ul&gt;
      &lt;li&gt;계정의 패스워드 중 빈 패스워드나 약한 패스워드가 존재 하는가?
        &lt;ul&gt;
          &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;select name, password from syslogins;&lt;/code&gt; : 결과 NULL 일 경우 패스워드가 없음. 단 Builtin 계정은 NULL 이 정상&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;guest 계정이 비활성화 되어 있는가?
        &lt;ul&gt;
          &lt;li&gt;SQL 서버의 Enterprise Manager 를 실행하여 guest 계정 확인, 삭제&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;public 데이터베이스 역할이 부여되어 있는가?
        &lt;ul&gt;
          &lt;li&gt;public 역할 : 모든 데이터베이스 사용자들의 표준에 해당되는 역할. 인가를 받지 않은 사용자도 권한을 행사할 수 있는 취약점&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;SYSADMIN 그룹의 사용자를 인증된 사용자만으로 제한하고 있는가?
        &lt;ul&gt;
          &lt;li&gt;System Administrator 권한&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;방화벽에서 SQL Server 포트를 차단했는지?
        &lt;ul&gt;
          &lt;li&gt;TCP/1433 or 1434&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;가장 최신의 서비스 팩을 설치했는가?
        &lt;ul&gt;
          &lt;li&gt;서버 보안을 위함&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;Microsoft Baseline Security Analyzer(MBSA) 로 서버를 점검했는가?
        &lt;ul&gt;
          &lt;li&gt;보안패치가 최신으로 유지되는지 확인&lt;/li&gt;
          &lt;li&gt;보안상 약점이 될만한 설정이 있는지 확인&lt;/li&gt;
          &lt;li&gt;기본 취약점 점검하는 도구&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;SQL Server 연결에 대한 감사를 수행하는가?
        &lt;ul&gt;
          &lt;li&gt;이벤트 정보 로그 기록&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;웹서버 확인 필요 항목
        &lt;ul&gt;
          &lt;li&gt;DB 접속 파일 확인
            &lt;ul&gt;
              &lt;li&gt;예 : conn.asp 파일 침해
                &lt;ul&gt;
                  &lt;li&gt;DB 서버의 IP 주소, Host Name&lt;/li&gt;
                  &lt;li&gt;DB 접근 게정 (ID)&lt;/li&gt;
                  &lt;li&gt;DB 서버 접근 패스워드 (PW)&lt;/li&gt;
                &lt;/ul&gt;
              &lt;/li&gt;
              &lt;li&gt;sqlpoke.exe 프로그램을 업로드, 이용, 위에 획득한 정보로 접속&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;MS-SQL 서버 의 디폴트 계정 중 sa (system admin) 계정 이용
            &lt;ul&gt;
              &lt;li&gt;서버 내부의 Administrator 계정으로 명령어를 전달할 수 있는 계정&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;net user 명령어 사용
            &lt;ul&gt;
              &lt;li&gt;remote 에서 DB 서버에 계정을 생성 가능 (우회적으로 DB서버에 접근)&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;SQL Injection 공격
            &lt;ul&gt;
              &lt;li&gt;IIS 웹로그 등을 통해 침입 흔적을 확인해야 함&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;</content><author><name>HY03</name><email>hyunik03@gmail.com</email></author><category term="IS_Certification" /><category term="정보보안기사" /><category term="데이터베이스 침해사고" /><summary type="html">데이터베이스 침해사고 Data, 데이터베이스, DBMS 데이터와 정보 데이터 : 정보작성을 위한 필요자료, 특정목적에 대해 평가되지 않은 상태, 단순한 사실 정보 : 데이터를 추출, 분석, 비교 등의 가공절차를 통해 의사결정, 행동을 할 수 있는 의미있는 데이터 데이터베이스 : 데이터의 집합, 여러 응용시스템이 공유. Integrated, Stored, Operational DBMS : 데이터를 통합적으로 생성, 관리, 저장하는 소프트웨어. MySQL, MSSQL, ORACLE, DB2 등 MySQL 서버가 침해사고의 대상이 되는 경우가 많음. (PHP) MySQL 점검 항목 관리자 아이디를 default 로 사용하는지 점검 기본 패스워드 값은 누구나 알고 있음 무차별대입 / 사전대입 공격 - 추측 어려운 패스워드를 사용해야 함 mysql -uroot -p 패스워드 설정 안된 계정 존재하는지 점검 select user, password from user update user set password = [] where user = [] flush privileges; : 변경사항을 즉시 반영 Remote 에서 MySQL 서버로 접속이 가능한지 점검 기본 포트 : 3306/tcp my.cnf 파일의 [mysqld] 에 skip-networking 추가 : 로컬 접속만 가능 MySQL 계정을 이용한 접속 가능한지 점검 /etc/passwd 의 쉘 부분을 /bin/sh 대신 /bin/false 로 변경하여 원격 접속을 차단 시스템 사용자들의 DB에 대한 권한 설정이 올바른지 점검 필요 이상의 권한을 부여하지 않아야 함 select * from DB; 불필요한 권한을 Revoke 시킴 update db set update_priv = &apos;N&apos; where db=[] flush privileges; 데이터베이스 내의 사용자별 접속/권한 설정이 올바른지 점검 dba 가 아닌 일반 user 가 중요 table 을 조작할 수 있음 select * from user; Host User Password Select_priv … Process_priv File_priv File_priv : 파일에 대한 권한 Process_priv : 쓰레드 정보 확인 (쓰레드 중지 권한 포함) Shutdown_priv : MySQL 서버의 실행을 중지시키는 권한 localhost 의 root 계정을 사용하지 않고 다른 DBA 계정을 만들어 사용하는 것이 바람직함 원격 Host 에서 root 계정등의 접근설정 확인 update user set process_priv=&quot;N&quot; where host = [ip] and user = &quot;root&quot;; 안정적인 MySQL 버전을 사용하고 있는지 점검 MySQL 의 데이터 디렉터리는 안전하게 보호되고 있는지 점검 my.cnf 파일에 대한 접근통제도 필요 MS-SQL 점검 항목 계정의 패스워드 중 빈 패스워드나 약한 패스워드가 존재 하는가? select name, password from syslogins; : 결과 NULL 일 경우 패스워드가 없음. 단 Builtin 계정은 NULL 이 정상 guest 계정이 비활성화 되어 있는가? SQL 서버의 Enterprise Manager 를 실행하여 guest 계정 확인, 삭제 public 데이터베이스 역할이 부여되어 있는가? public 역할 : 모든 데이터베이스 사용자들의 표준에 해당되는 역할. 인가를 받지 않은 사용자도 권한을 행사할 수 있는 취약점 SYSADMIN 그룹의 사용자를 인증된 사용자만으로 제한하고 있는가? System Administrator 권한 방화벽에서 SQL Server 포트를 차단했는지? TCP/1433 or 1434 가장 최신의 서비스 팩을 설치했는가? 서버 보안을 위함 Microsoft Baseline Security Analyzer(MBSA) 로 서버를 점검했는가? 보안패치가 최신으로 유지되는지 확인 보안상 약점이 될만한 설정이 있는지 확인 기본 취약점 점검하는 도구 SQL Server 연결에 대한 감사를 수행하는가? 이벤트 정보 로그 기록 웹서버 확인 필요 항목 DB 접속 파일 확인 예 : conn.asp 파일 침해 DB 서버의 IP 주소, Host Name DB 접근 게정 (ID) DB 서버 접근 패스워드 (PW) sqlpoke.exe 프로그램을 업로드, 이용, 위에 획득한 정보로 접속 MS-SQL 서버 의 디폴트 계정 중 sa (system admin) 계정 이용 서버 내부의 Administrator 계정으로 명령어를 전달할 수 있는 계정 net user 명령어 사용 remote 에서 DB 서버에 계정을 생성 가능 (우회적으로 DB서버에 접근) SQL Injection 공격 IIS 웹로그 등을 통해 침입 흔적을 확인해야 함</summary></entry><entry><title type="html">정보보안 - 네트워크 침해사고</title><link href="https://bluesplatter.com/is_certification/IS-IncidentAnalysis-NetworkIntrusion/" rel="alternate" type="text/html" title="정보보안 - 네트워크 침해사고" /><published>2022-01-14T09:00:00+09:00</published><updated>2022-01-14T09:00:00+09:00</updated><id>https://bluesplatter.com/is_certification/IS-IncidentAnalysis-NetworkIntrusion</id><content type="html" xml:base="https://bluesplatter.com/is_certification/IS-IncidentAnalysis-NetworkIntrusion/">&lt;h1 id=&quot;네트워크-침해사고&quot;&gt;네트워크 침해사고&lt;/h1&gt;
&lt;ul&gt;
  &lt;li&gt;사고 유형별 데이터 수집
    &lt;ul&gt;
      &lt;li&gt;불법적인 자원 사용
        &lt;ul&gt;
          &lt;li&gt;호스트 불법 사용 : 액세스로그, ps 상태, CPU 사용률, 파일 저장공간 상태&lt;/li&gt;
          &lt;li&gt;네트워크 대역폭 불법사용 : 회선상태, 송수신 패킷 수, IP주소, 프로토콜 사용현황, 스위치 포트 상태&lt;/li&gt;
          &lt;li&gt;메일 프록시 서버의 불법 Relay : 호스트 애플리케이션 로그, 프로세스 상태정보, 네트워크 IP주소, 프로토콜 사용현황&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;DoS : 서버의 자원소모를 통한 서비스 중단
        &lt;ul&gt;
          &lt;li&gt;서비스 자원소모를 통한 서비스 중단 / 불안정
            &lt;ul&gt;
              &lt;li&gt;호스트 : 프로세스 상태정보, CPU 사용률, 비정상적인 패킷 로그&lt;/li&gt;
              &lt;li&gt;네트워크 : 회선상태, 비정상적인 패킷개수, IP주소, 비정상적인 패킷내용&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;네트워크 대역폭 과도한 점유를 통한 통신 중단 / 불안정
            &lt;ul&gt;
              &lt;li&gt;네트워크 : 송수신된 패킷 개수, IP주소, 프로토콜 사용현황, 데이터 내용&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;데이터 손상 및 변조
        &lt;ul&gt;
          &lt;li&gt;변조의 종류
            &lt;ul&gt;
              &lt;li&gt;웹페이지 변조&lt;/li&gt;
              &lt;li&gt;데이터파일 변조&lt;/li&gt;
              &lt;li&gt;프로그램 파일 변조&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;호스트 : 액세스 로그, 파일/저장장치 상태, 환경파일 내용&lt;/li&gt;
          &lt;li&gt;네트워크
            &lt;ul&gt;
              &lt;li&gt;IP주소, 프로토콜 사용현황, 데이터 내용, 스위치 포트 상태&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;정보 누설
        &lt;ul&gt;
          &lt;li&gt;통신가로채기, 비공개자료 누설&lt;/li&gt;
          &lt;li&gt;호스트 : 액세스 로그, 파일/저장장치 상태&lt;/li&gt;
          &lt;li&gt;네트워크 : IP주소, 프로토콜 사용현황, 데이터 내용, 스위치 포트 상태&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;네트워크 트래픽 (패킷) 정보 분석 방법 (공통적으로 수집해야 할 정보)
    &lt;ul&gt;
      &lt;li&gt;분석 솔루션 / 툴
        &lt;ul&gt;
          &lt;li&gt;MRTG&lt;/li&gt;
          &lt;li&gt;NMS (Network Management System)&lt;/li&gt;
          &lt;li&gt;Firewall&lt;/li&gt;
          &lt;li&gt;IDS&lt;/li&gt;
          &lt;li&gt;라우터 / 스위치 장비 명령어&lt;/li&gt;
          &lt;li&gt;Ethereal&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;네트워크의 정보
        &lt;ul&gt;
          &lt;li&gt;대역폭 사용량&lt;/li&gt;
          &lt;li&gt;트래픽을 대량으로 발생시키는 IP 주소&lt;/li&gt;
          &lt;li&gt;내부 사용자의 IP 주소&lt;/li&gt;
          &lt;li&gt;서버의 IP 주소&lt;/li&gt;
          &lt;li&gt;TCP/UDP 별 사용 현황&lt;/li&gt;
          &lt;li&gt;라우터, 스위치 트래픽 발생 현황&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;프로토콜 개요
    &lt;ul&gt;
      &lt;li&gt;IPv4
        &lt;ul&gt;
          &lt;li&gt;Version(4) / Header Length(4) / Type of Service(8) / Total Length(16)&lt;/li&gt;
          &lt;li&gt;Identification(16) / Flags(3) / Fragment Offset(13)
            &lt;ul&gt;
              &lt;li&gt;Flags(3bit)
                &lt;ul&gt;
                  &lt;li&gt;0 Bit : 0으로 설정&lt;/li&gt;
                  &lt;li&gt;1 Bit : 0 (큰 패킷에 대한 조각), 1 (조각을 허용하지 않음)&lt;/li&gt;
                  &lt;li&gt;2 Bit : 0 (해당 패킷이 마지막 조각), 1 (마지막이 아님)&lt;/li&gt;
                &lt;/ul&gt;
              &lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;Time to Live(TTL)(8) / Protocol type(8) / Header Checksum(16)
            &lt;ul&gt;
              &lt;li&gt;Time to Live(TTL)
                &lt;ul&gt;
                  &lt;li&gt;해당 패킷이 최대로 통과할 수 있는 라우터 홉수 (전송수명)&lt;/li&gt;
                  &lt;li&gt;0이 되면 해당 패킷은 소실 - ICMP 프로토콜을 사용해 송신 시스템에게 에러가 발생함을 통보&lt;/li&gt;
                &lt;/ul&gt;
              &lt;/li&gt;
              &lt;li&gt;Protocol type
                &lt;ul&gt;
                  &lt;li&gt;전송계층의 프로토콜을 표시&lt;/li&gt;
                  &lt;li&gt;ICMP : 1&lt;/li&gt;
                  &lt;li&gt;TCP : 6&lt;/li&gt;
                  &lt;li&gt;UDP : 17&lt;/li&gt;
                &lt;/ul&gt;
              &lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;Source Address(32)&lt;/li&gt;
          &lt;li&gt;Destination Address(32)&lt;/li&gt;
          &lt;li&gt;Option / Padding&lt;/li&gt;
          &lt;li&gt;Data(32)…&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;IPv6 : 기존 14개 헤더에서 8개 헤더로 줄어듦
        &lt;ul&gt;
          &lt;li&gt;Version(4) / Traffic Class(8) / Flow Label(20)&lt;/li&gt;
          &lt;li&gt;Payload Length(16) / Next Header(8) / Hop limit(8)&lt;/li&gt;
          &lt;li&gt;Source Address(128)&lt;/li&gt;
          &lt;li&gt;Destination Address(128)&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;TCP : 시스템과 네트워크를 연결해주는 가장 중요한 계층
        &lt;ul&gt;
          &lt;li&gt;20 Bytes Header
            &lt;ul&gt;
              &lt;li&gt;Source Port number(16) / Destination Port number(16)
                &lt;ul&gt;
                  &lt;li&gt;Port : 0 ~ 65535&lt;/li&gt;
                &lt;/ul&gt;
              &lt;/li&gt;
              &lt;li&gt;Sequence number(32)
                &lt;ul&gt;
                  &lt;li&gt;송신자가 전송하는 데이터의 TCP Segment 번호&lt;/li&gt;
                &lt;/ul&gt;
              &lt;/li&gt;
              &lt;li&gt;Acknowledgement number(32)
                &lt;ul&gt;
                  &lt;li&gt;송신자가 해당 패킷을 수신한 호스트로부터 다음에 받아야 하는 패킷의 TCP Segment 번호&lt;/li&gt;
                &lt;/ul&gt;
              &lt;/li&gt;
              &lt;li&gt;header length(4) / 예비(6) / TCP Control Flag(6) / Window size(16)
                &lt;ul&gt;
                  &lt;li&gt;TCP Control Flag : 패킷의 용도를 표시
                    &lt;ul&gt;
                      &lt;li&gt;URG : 긴급&lt;/li&gt;
                      &lt;li&gt;ACK : 응답패킷&lt;/li&gt;
                      &lt;li&gt;PSH : 세그먼트를 메모리에서 합성하지 않고 애플리케이션에 바로 전달&lt;/li&gt;
                      &lt;li&gt;RST : 해당 세션을 강제로 종료&lt;/li&gt;
                      &lt;li&gt;SYN : 초기에 접속을 시작하는 경우 사용, Sequence Number, Window Size 명시
                        &lt;ul&gt;
                          &lt;li&gt;SYN (100) -&amp;gt; SYN (1) + ACK (101) -&amp;gt; ACK (2)&lt;/li&gt;
                        &lt;/ul&gt;
                      &lt;/li&gt;
                      &lt;li&gt;FIN : 해당 세션을 정상적으로 종료
                        &lt;ul&gt;
                          &lt;li&gt;
                            &lt;table&gt;
                              &lt;tbody&gt;
                                &lt;tr&gt;
                                  &lt;td&gt;FIN (100) -&amp;gt; ACK(100+1)&lt;/td&gt;
                                  &lt;td&gt;FIN, ACK(1) -&amp;gt; ACK(2)&lt;/td&gt;
                                &lt;/tr&gt;
                              &lt;/tbody&gt;
                            &lt;/table&gt;
                          &lt;/li&gt;
                        &lt;/ul&gt;
                      &lt;/li&gt;
                    &lt;/ul&gt;
                  &lt;/li&gt;
                  &lt;li&gt;Window size : 버퍼크기, 운영체제나 응용프로그램에 따라 다름.
                    &lt;ul&gt;
                      &lt;li&gt;너무 큰 세그먼트의 크기를 줄이라고 통보&lt;/li&gt;
                      &lt;li&gt;네트워크 웜의 경우 TCP Window의 크기가 일정하게 고정됨&lt;/li&gt;
                    &lt;/ul&gt;
                  &lt;/li&gt;
                &lt;/ul&gt;
              &lt;/li&gt;
              &lt;li&gt;TCP Checksum(16) / urgent pointer(16)&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;Options&lt;/li&gt;
          &lt;li&gt;Data&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;패킷 수집 및 디코드
    &lt;ul&gt;
      &lt;li&gt;트래픽과 패킷 수집
        &lt;ul&gt;
          &lt;li&gt;목적 : 외부 침입과 공격을 확인하기 위함&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;패킷 측정 구간
        &lt;ul&gt;
          &lt;li&gt;목적에 따라 위치가 달라질 수 있음
            &lt;ul&gt;
              &lt;li&gt;WAN - Router - F/W - LAN/WLAN …
                &lt;ul&gt;
                  &lt;li&gt;기본 : 라우터와 가까운 위치에 센서를 설치&lt;/li&gt;
                  &lt;li&gt;F/W : NAT (Network Address Transition) : 사설IP &amp;lt;–&amp;gt; 공인IP 일 경우 방화벽 앞 뒤로 센서를 설치
                    &lt;ul&gt;
                      &lt;li&gt;같은 시간대에 세션을 찾아서 동일한 패킷들로 분석&lt;/li&gt;
                    &lt;/ul&gt;
                  &lt;/li&gt;
                  &lt;li&gt;네트워크 웜 (IP 를 변조) 분석
                    &lt;ul&gt;
                      &lt;li&gt;내부 네트워크 전 구간이 측정대상이 될 수 있음&lt;/li&gt;
                      &lt;li&gt;백본, 주요 액세스 스위치의 포트 트래픽, CPU 상태 관찰 필요&lt;/li&gt;
                      &lt;li&gt;대부분의 네트워크 공격은 내부에 있는 호스트가 서로 공격하도록 하는 DDoS 방법 이용 (22:38)&lt;/li&gt;
                    &lt;/ul&gt;
                  &lt;/li&gt;
                &lt;/ul&gt;
              &lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;패킷 수집
        &lt;ul&gt;
          &lt;li&gt;캡쳐 기능을 이용해 버퍼나 파일로 저장
            &lt;ul&gt;
              &lt;li&gt;일정 개수의 파일을 항상 유지
                &lt;ul&gt;
                  &lt;li&gt;약 24-32MB 정도의 용량&lt;/li&gt;
                  &lt;li&gt;패킷 수집구간에서 발생하는 트래픽과 패킷저장에 필요한 시간을 계산해서 설정&lt;/li&gt;
                &lt;/ul&gt;
              &lt;/li&gt;
              &lt;li&gt;항상 최근의 패킷들만 포함 (Ring Buffer)&lt;/li&gt;
              &lt;li&gt;언제 어떤 사고가 발생할지 알 수 없기 때문에 항상 일정시간 동안의 트래픽 정보와 패킷을 보관&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;실제 사용자들의 Data 가 필요하지 않을 때 패킷의 Header 부분만 캡쳐
            &lt;ul&gt;
              &lt;li&gt;모든 패킷의 시작부분에서 일정한 크기만큼만 캡쳐&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;트래픽 통계 관찰 - 분석기, NMS 나 시스템 내부 명령어를 통해 관찰
        &lt;ul&gt;
          &lt;li&gt;MAC 주소별 트래픽 통계
            &lt;ul&gt;
              &lt;li&gt;사용자들이나 서버들이 연결된 액세스 스위치 구간에서는 호스트별 MAC 주소를 확인, 트래픽 발생 상태를 관찰&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;IP 주소별 트래픽 통계
            &lt;ul&gt;
              &lt;li&gt;대부분 침입, 공격은 IP 기반&lt;/li&gt;
              &lt;li&gt;IP 주소별로 모든 트래픽 통계를 분리 관찰 필요&lt;/li&gt;
              &lt;li&gt;네트워크에서 웜이 활동하거나 DDoS 가 발생한 경우
                &lt;ul&gt;
                  &lt;li&gt;내부 IP 주소에서 전송하는 패킷 개수가 수신하는 패킷 개수보다 훨씬 많음&lt;/li&gt;
                  &lt;li&gt;패킷 개수에 비해서 송수신되는 Byte 수가 적음&lt;/li&gt;
                &lt;/ul&gt;
              &lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;TCP/UDP 세션별 트래픽 통계
            &lt;ul&gt;
              &lt;li&gt;어느 세션이 서버에서 몇 분 동안 작업을 했는지, 어느정도의 패킷이나 데이터가 송수신되었는지 확인&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;패킷 디코드
        &lt;ul&gt;
          &lt;li&gt;패킷 컬럼
            &lt;ul&gt;
              &lt;li&gt;Time (Relative Time) : 기준 패킷으로부터 상대적인 시간차&lt;/li&gt;
              &lt;li&gt;Delta Time : 시간 간격 - 바로 이전 패킷과 해당 패킷사이의 간격&lt;/li&gt;
              &lt;li&gt;Abs.Time : 패킷이 캡쳐된 실제 시스템 시간&lt;/li&gt;
              &lt;li&gt;Source : 패킷 송신 호스트의 주소 (IP or MAC)&lt;/li&gt;
              &lt;li&gt;Destination : 패킷 수신 호스트의 주소 (IP or MAC)&lt;/li&gt;
              &lt;li&gt;Length : 실제 패킷의 크기
                &lt;ul&gt;
                  &lt;li&gt;CRC (Cycle Redundancy Check) : 순환중복검사, 네트워크 오류 체크 값을 얻어내는 방식
                    &lt;ul&gt;
                      &lt;li&gt;데이터 전송 전에 데이터 값에 따라 CRC 계산, 값을 Data 에 붙여넣어 전송&lt;/li&gt;
                      &lt;li&gt;H/W 방식 (직렬데이터-CRC:비트단위 출력) 과 S/W (병렬데이터-CRC:Octet-8비트 단위 출력) 방식이 있음&lt;/li&gt;
                      &lt;li&gt;오류를 검출하는 데 탁월하나, 수정이 쉬워 데이터 무결성 검증은 할 수 없음.&lt;/li&gt;
                    &lt;/ul&gt;
                  &lt;/li&gt;
                  &lt;li&gt;CRC 값이 Length 에 포함될수도 안될수도 있음&lt;/li&gt;
                &lt;/ul&gt;
              &lt;/li&gt;
              &lt;li&gt;Protocol&lt;/li&gt;
              &lt;li&gt;Info : 송수신포트, 패킷의 용도, 애플리케이션의 설명, 패킷의 Seq 번호, Ack 번호, TCP Window size 등&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;패킷 헤더&lt;/li&gt;
          &lt;li&gt;패킷 데이터
            &lt;ul&gt;
              &lt;li&gt;16진수 혹은 ASCII 코드&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;공격형 트래픽의 특징
    &lt;ul&gt;
      &lt;li&gt;특정 서버만을 공격하는 패턴
        &lt;ul&gt;
          &lt;li&gt;Web 서버, E-mail 서버, DNS 서버 등 (Application 서버) 을 공격
            &lt;ul&gt;
              &lt;li&gt;패킷의 크기가 크거나 불규칙&lt;/li&gt;
              &lt;li&gt;해당 서버에서 인식하지 못하는 코드를 전송&lt;/li&gt;
              &lt;li&gt;해당 서버에서 처리할 수 없을 정도의 많은 요청을 보냄&lt;/li&gt;
              &lt;li&gt;서버에서 허용되지 않는 문장을 사용해서 요청 패킷을 전송&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;애플리케이션 서비스 중단
            &lt;ul&gt;
              &lt;li&gt;서비스 중단 코드를 서버에 삽입 : Buffer Overflow 공격 &amp;gt; 네트워크 과부하 발생 공격 (발전된 공격형태)&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;네트워크에 과부하를 발생시키는 공격 패턴
        &lt;ul&gt;
          &lt;li&gt;스위치, 방화벽, 라우터 등에 영향
            &lt;ul&gt;
              &lt;li&gt;영향을 주는 트래픽을 찾는 것은 쉬우나, 발생시키는 호스트를 찾는 것이 어려움 (IP 변조)&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;네트워크 과부하 발생 트래픽의 특징
            &lt;ul&gt;
              &lt;li&gt;불특정 IP 주소를 순차적으로 사용하여 특정 한 개의 IP 주소 대상으로 같은 형태의 패킷이 발생&lt;/li&gt;
              &lt;li&gt;특정 IP 주소에서 불특정 다수의 IP 주소 대상으로 순차적으로 같은 형태의 패킷이 발생&lt;/li&gt;
              &lt;li&gt;1초에 송신하는 패킷의 개수가 수백에서 수만개 까지 발생&lt;/li&gt;
              &lt;li&gt;한 개 또는 몇 개의 TCP 포트를 대상으로 SYN 패킷을 전송&lt;/li&gt;
              &lt;li&gt;발생하는 패킷의 크기가 작음&lt;/li&gt;
              &lt;li&gt;패킷의 개수가 수신보다 송신이 매우 많음 (100-1000배 이상)&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;침입형 트래픽의 특징
            &lt;ul&gt;
              &lt;li&gt;목적지를 알고있는 상태인 경우 접속이 가능한 포트를 검색하여 접속을 시도 (여러 방법, 도구) 함&lt;/li&gt;
              &lt;li&gt;목적지를 모르는 경우 네트워크를 통해 IP 와 포트를 검색해야 함&lt;/li&gt;
              &lt;li&gt;해당 IP 주소에서 송신한 패킷 개수와 수신한 패킷 개수가 비슷함&lt;/li&gt;
              &lt;li&gt;일반적으로 검색과정에서는 실제 데이터 송수신이 발생하지 않기때문에 송수신한 바이트 수도 비슷함&lt;/li&gt;
              &lt;li&gt;패킷 가운데 RST 나 login Failure 가 포함된 패킷이 많음&lt;/li&gt;
              &lt;li&gt;검색하려는 IP 주소 또는 포트가 순차적으로 바뀜&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;일반적인 침입과정
            &lt;ul&gt;
              &lt;li&gt;공격자
                &lt;ul&gt;
                  &lt;li&gt;침입자 -&amp;gt; Target : IP Scan
                    &lt;ul&gt;
                      &lt;li&gt;Ping 명령어 이용하여 검색
                        &lt;ul&gt;
                          &lt;li&gt;Echo Request - Echo Reply (호스트 있을 경우)&lt;/li&gt;
                        &lt;/ul&gt;
                      &lt;/li&gt;
                    &lt;/ul&gt;
                  &lt;/li&gt;
                  &lt;li&gt;침입자 -&amp;gt; Target : 호스트 정보검색 (취약점)&lt;/li&gt;
                  &lt;li&gt;침입자 -&amp;gt; Target : 취약점을 이용한 호스트 공격
                    &lt;ul&gt;
                      &lt;li&gt;관리자 권한 획득, Data 삭제, 백도어 설치, 자원의 불법사용, 보안정보 유출&lt;/li&gt;
                    &lt;/ul&gt;
                  &lt;/li&gt;
                &lt;/ul&gt;
              &lt;/li&gt;
              &lt;li&gt;Target
                &lt;ul&gt;
                  &lt;li&gt;IP Scan 검사 : 침입자의 IP 주소, 검사시간 확인&lt;/li&gt;
                  &lt;li&gt;Port 검사&lt;/li&gt;
                  &lt;li&gt;침입자의 명령어 검사, 코드 검사&lt;/li&gt;
                  &lt;li&gt;침입자의 데이터 송수신 상태 검사&lt;/li&gt;
                  &lt;li&gt;불법적인 통신 상태 검사&lt;/li&gt;
                &lt;/ul&gt;
              &lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;예시
        &lt;ul&gt;
          &lt;li&gt;MS Blaster 패턴
            &lt;ul&gt;
              &lt;li&gt;Window 계열 운영체제를 통해 확산된 웜 (Blaster Worm) - 2003년 전파&lt;/li&gt;
              &lt;li&gt;여러 IP 에서 한 IP 주소에 패킷을 보냄&lt;/li&gt;
              &lt;li&gt;짧은 Delta time, 많은 SYN 패킷 전송&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;Gabot 패턴
            &lt;ul&gt;
              &lt;li&gt;한 IP 주소에서 여러 IP 에 패킷을 보냄&lt;/li&gt;
              &lt;li&gt;짧은 Delta time, 많은 SYN 패킷 전송&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;IP Scan 패턴
            &lt;ul&gt;
              &lt;li&gt;Echo Request 사용 (Ping)&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;Port Scan 패턴
            &lt;ul&gt;
              &lt;li&gt;TCP 포트 검색, 포트를 순차적 검색&lt;/li&gt;
              &lt;li&gt;대상 Host 에서 연결을 거부할 경우 RST 패킷이 발생&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;</content><author><name>HY03</name><email>hyunik03@gmail.com</email></author><category term="IS_Certification" /><category term="정보보안기사" /><category term="네트워크 침해사고" /><summary type="html">네트워크 침해사고 사고 유형별 데이터 수집 불법적인 자원 사용 호스트 불법 사용 : 액세스로그, ps 상태, CPU 사용률, 파일 저장공간 상태 네트워크 대역폭 불법사용 : 회선상태, 송수신 패킷 수, IP주소, 프로토콜 사용현황, 스위치 포트 상태 메일 프록시 서버의 불법 Relay : 호스트 애플리케이션 로그, 프로세스 상태정보, 네트워크 IP주소, 프로토콜 사용현황 DoS : 서버의 자원소모를 통한 서비스 중단 서비스 자원소모를 통한 서비스 중단 / 불안정 호스트 : 프로세스 상태정보, CPU 사용률, 비정상적인 패킷 로그 네트워크 : 회선상태, 비정상적인 패킷개수, IP주소, 비정상적인 패킷내용 네트워크 대역폭 과도한 점유를 통한 통신 중단 / 불안정 네트워크 : 송수신된 패킷 개수, IP주소, 프로토콜 사용현황, 데이터 내용 데이터 손상 및 변조 변조의 종류 웹페이지 변조 데이터파일 변조 프로그램 파일 변조 호스트 : 액세스 로그, 파일/저장장치 상태, 환경파일 내용 네트워크 IP주소, 프로토콜 사용현황, 데이터 내용, 스위치 포트 상태 정보 누설 통신가로채기, 비공개자료 누설 호스트 : 액세스 로그, 파일/저장장치 상태 네트워크 : IP주소, 프로토콜 사용현황, 데이터 내용, 스위치 포트 상태 네트워크 트래픽 (패킷) 정보 분석 방법 (공통적으로 수집해야 할 정보) 분석 솔루션 / 툴 MRTG NMS (Network Management System) Firewall IDS 라우터 / 스위치 장비 명령어 Ethereal 네트워크의 정보 대역폭 사용량 트래픽을 대량으로 발생시키는 IP 주소 내부 사용자의 IP 주소 서버의 IP 주소 TCP/UDP 별 사용 현황 라우터, 스위치 트래픽 발생 현황 프로토콜 개요 IPv4 Version(4) / Header Length(4) / Type of Service(8) / Total Length(16) Identification(16) / Flags(3) / Fragment Offset(13) Flags(3bit) 0 Bit : 0으로 설정 1 Bit : 0 (큰 패킷에 대한 조각), 1 (조각을 허용하지 않음) 2 Bit : 0 (해당 패킷이 마지막 조각), 1 (마지막이 아님) Time to Live(TTL)(8) / Protocol type(8) / Header Checksum(16) Time to Live(TTL) 해당 패킷이 최대로 통과할 수 있는 라우터 홉수 (전송수명) 0이 되면 해당 패킷은 소실 - ICMP 프로토콜을 사용해 송신 시스템에게 에러가 발생함을 통보 Protocol type 전송계층의 프로토콜을 표시 ICMP : 1 TCP : 6 UDP : 17 Source Address(32) Destination Address(32) Option / Padding Data(32)… IPv6 : 기존 14개 헤더에서 8개 헤더로 줄어듦 Version(4) / Traffic Class(8) / Flow Label(20) Payload Length(16) / Next Header(8) / Hop limit(8) Source Address(128) Destination Address(128) TCP : 시스템과 네트워크를 연결해주는 가장 중요한 계층 20 Bytes Header Source Port number(16) / Destination Port number(16) Port : 0 ~ 65535 Sequence number(32) 송신자가 전송하는 데이터의 TCP Segment 번호 Acknowledgement number(32) 송신자가 해당 패킷을 수신한 호스트로부터 다음에 받아야 하는 패킷의 TCP Segment 번호 header length(4) / 예비(6) / TCP Control Flag(6) / Window size(16) TCP Control Flag : 패킷의 용도를 표시 URG : 긴급 ACK : 응답패킷 PSH : 세그먼트를 메모리에서 합성하지 않고 애플리케이션에 바로 전달 RST : 해당 세션을 강제로 종료 SYN : 초기에 접속을 시작하는 경우 사용, Sequence Number, Window Size 명시 SYN (100) -&amp;gt; SYN (1) + ACK (101) -&amp;gt; ACK (2) FIN : 해당 세션을 정상적으로 종료 FIN (100) -&amp;gt; ACK(100+1) FIN, ACK(1) -&amp;gt; ACK(2) Window size : 버퍼크기, 운영체제나 응용프로그램에 따라 다름. 너무 큰 세그먼트의 크기를 줄이라고 통보 네트워크 웜의 경우 TCP Window의 크기가 일정하게 고정됨 TCP Checksum(16) / urgent pointer(16) Options Data</summary></entry><entry><title type="html">정보보안 - 리눅스 사고 분석</title><link href="https://bluesplatter.com/is_certification/IS-IncidentAnalysis-LinuxInitialResponse/" rel="alternate" type="text/html" title="정보보안 - 리눅스 사고 분석" /><published>2022-01-12T09:00:00+09:00</published><updated>2022-01-12T09:00:00+09:00</updated><id>https://bluesplatter.com/is_certification/IS-IncidentAnalysis-LinuxInitialResponse</id><content type="html" xml:base="https://bluesplatter.com/is_certification/IS-IncidentAnalysis-LinuxInitialResponse/">&lt;h1 id=&quot;리눅스-침해사고-분석&quot;&gt;리눅스 침해사고 분석&lt;/h1&gt;
&lt;ul&gt;
  &lt;li&gt;기본 정보 수집
    &lt;ul&gt;
      &lt;li&gt;OS 종류, 커널 버전&lt;/li&gt;
      &lt;li&gt;사용 용도&lt;/li&gt;
      &lt;li&gt;운영중인 서비스&lt;/li&gt;
      &lt;li&gt;네트워크 접속 현황&lt;/li&gt;
      &lt;li&gt;보안 패치 적용 현황&lt;/li&gt;
      &lt;li&gt;네트워크 구성 형태 및 보안 장비 운영 현황&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;휘발성 정보 수집
    &lt;ul&gt;
      &lt;li&gt;프로세스 확인
        &lt;ul&gt;
          &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ps -ef&lt;/code&gt;
            &lt;ul&gt;
              &lt;li&gt;process 실행자&lt;/li&gt;
              &lt;li&gt;PID&lt;/li&gt;
              &lt;li&gt;실행 일시&lt;/li&gt;
              &lt;li&gt;프로세스명&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;lsof&lt;/code&gt; : List open file
            &lt;ul&gt;
              &lt;li&gt;System 에서 동작중인 Process 에 의해서 열린 파일들에 대한 정보를 보여주는 명령&lt;/li&gt;
              &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ps&lt;/code&gt; 명령어가 변조된 경우 공격자가 구동시킨 프로세스를 볼 수 없음&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;네트워크 상태
        &lt;ul&gt;
          &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;netstat -an&lt;/code&gt;
            &lt;ul&gt;
              &lt;li&gt;현재 시스템의 네트워크 연결 상태 확인&lt;/li&gt;
              &lt;li&gt;발신지 주소 확인&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;nmap&lt;/code&gt; : network mapper
            &lt;ul&gt;
              &lt;li&gt;네트워크 보안 유틸리티&lt;/li&gt;
              &lt;li&gt;대규모 네트워크를 고속으로 스캔
                &lt;ul&gt;
                  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-sT&lt;/code&gt; : tcp 스캔&lt;/li&gt;
                  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-p&lt;/code&gt; : 특정 포트 점검&lt;/li&gt;
                  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;nmap -sT -p [포트번호] [ip주소]&lt;/code&gt;&lt;/li&gt;
                &lt;/ul&gt;
              &lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;fuser&lt;/code&gt;
            &lt;ul&gt;
              &lt;li&gt;어떤 프로세스에서 포트를 열었는지 확인&lt;/li&gt;
              &lt;li&gt;현재 사용중인 파일, 소켓이 사용하는 프로세스 확인&lt;/li&gt;
              &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;fuser 6001/tcp&lt;/code&gt;
                &lt;ul&gt;
                  &lt;li&gt;위 명령어의 결과 (예:pid 6333) 를 활용해 &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ps [pid]&lt;/code&gt; 명령어 사용&lt;/li&gt;
                &lt;/ul&gt;
              &lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;사용자 로그인 상태
        &lt;ul&gt;
          &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;w&lt;/code&gt;
            &lt;ul&gt;
              &lt;li&gt;현재 시스템에 성공적으로 로그인한 사용자에 대한 Snapshot 제공
                &lt;ul&gt;
                  &lt;li&gt;해당 사용자 목록 중에 &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;w&lt;/code&gt; 명령어에 없는 (성공적으로 로그인) 사용자는 백도어를 이용했을 확률이 있음&lt;/li&gt;
                &lt;/ul&gt;
              &lt;/li&gt;
              &lt;li&gt;사용자들이 어디에서 로그인을 했는지, 어떤 작업을 하는지 알 수 있음&lt;/li&gt;
              &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;utmp&lt;/code&gt; : 정보 파일&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;공격자를 규정하기 위해 자세히 봐야할 정보
        &lt;ul&gt;
          &lt;li&gt;접속 계정이 정상적인지 확인&lt;/li&gt;
          &lt;li&gt;접속출처가 정상 위치인지 확인 (내부 IP 주소 이외에 접속, 국외 IP 주소 접속 등)&lt;/li&gt;
          &lt;li&gt;접속 사용자의 정상적인 행위인지 확인 (Scan 도구 사용, 다른 서버에 서비스거부공격 등)&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;프로세스 확인, 네트워크 상태를 확인해 시스템의 상황을 파악하고 공격자의 단서를 찾음, 이후 세부사항 확인&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;상세분석
    &lt;ul&gt;
      &lt;li&gt;패스워드 파일 분석
        &lt;ul&gt;
          &lt;li&gt;&lt;strong&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc/passwd&lt;/code&gt;&lt;/strong&gt;
            &lt;ul&gt;
              &lt;li&gt;관리자 권한을 가진 계정이 있는지 확인 : uid=0
                &lt;ul&gt;
                  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;user1:x:0:0::/home/user1:/bin/bash&lt;/code&gt;&lt;/li&gt;
                &lt;/ul&gt;
              &lt;/li&gt;
              &lt;li&gt;새로 생성된 계정이나 패스워드가 없는 계정 확인&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;&lt;strong&gt;로그 파일 분석&lt;/strong&gt;
        &lt;ul&gt;
          &lt;li&gt;사고가 일어난 뒤의 로그는 100% 신뢰할 수는 없다. 하지만 흔적은 어딘가에 남아있다.&lt;/li&gt;
          &lt;li&gt;로그파일 생성일자, 변경일자 확인&lt;/li&gt;
          &lt;li&gt;공격자는 공격을 통해 발생하는 시스템로그, 접속로그등을 삭제/변경함&lt;/li&gt;
          &lt;li&gt;주요 로그 파일
            &lt;ul&gt;
              &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;utmp&lt;/code&gt; : 현재 시스템에 로그인한 사용자의 정보&lt;/li&gt;
              &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;wtmp&lt;/code&gt; : 과거에 로그인했던 사용자의 정보&lt;/li&gt;
              &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;messages&lt;/code&gt; : 시스템 장애 정보 + 공격으로 인한 정보&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;웹로그 파일
            &lt;ul&gt;
              &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;access_log&lt;/code&gt;
                &lt;ul&gt;
                  &lt;li&gt;Host (도메인,IP주소) : 웹서버에 접속한 IP 주소&lt;/li&gt;
                  &lt;li&gt;Identification : 사용자의 이름, - 로 표시&lt;/li&gt;
                  &lt;li&gt;User Authentication : (사용자 인증이 된 경우) 패스워드가 표시되는 부분&lt;/li&gt;
                  &lt;li&gt;Time Stamp : 방문자가 접속한 시간 (GMT - 그리니치 표준시 포함)&lt;/li&gt;
                  &lt;li&gt;HTTP Request
                    &lt;ul&gt;
                      &lt;li&gt;사용자 접속한 방식 (POST, GET)&lt;/li&gt;
                      &lt;li&gt;접속파일&lt;/li&gt;
                      &lt;li&gt;HTTP 버전&lt;/li&gt;
                    &lt;/ul&gt;
                  &lt;/li&gt;
                  &lt;li&gt;Status : 사용자가 요청한 내용을 처리한 결과
                    &lt;ul&gt;
                      &lt;li&gt;200 : Success&lt;/li&gt;
                      &lt;li&gt;3xx : Redirection&lt;/li&gt;
                      &lt;li&gt;4xx : Client Error
                        &lt;ul&gt;
                          &lt;li&gt;404 : NotFound&lt;/li&gt;
                        &lt;/ul&gt;
                      &lt;/li&gt;
                      &lt;li&gt;5xx : Server Error&lt;/li&gt;
                    &lt;/ul&gt;
                  &lt;/li&gt;
                  &lt;li&gt;Transfer Volume : 요청한 파일의 용량, 없는 경우 0 또는 - 로 표시&lt;/li&gt;
                &lt;/ul&gt;
              &lt;/li&gt;
              &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;access&lt;/code&gt;&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;루트킷 확인
        &lt;ul&gt;
          &lt;li&gt;Rootkit : 정상적 프로그램을 변조시킴 (주로 바이너리 파일)
            &lt;ul&gt;
              &lt;li&gt;ls, ps, netstat, login, top, dir, du, ifconfig, find, tcpd …&lt;/li&gt;
              &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ls&lt;/code&gt; 명령어를 변조시켜 공격자가 만든 파일이 보이지 않도록 함&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;시스템 프로그램 파일크기, 생성시간, 변경시간 확인&lt;/li&gt;
          &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/bin&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/usr/bin&lt;/code&gt; 디렉토리 에서 &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ls -alct | more&lt;/code&gt; 명령을 통해 다른 프로그램이 기본적으로 설치된 시간과 다른 것이 있는지 확인 -&amp;gt; 파일사이즈 비교
            &lt;ul&gt;
              &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ls&lt;/code&gt;
                &lt;ul&gt;
                  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-a&lt;/code&gt; : all - 숨겨진 파일, 디렉토리를 보고자 할때&lt;/li&gt;
                  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-l&lt;/code&gt; : long - 자세한 내용을 출력. 권한, 파일 수, 소유자, 그룹, 파일크기, 수정일자 등&lt;/li&gt;
                  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-c&lt;/code&gt; : ctime - 변경시간
                    &lt;ul&gt;
                      &lt;li&gt;MAC : mtime (수정), atime (접근), ctime (변경)&lt;/li&gt;
                      &lt;li&gt;기본값 mtime 으로 출력&lt;/li&gt;
                      &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-u&lt;/code&gt; : atime&lt;/li&gt;
                    &lt;/ul&gt;
                  &lt;/li&gt;
                  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-t&lt;/code&gt; : 시간순 정렬&lt;/li&gt;
                  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-S&lt;/code&gt; : 파일 사이즈 순 정렬&lt;/li&gt;
                &lt;/ul&gt;
              &lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;무결성 검사 (리눅스) : &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;rpm -Va&lt;/code&gt;
            &lt;ul&gt;
              &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;s.5.....GT /bin/df&lt;/code&gt;
                &lt;ul&gt;
                  &lt;li&gt;s : 프로그램 사이즈 변경&lt;/li&gt;
                  &lt;li&gt;5 : md5 checksum 값 변경&lt;/li&gt;
                  &lt;li&gt;T : vkdlfdml mtime 값 변경&lt;/li&gt;
                  &lt;li&gt;G : group 변경&lt;/li&gt;
                  &lt;li&gt;u : user 변경&lt;/li&gt;
                  &lt;li&gt;c : 설정파일 변경&lt;/li&gt;
                &lt;/ul&gt;
              &lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;무결성 검사 (솔라리스) : &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;fingerprint&lt;/code&gt;
            &lt;ul&gt;
              &lt;li&gt;검사하고자 하는 파일의 checksum 값을 만들어 비교&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;strace&lt;/code&gt; : System 콜 추적
            &lt;ul&gt;
              &lt;li&gt;예) ps 명령어 추적 : &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;strace -e trace=open ps|more&lt;/code&gt;
                &lt;ul&gt;
                  &lt;li&gt;결과가 &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;open(&quot;/usr/lib/locale/ro_RO/u~/procre)&lt;/code&gt; 이라고 나왔을 경우 ps 가 해당 파일을 참조
                    &lt;ul&gt;
                      &lt;li&gt;공격자가 숨기고 싶은 파일을 해당 파일에 등록&lt;/li&gt;
                    &lt;/ul&gt;
                  &lt;/li&gt;
                &lt;/ul&gt;
              &lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;해킹 관련 파일 조사
        &lt;ul&gt;
          &lt;li&gt;피해 시스템에 공격자가 어떤 작업을 했는지 알아보기 위한 절차
            &lt;ul&gt;
              &lt;li&gt;타 시스템 스캔&lt;/li&gt;
              &lt;li&gt;공격 프로그램 설치&lt;/li&gt;
              &lt;li&gt;IRC 서버 설치&lt;/li&gt;
              &lt;li&gt;로그 삭제&lt;/li&gt;
              &lt;li&gt;스니퍼 프로그램 설치&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;새롭게 생긴 파일 찾기
            &lt;ul&gt;
              &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;find&lt;/code&gt; 명령어를 이용해 최근 수정된 파일, 생성된 파일 찾기
                &lt;ul&gt;
                  &lt;li&gt;변조를 감추기 위해 시간을 수정하는 경우 inode 변경시간 체크&lt;/li&gt;
                  &lt;li&gt;수정일 7일 이내인 파일 찾기
                    &lt;ul&gt;
                      &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;find [폴더] -type f -mtime 일수 -print&lt;/code&gt;&lt;/li&gt;
                    &lt;/ul&gt;
                  &lt;/li&gt;
                  &lt;li&gt;최근 5일동안 수정되거나 새롭게 생성된 파일을 찾아서 &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/var/aaa/test.out&lt;/code&gt; 파일에 저장
                    &lt;ul&gt;
                      &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;find / -ctime -5 -print &amp;gt; /var/aaa/test.out&lt;/code&gt;&lt;/li&gt;
                    &lt;/ul&gt;
                  &lt;/li&gt;
                  &lt;li&gt;setuid, setgid
                    &lt;ul&gt;
                      &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;find / -user root -perm -4000 -print &amp;gt; suidlist&lt;/code&gt;&lt;/li&gt;
                      &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;find / -user root -perm -2000 -print &amp;gt; sgidlist&lt;/code&gt;&lt;/li&gt;
                    &lt;/ul&gt;
                  &lt;/li&gt;
                &lt;/ul&gt;
              &lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/usr, /var, /dev, /tmp&lt;/code&gt; 디렉토리 안 파일 검사
            &lt;ul&gt;
              &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/dev&lt;/code&gt; 폴더 안 디바이스파일 이외의 일반파일이 있는 경우
                &lt;ul&gt;
                  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;find /dev -type f -print&lt;/code&gt;&lt;/li&gt;
                &lt;/ul&gt;
              &lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;. , ..&lt;/code&gt; 으로 시작하는 디렉토리
            &lt;ul&gt;
              &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ls&lt;/code&gt; 명령어를 옵션 없이 사용시 비노출 (숨겨진 디렉토리)&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;</content><author><name>HY03</name><email>hyunik03@gmail.com</email></author><category term="IS_Certification" /><category term="정보보안기사" /><category term="리눅스 침해사고" /><category term="초기 분석" /><category term="상세 분석" /><summary type="html">리눅스 침해사고 분석 기본 정보 수집 OS 종류, 커널 버전 사용 용도 운영중인 서비스 네트워크 접속 현황 보안 패치 적용 현황 네트워크 구성 형태 및 보안 장비 운영 현황 휘발성 정보 수집 프로세스 확인 ps -ef process 실행자 PID 실행 일시 프로세스명 lsof : List open file System 에서 동작중인 Process 에 의해서 열린 파일들에 대한 정보를 보여주는 명령 ps 명령어가 변조된 경우 공격자가 구동시킨 프로세스를 볼 수 없음 네트워크 상태 netstat -an 현재 시스템의 네트워크 연결 상태 확인 발신지 주소 확인 nmap : network mapper 네트워크 보안 유틸리티 대규모 네트워크를 고속으로 스캔 -sT : tcp 스캔 -p : 특정 포트 점검 nmap -sT -p [포트번호] [ip주소] fuser 어떤 프로세스에서 포트를 열었는지 확인 현재 사용중인 파일, 소켓이 사용하는 프로세스 확인 fuser 6001/tcp 위 명령어의 결과 (예:pid 6333) 를 활용해 ps [pid] 명령어 사용 사용자 로그인 상태 w 현재 시스템에 성공적으로 로그인한 사용자에 대한 Snapshot 제공 해당 사용자 목록 중에 w 명령어에 없는 (성공적으로 로그인) 사용자는 백도어를 이용했을 확률이 있음 사용자들이 어디에서 로그인을 했는지, 어떤 작업을 하는지 알 수 있음 utmp : 정보 파일 공격자를 규정하기 위해 자세히 봐야할 정보 접속 계정이 정상적인지 확인 접속출처가 정상 위치인지 확인 (내부 IP 주소 이외에 접속, 국외 IP 주소 접속 등) 접속 사용자의 정상적인 행위인지 확인 (Scan 도구 사용, 다른 서버에 서비스거부공격 등) 프로세스 확인, 네트워크 상태를 확인해 시스템의 상황을 파악하고 공격자의 단서를 찾음, 이후 세부사항 확인 상세분석 패스워드 파일 분석 /etc/passwd 관리자 권한을 가진 계정이 있는지 확인 : uid=0 user1:x:0:0::/home/user1:/bin/bash 새로 생성된 계정이나 패스워드가 없는 계정 확인 로그 파일 분석 사고가 일어난 뒤의 로그는 100% 신뢰할 수는 없다. 하지만 흔적은 어딘가에 남아있다. 로그파일 생성일자, 변경일자 확인 공격자는 공격을 통해 발생하는 시스템로그, 접속로그등을 삭제/변경함 주요 로그 파일 utmp : 현재 시스템에 로그인한 사용자의 정보 wtmp : 과거에 로그인했던 사용자의 정보 messages : 시스템 장애 정보 + 공격으로 인한 정보 웹로그 파일 access_log Host (도메인,IP주소) : 웹서버에 접속한 IP 주소 Identification : 사용자의 이름, - 로 표시 User Authentication : (사용자 인증이 된 경우) 패스워드가 표시되는 부분 Time Stamp : 방문자가 접속한 시간 (GMT - 그리니치 표준시 포함) HTTP Request 사용자 접속한 방식 (POST, GET) 접속파일 HTTP 버전 Status : 사용자가 요청한 내용을 처리한 결과 200 : Success 3xx : Redirection 4xx : Client Error 404 : NotFound 5xx : Server Error Transfer Volume : 요청한 파일의 용량, 없는 경우 0 또는 - 로 표시 access 루트킷 확인 Rootkit : 정상적 프로그램을 변조시킴 (주로 바이너리 파일) ls, ps, netstat, login, top, dir, du, ifconfig, find, tcpd … ls 명령어를 변조시켜 공격자가 만든 파일이 보이지 않도록 함 시스템 프로그램 파일크기, 생성시간, 변경시간 확인 /bin, /usr/bin 디렉토리 에서 ls -alct | more 명령을 통해 다른 프로그램이 기본적으로 설치된 시간과 다른 것이 있는지 확인 -&amp;gt; 파일사이즈 비교 ls -a : all - 숨겨진 파일, 디렉토리를 보고자 할때 -l : long - 자세한 내용을 출력. 권한, 파일 수, 소유자, 그룹, 파일크기, 수정일자 등 -c : ctime - 변경시간 MAC : mtime (수정), atime (접근), ctime (변경) 기본값 mtime 으로 출력 -u : atime -t : 시간순 정렬 -S : 파일 사이즈 순 정렬 무결성 검사 (리눅스) : rpm -Va s.5.....GT /bin/df s : 프로그램 사이즈 변경 5 : md5 checksum 값 변경 T : vkdlfdml mtime 값 변경 G : group 변경 u : user 변경 c : 설정파일 변경 무결성 검사 (솔라리스) : fingerprint 검사하고자 하는 파일의 checksum 값을 만들어 비교 strace : System 콜 추적 예) ps 명령어 추적 : strace -e trace=open ps|more 결과가 open(&quot;/usr/lib/locale/ro_RO/u~/procre) 이라고 나왔을 경우 ps 가 해당 파일을 참조 공격자가 숨기고 싶은 파일을 해당 파일에 등록 해킹 관련 파일 조사 피해 시스템에 공격자가 어떤 작업을 했는지 알아보기 위한 절차 타 시스템 스캔 공격 프로그램 설치 IRC 서버 설치 로그 삭제 스니퍼 프로그램 설치 새롭게 생긴 파일 찾기 find 명령어를 이용해 최근 수정된 파일, 생성된 파일 찾기 변조를 감추기 위해 시간을 수정하는 경우 inode 변경시간 체크 수정일 7일 이내인 파일 찾기 find [폴더] -type f -mtime 일수 -print 최근 5일동안 수정되거나 새롭게 생성된 파일을 찾아서 /var/aaa/test.out 파일에 저장 find / -ctime -5 -print &amp;gt; /var/aaa/test.out setuid, setgid find / -user root -perm -4000 -print &amp;gt; suidlist find / -user root -perm -2000 -print &amp;gt; sgidlist /usr, /var, /dev, /tmp 디렉토리 안 파일 검사 /dev 폴더 안 디바이스파일 이외의 일반파일이 있는 경우 find /dev -type f -print . , .. 으로 시작하는 디렉토리 ls 명령어를 옵션 없이 사용시 비노출 (숨겨진 디렉토리)</summary></entry><entry><title type="html">정보보안 - 윈도우 해킹프로그램 분석</title><link href="https://bluesplatter.com/is_certification/IS-IncidentAnalysis-WindowsHackingTools/" rel="alternate" type="text/html" title="정보보안 - 윈도우 해킹프로그램 분석" /><published>2022-01-07T09:00:00+09:00</published><updated>2022-01-07T09:00:00+09:00</updated><id>https://bluesplatter.com/is_certification/IS-IncidentAnalysis-WindowsHackingTools</id><content type="html" xml:base="https://bluesplatter.com/is_certification/IS-IncidentAnalysis-WindowsHackingTools/">&lt;h1 id=&quot;윈도우-해킹프로그램-분석&quot;&gt;윈도우 해킹프로그램 분석&lt;/h1&gt;
&lt;ul&gt;
  &lt;li&gt;해킹프로그램 분석
    &lt;ul&gt;
      &lt;li&gt;분석환경 구성
        &lt;ul&gt;
          &lt;li&gt;최소 2개 이상의 가상서버를 구동 (물리적 서버 필요)
            &lt;ul&gt;
              &lt;li&gt;Virtual Box&lt;/li&gt;
              &lt;li&gt;VMWare Workstation Pro&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;가상서버
            &lt;ul&gt;
              &lt;li&gt;가상네트워크를 일반네트워크와 똑같이 구축 (Samba, HTTP, FTP 등 제공)&lt;/li&gt;
              &lt;li&gt;가상 서버 OS 를 리눅스로 구축
                &lt;ul&gt;
                  &lt;li&gt;악성프로그램에 취약하지 않음&lt;/li&gt;
                &lt;/ul&gt;
              &lt;/li&gt;
              &lt;li&gt;가상 서버 OS 를 윈도우로 구축 (피해시스템 - 해킹프로그램을 실행하는 서버)&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;해킹프로그램이 실행될 때 시스템 파일에서 발생되는 내용과 레지스트리에서 발생하는 내용을 모니터링하는 프로그램 필요&lt;/li&gt;
          &lt;li&gt;테스트 후 이전 상태(초기상태)로 복구되어야 함
            &lt;ul&gt;
              &lt;li&gt;VMWare 의 Snapshot 기능을 이용&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;물리적 서버 (VMWare 서버)
            &lt;ul&gt;
              &lt;li&gt;DHCP&lt;/li&gt;
              &lt;li&gt;외부관리프로그램&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;리눅스 서버 (가상서버) - 서비스제공
            &lt;ul&gt;
              &lt;li&gt;Samba&lt;/li&gt;
              &lt;li&gt;DNS Server&lt;/li&gt;
              &lt;li&gt;Routing S/W&lt;/li&gt;
              &lt;li&gt;HTTP Server&lt;/li&gt;
              &lt;li&gt;SMTP Server&lt;/li&gt;
              &lt;li&gt;POP3 Server&lt;/li&gt;
              &lt;li&gt;IRC Server&lt;/li&gt;
              &lt;li&gt;Network Monitoring S/W&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;윈도우 서버 (가상서버) - 피해대상
            &lt;ul&gt;
              &lt;li&gt;악성코드 실행서버&lt;/li&gt;
              &lt;li&gt;파일시스템 모니터링&lt;/li&gt;
              &lt;li&gt;사용자정보 모니터링&lt;/li&gt;
              &lt;li&gt;레지스트리 모니터링&lt;/li&gt;
              &lt;li&gt;서비스항목 모니터링&lt;/li&gt;
              &lt;li&gt;공유폴더 모니터링&lt;/li&gt;
              &lt;li&gt;시스템항목 모니터링&lt;/li&gt;
              &lt;li&gt;네트워크항목 모니터링&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;sysAnalyzer 도구
        &lt;ul&gt;
          &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;http://sandsprite.com/iDef/SysAnalyzer&lt;/code&gt;&lt;/li&gt;
          &lt;li&gt;System에서 악성코드가 구동되는 동안 변경된 정보 수집, 비교, 분석하는 자동화된 툴&lt;/li&gt;
          &lt;li&gt;스냅샷을 비교하여 어떤 것이 바뀌었는지 비교
            &lt;ul&gt;
              &lt;li&gt;Delay&lt;/li&gt;
              &lt;li&gt;Sniffit Hit : IRC/HTTP 접속정보&lt;/li&gt;
              &lt;li&gt;API Logger : 바이너리에 Injection 되는 DLL 이 어떤 것이 호출되는지 확인&lt;/li&gt;
              &lt;li&gt;Directory Watcher : 모니터링 되는 시점에서 생성되는 모든 파일 확인&lt;/li&gt;
              &lt;li&gt;시점별로 실행된 프로세스 확인&lt;/li&gt;
              &lt;li&gt;악성코드에 의해 오픈된 포트&lt;/li&gt;
              &lt;li&gt;explorer.exe 로드된 DLL 파일&lt;/li&gt;
              &lt;li&gt;커널에 로드된 모듈&lt;/li&gt;
              &lt;li&gt;변경 / 생성된 레지스트리 키&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;Malcode Analysis Pack
        &lt;ul&gt;
          &lt;li&gt;악성코드 조사&lt;/li&gt;
          &lt;li&gt;Shell Ext : 문자열 확인&lt;/li&gt;
          &lt;li&gt;SocketTool : TCP 클라이언트 모니터링&lt;/li&gt;
          &lt;li&gt;MailPot : 메일서버 캡처 프로그램&lt;/li&gt;
          &lt;li&gt;fakeDNS : 스푸핑 미니 DNS 서버 프로그램. 악성프로그램이 접속하는 도메인을 다른 곳으로 유도하는 프로그램&lt;/li&gt;
          &lt;li&gt;Sniff_Hit : HTTP, IRC, DNS 스니퍼&lt;/li&gt;
          &lt;li&gt;sclog : 악성코드에서 사용하는 쉘코드 분석&lt;/li&gt;
          &lt;li&gt;GdiProcs : 숨겨진 프로세스 탐지&lt;/li&gt;
          &lt;li&gt;Shellcode2Exe : 인코드된 쉘코드로 변환하는 php 스크립트 프로그램 (3:27)&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;모니터링 프로그램 활용
        &lt;ul&gt;
          &lt;li&gt;파일 모니터링 : &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Filemon&lt;/code&gt;&lt;/li&gt;
          &lt;li&gt;레지스터 모니터링 : &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Regmon&lt;/code&gt;&lt;/li&gt;
          &lt;li&gt;CPU성능 모니터링 : &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Cpumon&lt;/code&gt;&lt;/li&gt;
          &lt;li&gt;네트워크 모니터링 : &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;TCPView&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;TDImon&lt;/code&gt;&lt;/li&gt;
          &lt;li&gt;프로세스 모니터링 : &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;procexp&lt;/code&gt;&lt;/li&gt;
          &lt;li&gt;스냅샷 모니터링 : &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Winanalysys&lt;/code&gt;&lt;/li&gt;
          &lt;li&gt;API 함수 추적 : &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;API SPY&lt;/code&gt;&lt;/li&gt;
          &lt;li&gt;네트워크 트래픽 분석 : &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ethereal&lt;/code&gt;&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;</content><author><name>HY03</name><email>hyunik03@gmail.com</email></author><category term="IS_Certification" /><category term="정보보안기사" /><category term="윈도우 침해사고" /><category term="해킹 프로그램" /><summary type="html">윈도우 해킹프로그램 분석 해킹프로그램 분석 분석환경 구성 최소 2개 이상의 가상서버를 구동 (물리적 서버 필요) Virtual Box VMWare Workstation Pro 가상서버 가상네트워크를 일반네트워크와 똑같이 구축 (Samba, HTTP, FTP 등 제공) 가상 서버 OS 를 리눅스로 구축 악성프로그램에 취약하지 않음 가상 서버 OS 를 윈도우로 구축 (피해시스템 - 해킹프로그램을 실행하는 서버) 해킹프로그램이 실행될 때 시스템 파일에서 발생되는 내용과 레지스트리에서 발생하는 내용을 모니터링하는 프로그램 필요 테스트 후 이전 상태(초기상태)로 복구되어야 함 VMWare 의 Snapshot 기능을 이용 물리적 서버 (VMWare 서버) DHCP 외부관리프로그램 리눅스 서버 (가상서버) - 서비스제공 Samba DNS Server Routing S/W HTTP Server SMTP Server POP3 Server IRC Server Network Monitoring S/W 윈도우 서버 (가상서버) - 피해대상 악성코드 실행서버 파일시스템 모니터링 사용자정보 모니터링 레지스트리 모니터링 서비스항목 모니터링 공유폴더 모니터링 시스템항목 모니터링 네트워크항목 모니터링 sysAnalyzer 도구 http://sandsprite.com/iDef/SysAnalyzer System에서 악성코드가 구동되는 동안 변경된 정보 수집, 비교, 분석하는 자동화된 툴 스냅샷을 비교하여 어떤 것이 바뀌었는지 비교 Delay Sniffit Hit : IRC/HTTP 접속정보 API Logger : 바이너리에 Injection 되는 DLL 이 어떤 것이 호출되는지 확인 Directory Watcher : 모니터링 되는 시점에서 생성되는 모든 파일 확인 시점별로 실행된 프로세스 확인 악성코드에 의해 오픈된 포트 explorer.exe 로드된 DLL 파일 커널에 로드된 모듈 변경 / 생성된 레지스트리 키 Malcode Analysis Pack 악성코드 조사 Shell Ext : 문자열 확인 SocketTool : TCP 클라이언트 모니터링 MailPot : 메일서버 캡처 프로그램 fakeDNS : 스푸핑 미니 DNS 서버 프로그램. 악성프로그램이 접속하는 도메인을 다른 곳으로 유도하는 프로그램 Sniff_Hit : HTTP, IRC, DNS 스니퍼 sclog : 악성코드에서 사용하는 쉘코드 분석 GdiProcs : 숨겨진 프로세스 탐지 Shellcode2Exe : 인코드된 쉘코드로 변환하는 php 스크립트 프로그램 (3:27) 모니터링 프로그램 활용 파일 모니터링 : Filemon 레지스터 모니터링 : Regmon CPU성능 모니터링 : Cpumon 네트워크 모니터링 : TCPView, TDImon 프로세스 모니터링 : procexp 스냅샷 모니터링 : Winanalysys API 함수 추적 : API SPY 네트워크 트래픽 분석 : ethereal</summary></entry><entry><title type="html">정보보안 - 윈도우 침해사고 상세분석</title><link href="https://bluesplatter.com/is_certification/IS-IncidentAnalysis-WindowsDetailAnalysis/" rel="alternate" type="text/html" title="정보보안 - 윈도우 침해사고 상세분석" /><published>2022-01-01T09:00:00+09:00</published><updated>2022-01-01T09:00:00+09:00</updated><id>https://bluesplatter.com/is_certification/IS-IncidentAnalysis-WindowsDetailAnalysis</id><content type="html" xml:base="https://bluesplatter.com/is_certification/IS-IncidentAnalysis-WindowsDetailAnalysis/">&lt;h1 id=&quot;윈도우-침해사고-상세분석&quot;&gt;윈도우 침해사고 상세분석&lt;/h1&gt;
&lt;ul&gt;
  &lt;li&gt;분류
    &lt;ul&gt;
      &lt;li&gt;레지스트리 분석
        &lt;ul&gt;
          &lt;li&gt;시스템이 운영되는데 필요한 정보를 담고 있는 파일
            &lt;ul&gt;
              &lt;li&gt;설치된 S/W 정보, 환경설정, 임시저장값&lt;/li&gt;
              &lt;li&gt;시스템의 모든 정보 포함&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;공격자의 흔적을 알아낼 수 있음&lt;/li&gt;
          &lt;li&gt;시작프로그램 등록 관련 레지스트리
            &lt;ul&gt;
              &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;HKLM\Software\Microsoft\Windows\CurrentVersion\Run&lt;/code&gt;&lt;/li&gt;
              &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;HKLM\Software\Microsoft\Windows\CurrentVersion\RunOnce&lt;/code&gt;&lt;/li&gt;
              &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;HKLM\Software\Microsoft\Windows\CurrentVersion\RunOnceEx&lt;/code&gt;&lt;/li&gt;
              &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;HKLM\Software\Microsoft\Windows\CurrentVersion\RunServices&lt;/code&gt;&lt;/li&gt;
              &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;HKLM\Software\Microsoft\Windows\CurrentVersion\RunServicesOnce&lt;/code&gt;&lt;/li&gt;
              &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;HKLM\Software\Microsoft\Windows\CurrentVersion\Windows\Load&lt;/code&gt;&lt;/li&gt;
              &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;HKLM\Software\Microsoft\Windows\CurrentVersion\Windows\Run&lt;/code&gt;&lt;/li&gt;
              &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;HKLM\Software\Microsoft\Windows\CurrentVersion\Winlogon\UserInit&lt;/code&gt;&lt;/li&gt;
              &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;HKCU\Software\Microsoft\Windows\CurrentVersion\Run&lt;/code&gt;&lt;/li&gt;
              &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;HKCU\Software\Microsoft\Windows\CurrentVersion\RunOnce&lt;/code&gt;&lt;/li&gt;
              &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;HKCU\Software\Microsoft\Windows\CurrentVersion\RunOnceEx&lt;/code&gt;&lt;/li&gt;
              &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;HKCU\Software\Microsoft\Windows\CurrentVersion\RunServicesOnce&lt;/code&gt;&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Autoruns&lt;/code&gt; : 시작 레지스트리 Check (Sysinternals.com)&lt;/li&gt;
          &lt;li&gt;공격자가 남긴 레지스트리 정보 수집
            &lt;ul&gt;
              &lt;li&gt;최근 사용한 문서 목록
                &lt;ul&gt;
                  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Recentdocs&lt;/code&gt;&lt;/li&gt;
                &lt;/ul&gt;
              &lt;/li&gt;
              &lt;li&gt;터미널 서비스 접속 목록
                &lt;ul&gt;
                  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;HKCU\Software\Microsoft\Terminal Server Client\Default&lt;/code&gt;&lt;/li&gt;
                &lt;/ul&gt;
              &lt;/li&gt;
              &lt;li&gt;설치된 S/W 목록&lt;/li&gt;
              &lt;li&gt;열어본 파일 목록&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;자동실행 점검 - &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Autoruns&lt;/code&gt; 를 통해 점검 가능
        &lt;ul&gt;
          &lt;li&gt;서비스 점검
            &lt;ul&gt;
              &lt;li&gt;공격자가 윈도우 서비스에 악성 프로그램을 등록, 시스템 재부팅 시 악성 프로그램 실행&lt;/li&gt;
              &lt;li&gt;생소한 이름의 서비스&lt;/li&gt;
              &lt;li&gt;Description 영역의 내용이 비어있는 경우 / 영문으로 되어있는 경우&lt;/li&gt;
              &lt;li&gt;정상적 서비스 이름을 위장하는 경우
                &lt;ul&gt;
                  &lt;li&gt;Backup System&lt;/li&gt;
                  &lt;li&gt;Remote Administrator Service&lt;/li&gt;
                  &lt;li&gt;System spooler Host&lt;/li&gt;
                  &lt;li&gt;Windows Management Drivers&lt;/li&gt;
                  &lt;li&gt;Universal Serial Bus Control Component&lt;/li&gt;
                &lt;/ul&gt;
              &lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;스케줄된 작업 확인
            &lt;ul&gt;
              &lt;li&gt;시스템이 재부팅 되더라도 악성 프로그램이 실행될 수 있음&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;자동시작 폴더 점검
            &lt;ul&gt;
              &lt;li&gt;윈도우 재시작 시 자동시작 폴더 내 각종 프로그램들을 실행함&lt;/li&gt;
              &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;c:\Documents and Settings\Administrator\시작메뉴\프로그램\시작프로그램&lt;/code&gt;&lt;/li&gt;
              &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\ShellFolders&lt;/code&gt;&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;Winlogon Notification DLL
            &lt;ul&gt;
              &lt;li&gt;적은 코드로 구현이 가능, 안전모드에서 원하는 코드를 실행 가능&lt;/li&gt;
              &lt;li&gt;WinLogon.exe 파일에서 발생하는 이벤트 핸들러를 이용하여 원하는 코드를 실행 가능
                &lt;ul&gt;
                  &lt;li&gt;Logon, Logoff, Startup, Shutdown, ScreenSaver 이벤트 등&lt;/li&gt;
                &lt;/ul&gt;
              &lt;/li&gt;
              &lt;li&gt;악성코드 활용 소지가 있음&lt;/li&gt;
              &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;HKLM\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\Notify\&lt;/code&gt;
                &lt;ul&gt;
                  &lt;li&gt;DllName = arprmdg0.dll (악성코드 예시)&lt;/li&gt;
                  &lt;li&gt;Startup = arprmdg0&lt;/li&gt;
                  &lt;li&gt;Impersonate = 1 (인격화. 보안 환경변수 설정시 주로 설정, 인증된 사용자 계정으로 자원 실행할 수 있게 함)&lt;/li&gt;
                &lt;/ul&gt;
              &lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;이벤트 로그 분석
        &lt;ul&gt;
          &lt;li&gt;공격자가 남긴 흔적, 활동 등의 정보를 찾아내기 위함&lt;/li&gt;
          &lt;li&gt;H/W, S/W, 시스템 문제 시 이벤트로그에 저장함 -&amp;gt; 이벤트뷰어를 통해 확인
            &lt;ul&gt;
              &lt;li&gt;관리도구 -&amp;gt; 이벤트뷰어 (eventvwr.msc)
                &lt;ul&gt;
                  &lt;li&gt;보안로그&lt;/li&gt;
                  &lt;li&gt;시스템로그&lt;/li&gt;
                  &lt;li&gt;응용프로그램로그&lt;/li&gt;
                &lt;/ul&gt;
              &lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;공격자들은 자신의 흔적을 최소화 하기 위해 &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ClearEvent&lt;/code&gt; 프로그램을 사용 (이벤트로그를 삭제)&lt;/li&gt;
          &lt;li&gt;공격자가 남기는 로그 유형
            &lt;ul&gt;
              &lt;li&gt;로컬 로그온 시도 실패&lt;/li&gt;
              &lt;li&gt;계정의 잘못된 사용 (없는 계정 로그인 시도)&lt;/li&gt;
              &lt;li&gt;계정 잠김&lt;/li&gt;
              &lt;li&gt;터미널서비스 공격&lt;/li&gt;
              &lt;li&gt;사용자계정 생성&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;MAC time 분석
        &lt;ul&gt;
          &lt;li&gt;파일, 디렉터리 등 파일시스템은 시간속성을 가지고 있음&lt;/li&gt;
          &lt;li&gt;공격자가 파일시스템을 통해서 어떠한 행동을 했는지 판단 (어떤 파일이 생성, 수정, 실행되었는지?)&lt;/li&gt;
          &lt;li&gt;mtime : 파일 수정, 생성&lt;/li&gt;
          &lt;li&gt;atime : 최근 파일을 읽은 시간, 실행한 시간&lt;/li&gt;
          &lt;li&gt;ctime : 파일 속성 변경 시간&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;침입방법 분석
        &lt;ul&gt;
          &lt;li&gt;공격자가 어떻게 침입했는지 분석 (사고 조치 이외에 원인분석을 하지 않으면 사고가 재발할 수 있음)&lt;/li&gt;
          &lt;li&gt;윈도우에서 해킹발생 취약점 분류 (대부분 해킹사고는 시스템 보안 업데이트 미실시, 웹서비스 취약점이 원인)
            &lt;ul&gt;
              &lt;li&gt;윈도우 취약점
                &lt;ul&gt;
                  &lt;li&gt;시스템 취약점 (보안업데이트 미실시)
                    &lt;ul&gt;
                      &lt;li&gt;최종 보안 업데이트 날짜 파악이 중요
                        &lt;ul&gt;
                          &lt;li&gt;원격 공격 가능한 취약점이 있는지 파악&lt;/li&gt;
                        &lt;/ul&gt;
                      &lt;/li&gt;
                      &lt;li&gt;MS 에서 제공하는 Microsoft Baseline Security Analyzer 로 확인
                        &lt;ul&gt;
                          &lt;li&gt;보안패치 상태&lt;/li&gt;
                          &lt;li&gt;IIS 상태&lt;/li&gt;
                          &lt;li&gt;SQL 상태&lt;/li&gt;
                        &lt;/ul&gt;
                      &lt;/li&gt;
                    &lt;/ul&gt;
                  &lt;/li&gt;
                  &lt;li&gt;패스워드 취약점&lt;/li&gt;
                  &lt;li&gt;잘못된 공유설정&lt;/li&gt;
                &lt;/ul&gt;
              &lt;/li&gt;
              &lt;li&gt;웹 어플리케이션 취약점
                &lt;ul&gt;
                  &lt;li&gt;웹서비스 취약점
                    &lt;ul&gt;
                      &lt;li&gt;해킹 발생 시점에 발생한 로그를 분석하여 공격여부, 공격방법등을 파악&lt;/li&gt;
                      &lt;li&gt;IIS 로그 : &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;C:\WINNT\system32\LogFiles\W3SVC1&lt;/code&gt;&lt;/li&gt;
                    &lt;/ul&gt;
                  &lt;/li&gt;
                  &lt;li&gt;SQL Injection&lt;/li&gt;
                  &lt;li&gt;파일업로드&lt;/li&gt;
                &lt;/ul&gt;
              &lt;/li&gt;
              &lt;li&gt;MS-SQL 취약점
                &lt;ul&gt;
                  &lt;li&gt;Default password 사용&lt;/li&gt;
                  &lt;li&gt;패치 미실시&lt;/li&gt;
                &lt;/ul&gt;
              &lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;인터넷 임시파일 분석
        &lt;ul&gt;
          &lt;li&gt;브라우저와 연관
            &lt;ul&gt;
              &lt;li&gt;접속한 사이트의 페이지가 임시파일에 저장됨&lt;/li&gt;
              &lt;li&gt;접속 흔적이 히스토리에 남음&lt;/li&gt;
              &lt;li&gt;사용된 쿠키가 디스크에 저장됨&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;파일 위치 : &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;indexView&lt;/code&gt; 도구를 다운받아 쉽게 분석 가능
            &lt;ul&gt;
              &lt;li&gt;임시 인터넷 객체 : &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Download Program Files&lt;/code&gt; - 인터넷에서 다운로드 받은 파일들&lt;/li&gt;
              &lt;li&gt;임시 인터넷 파일 : &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Local Settings\Temporary Internet Files&lt;/code&gt; - 방문한 사이트 페이지&lt;/li&gt;
              &lt;li&gt;열어본 페이지 : &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Local Settings\History&lt;/code&gt; - 방문한 사이트 이름&lt;/li&gt;
              &lt;li&gt;임시쿠키 파일 : &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Local Settings\COOKIES&lt;/code&gt;&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;</content><author><name>HY03</name><email>hyunik03@gmail.com</email></author><category term="IS_Certification" /><category term="정보보안기사" /><category term="윈도우 침해사고" /><category term="상세분석" /><summary type="html">윈도우 침해사고 상세분석 분류 레지스트리 분석 시스템이 운영되는데 필요한 정보를 담고 있는 파일 설치된 S/W 정보, 환경설정, 임시저장값 시스템의 모든 정보 포함 공격자의 흔적을 알아낼 수 있음 시작프로그램 등록 관련 레지스트리 HKLM\Software\Microsoft\Windows\CurrentVersion\Run HKLM\Software\Microsoft\Windows\CurrentVersion\RunOnce HKLM\Software\Microsoft\Windows\CurrentVersion\RunOnceEx HKLM\Software\Microsoft\Windows\CurrentVersion\RunServices HKLM\Software\Microsoft\Windows\CurrentVersion\RunServicesOnce HKLM\Software\Microsoft\Windows\CurrentVersion\Windows\Load HKLM\Software\Microsoft\Windows\CurrentVersion\Windows\Run HKLM\Software\Microsoft\Windows\CurrentVersion\Winlogon\UserInit HKCU\Software\Microsoft\Windows\CurrentVersion\Run HKCU\Software\Microsoft\Windows\CurrentVersion\RunOnce HKCU\Software\Microsoft\Windows\CurrentVersion\RunOnceEx HKCU\Software\Microsoft\Windows\CurrentVersion\RunServicesOnce Autoruns : 시작 레지스트리 Check (Sysinternals.com) 공격자가 남긴 레지스트리 정보 수집 최근 사용한 문서 목록 HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Recentdocs 터미널 서비스 접속 목록 HKCU\Software\Microsoft\Terminal Server Client\Default 설치된 S/W 목록 열어본 파일 목록 자동실행 점검 - Autoruns 를 통해 점검 가능 서비스 점검 공격자가 윈도우 서비스에 악성 프로그램을 등록, 시스템 재부팅 시 악성 프로그램 실행 생소한 이름의 서비스 Description 영역의 내용이 비어있는 경우 / 영문으로 되어있는 경우 정상적 서비스 이름을 위장하는 경우 Backup System Remote Administrator Service System spooler Host Windows Management Drivers Universal Serial Bus Control Component 스케줄된 작업 확인 시스템이 재부팅 되더라도 악성 프로그램이 실행될 수 있음 자동시작 폴더 점검 윈도우 재시작 시 자동시작 폴더 내 각종 프로그램들을 실행함 c:\Documents and Settings\Administrator\시작메뉴\프로그램\시작프로그램 HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\ShellFolders Winlogon Notification DLL 적은 코드로 구현이 가능, 안전모드에서 원하는 코드를 실행 가능 WinLogon.exe 파일에서 발생하는 이벤트 핸들러를 이용하여 원하는 코드를 실행 가능 Logon, Logoff, Startup, Shutdown, ScreenSaver 이벤트 등 악성코드 활용 소지가 있음 HKLM\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\Notify\ DllName = arprmdg0.dll (악성코드 예시) Startup = arprmdg0 Impersonate = 1 (인격화. 보안 환경변수 설정시 주로 설정, 인증된 사용자 계정으로 자원 실행할 수 있게 함) 이벤트 로그 분석 공격자가 남긴 흔적, 활동 등의 정보를 찾아내기 위함 H/W, S/W, 시스템 문제 시 이벤트로그에 저장함 -&amp;gt; 이벤트뷰어를 통해 확인 관리도구 -&amp;gt; 이벤트뷰어 (eventvwr.msc) 보안로그 시스템로그 응용프로그램로그 공격자들은 자신의 흔적을 최소화 하기 위해 ClearEvent 프로그램을 사용 (이벤트로그를 삭제) 공격자가 남기는 로그 유형 로컬 로그온 시도 실패 계정의 잘못된 사용 (없는 계정 로그인 시도) 계정 잠김 터미널서비스 공격 사용자계정 생성 MAC time 분석 파일, 디렉터리 등 파일시스템은 시간속성을 가지고 있음 공격자가 파일시스템을 통해서 어떠한 행동을 했는지 판단 (어떤 파일이 생성, 수정, 실행되었는지?) mtime : 파일 수정, 생성 atime : 최근 파일을 읽은 시간, 실행한 시간 ctime : 파일 속성 변경 시간 침입방법 분석 공격자가 어떻게 침입했는지 분석 (사고 조치 이외에 원인분석을 하지 않으면 사고가 재발할 수 있음) 윈도우에서 해킹발생 취약점 분류 (대부분 해킹사고는 시스템 보안 업데이트 미실시, 웹서비스 취약점이 원인) 윈도우 취약점 시스템 취약점 (보안업데이트 미실시) 최종 보안 업데이트 날짜 파악이 중요 원격 공격 가능한 취약점이 있는지 파악 MS 에서 제공하는 Microsoft Baseline Security Analyzer 로 확인 보안패치 상태 IIS 상태 SQL 상태 패스워드 취약점 잘못된 공유설정 웹 어플리케이션 취약점 웹서비스 취약점 해킹 발생 시점에 발생한 로그를 분석하여 공격여부, 공격방법등을 파악 IIS 로그 : C:\WINNT\system32\LogFiles\W3SVC1 SQL Injection 파일업로드 MS-SQL 취약점 Default password 사용 패치 미실시 인터넷 임시파일 분석 브라우저와 연관 접속한 사이트의 페이지가 임시파일에 저장됨 접속 흔적이 히스토리에 남음 사용된 쿠키가 디스크에 저장됨 파일 위치 : indexView 도구를 다운받아 쉽게 분석 가능 임시 인터넷 객체 : Download Program Files - 인터넷에서 다운로드 받은 파일들 임시 인터넷 파일 : Local Settings\Temporary Internet Files - 방문한 사이트 페이지 열어본 페이지 : Local Settings\History - 방문한 사이트 이름 임시쿠키 파일 : Local Settings\COOKIES</summary></entry><entry><title type="html">정보보안 - 윈도우 루트킷 점검</title><link href="https://bluesplatter.com/is_certification/IS-IncidentAnalysis-WindowsRootkit/" rel="alternate" type="text/html" title="정보보안 - 윈도우 루트킷 점검" /><published>2021-12-31T09:00:00+09:00</published><updated>2021-12-31T09:00:00+09:00</updated><id>https://bluesplatter.com/is_certification/IS-IncidentAnalysis-WindowsRootkit</id><content type="html" xml:base="https://bluesplatter.com/is_certification/IS-IncidentAnalysis-WindowsRootkit/">&lt;h1 id=&quot;윈도우-루트킷-점검&quot;&gt;윈도우 루트킷 점검&lt;/h1&gt;
&lt;ul&gt;
  &lt;li&gt;Rootkit
    &lt;ul&gt;
      &lt;li&gt;정의
        &lt;ul&gt;
          &lt;li&gt;시스템에 탐지되지 않도록 하는 코드, 프로그램 집합&lt;/li&gt;
          &lt;li&gt;시스템 관리자 권한을 획득하기 위한 프로그램&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;구분
        &lt;ul&gt;
          &lt;li&gt;사용자모드
            &lt;ul&gt;
              &lt;li&gt;파일교체 (DLL, IAT후킹, API 엔트리패치 방법을 이용해서 정보를 숨김)&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;커널모드
            &lt;ul&gt;
              &lt;li&gt;Native API (ntdll.dll, Kernel32.dll, user32.dll) 조작&lt;/li&gt;
              &lt;li&gt;커널드라이브 - Win32 응용프로그램 간의 Data를 조작&lt;/li&gt;
              &lt;li&gt;공격자의 정보를 숨김&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;기능
        &lt;ul&gt;
          &lt;li&gt;프로세스 / 스레드 감추기&lt;/li&gt;
          &lt;li&gt;프로세스 보안설정 변경 / 제거&lt;/li&gt;
          &lt;li&gt;파일 / 폴더 감추기&lt;/li&gt;
          &lt;li&gt;레지스트리 / 서비스 감추기&lt;/li&gt;
          &lt;li&gt;네트워크 정보 감추기&lt;/li&gt;
          &lt;li&gt;스니핑, 시스템 제어&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;윈도우 루트킷 종류
    &lt;ul&gt;
      &lt;li&gt;Hacker Defender
        &lt;ul&gt;
          &lt;li&gt;현재 가장 광범위하게 사용됨&lt;/li&gt;
          &lt;li&gt;다양한 변종이 존재&lt;/li&gt;
          &lt;li&gt;프로세스, 네트워크, 시작프로그램, 레지스트리, 서비스 등을 숨기는 가장 많은 기능 제공&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;FU
        &lt;ul&gt;
          &lt;li&gt;“EPROCESS” 의 링크 조작을 통한 프로세스를 숨기는 기능 제공
            &lt;ul&gt;
              &lt;li&gt;중요한 정보들이 목록화 되어있는 파일&lt;/li&gt;
              &lt;li&gt;시스템 커널이 실행중인 모든 프로세스의 리스트를 찾고자 할 때 사용
                &lt;ul&gt;
                  &lt;li&gt;윈도우 커널의 경우 프로세스가 아닌 스레드 기반으로 동작&lt;/li&gt;
                  &lt;li&gt;연결리스트 포인터 수정 가능&lt;/li&gt;
                &lt;/ul&gt;
              &lt;/li&gt;
              &lt;li&gt;ActiveProcessLinks 의 Linked List 를 조작&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;Vanquish
        &lt;ul&gt;
          &lt;li&gt;DLL 인젝션 기법을 사용한 루트킷&lt;/li&gt;
          &lt;li&gt;프로세스, 레지스트리, 서비스를 숨기는 기능&lt;/li&gt;
          &lt;li&gt;로그인 정보 기록 기능 제공&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;AFX rootkit
        &lt;ul&gt;
          &lt;li&gt;코드 인젝션과 API 후킹을 사용하는 루트킷&lt;/li&gt;
          &lt;li&gt;프로세스, 모듈, 핸들, 파일, 포트, 레지스트리 등을 숨길 수 있는 기능 제공&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;NT Rootkit
        &lt;ul&gt;
          &lt;li&gt;초기 윈도우 루트킷으로 현재까지 업데이트가 없는 상태임&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;윈도우 루트킷 탐지 도구
    &lt;ul&gt;
      &lt;li&gt;procexp&lt;/li&gt;
      &lt;li&gt;Rootkit Receiver&lt;/li&gt;
      &lt;li&gt;BlackLight&lt;/li&gt;
      &lt;li&gt;AntiRootkit&lt;/li&gt;
      &lt;li&gt;IceSword&lt;/li&gt;
      &lt;li&gt;Archon&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;</content><author><name>HY03</name><email>hyunik03@gmail.com</email></author><category term="IS_Certification" /><category term="정보보안기사" /><category term="윈도우 침해사고" /><category term="루트킷" /><summary type="html">윈도우 루트킷 점검 Rootkit 정의 시스템에 탐지되지 않도록 하는 코드, 프로그램 집합 시스템 관리자 권한을 획득하기 위한 프로그램 구분 사용자모드 파일교체 (DLL, IAT후킹, API 엔트리패치 방법을 이용해서 정보를 숨김) 커널모드 Native API (ntdll.dll, Kernel32.dll, user32.dll) 조작 커널드라이브 - Win32 응용프로그램 간의 Data를 조작 공격자의 정보를 숨김 기능 프로세스 / 스레드 감추기 프로세스 보안설정 변경 / 제거 파일 / 폴더 감추기 레지스트리 / 서비스 감추기 네트워크 정보 감추기 스니핑, 시스템 제어 윈도우 루트킷 종류 Hacker Defender 현재 가장 광범위하게 사용됨 다양한 변종이 존재 프로세스, 네트워크, 시작프로그램, 레지스트리, 서비스 등을 숨기는 가장 많은 기능 제공 FU “EPROCESS” 의 링크 조작을 통한 프로세스를 숨기는 기능 제공 중요한 정보들이 목록화 되어있는 파일 시스템 커널이 실행중인 모든 프로세스의 리스트를 찾고자 할 때 사용 윈도우 커널의 경우 프로세스가 아닌 스레드 기반으로 동작 연결리스트 포인터 수정 가능 ActiveProcessLinks 의 Linked List 를 조작 Vanquish DLL 인젝션 기법을 사용한 루트킷 프로세스, 레지스트리, 서비스를 숨기는 기능 로그인 정보 기록 기능 제공 AFX rootkit 코드 인젝션과 API 후킹을 사용하는 루트킷 프로세스, 모듈, 핸들, 파일, 포트, 레지스트리 등을 숨길 수 있는 기능 제공 NT Rootkit 초기 윈도우 루트킷으로 현재까지 업데이트가 없는 상태임 윈도우 루트킷 탐지 도구 procexp Rootkit Receiver BlackLight AntiRootkit IceSword Archon</summary></entry><entry><title type="html">정보보안 - 윈도우 사고 초기분석</title><link href="https://bluesplatter.com/is_certification/IS-IncidentAnalysis-WindowsInitialResponse/" rel="alternate" type="text/html" title="정보보안 - 윈도우 사고 초기분석" /><published>2021-12-30T09:00:00+09:00</published><updated>2021-12-30T09:00:00+09:00</updated><id>https://bluesplatter.com/is_certification/IS-IncidentAnalysis-WindowsInitialResponse</id><content type="html" xml:base="https://bluesplatter.com/is_certification/IS-IncidentAnalysis-WindowsInitialResponse/">&lt;h1 id=&quot;윈도우-침해사고-초기분석&quot;&gt;윈도우 침해사고 초기분석&lt;/h1&gt;
&lt;ul&gt;
  &lt;li&gt;초기분석 : 현재 피해시스템의 상황을 빠른 시간 안에 파악한다. (포렌식 툴을 사용하지 않는다는 가정 / 커맨드에서 실행)
    &lt;ul&gt;
      &lt;li&gt;시스템 시간 확인
        &lt;ul&gt;
          &lt;li&gt;공격자가 시스템 시간을 변경할 수 있음&lt;/li&gt;
          &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;date /T&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;time /T&lt;/code&gt; 등의 명령어 사용&lt;/li&gt;
          &lt;li&gt;uptime : 시스템의 부팅시간 정보를 알려줌 (추가 다운로드 필요-sysinternals.com)&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;시스템 정보
        &lt;ul&gt;
          &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;psinfo -h -s&lt;/code&gt; : OS 기본정보, 보안 업데이트 정보, 설치된 S/W 정보 (추가 다운로드 필요-sysinternals.com)&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;프로세스 정보 확인 (휘발성 증거)
        &lt;ul&gt;
          &lt;li&gt;공격자가 실행시킨 악성프로그램 확인
            &lt;ul&gt;
              &lt;li&gt;실행 프로세스명&lt;/li&gt;
              &lt;li&gt;프로세스 실행 파일 위치&lt;/li&gt;
              &lt;li&gt;프로세스 커맨드라인&lt;/li&gt;
              &lt;li&gt;프로세스 실행시간&lt;/li&gt;
              &lt;li&gt;프로세스 가 참조하고 있는 DLL 및 기타 파일&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;pslist&lt;/code&gt; 명령어사용 (추가 다운로드 필요-sysinternals.com)
            &lt;ul&gt;
              &lt;li&gt;현재 구동중인 프로세스 목록 조회&lt;/li&gt;
              &lt;li&gt;프로세스 실행시간 확인&lt;/li&gt;
              &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-t&lt;/code&gt; : 트리구조 옵션 (자식프로세스)&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;정상적인 윈도우 프로세스인지 확인하기 위한 용도
            &lt;ul&gt;
              &lt;li&gt;흔히 볼수 없었던 프로세스명은 악성코드일 확률이 있음&lt;/li&gt;
              &lt;li&gt;정상파일로 위장을 해서 악성프로그램 실행을 하는 경우 실행파일 위치를 확인해야 함&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;프로그램들이 사용하는 DLL 을 자세히 점검할 필요가 있음
            &lt;ul&gt;
              &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;listdlls&lt;/code&gt; (추가 다운로드 필요-sysinternals.com) : dll 경로, 사이즈, 버전정보
                &lt;ul&gt;
                  &lt;li&gt;프로세스들이 사용하는 DLL 정보 출력&lt;/li&gt;
                &lt;/ul&gt;
              &lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;handle&lt;/code&gt; 명령어 사용 (추가 다운로드 필요-sysinternals.com)
            &lt;ul&gt;
              &lt;li&gt;악성 봇 프로그램 같은 경우 프로세스가 참조하는 파일(설정파일 등)을 출력해야 함&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;네트워크 정보 확인 (휘발성 증거) - 공격자의 흔적 추적
        &lt;ul&gt;
          &lt;li&gt;피해시스템의 네트워크 정보&lt;/li&gt;
          &lt;li&gt;서비스를 열고 있는 어플리케이션 정보&lt;/li&gt;
          &lt;li&gt;서비스에 연결되어 있는 세션 정보&lt;/li&gt;
          &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ipconfig /all&lt;/code&gt; 명령어 사용 - IP 확인&lt;/li&gt;
          &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;netstat -an&lt;/code&gt;
            &lt;ul&gt;
              &lt;li&gt;프로토콜의 상태 확인&lt;/li&gt;
              &lt;li&gt;IP 기반의 네트워크 연결 정보 확인&lt;/li&gt;
              &lt;li&gt;현재 열려있는 포트&lt;/li&gt;
              &lt;li&gt;포트에 연결되어 있는 IP 정보&lt;/li&gt;
              &lt;li&gt;시스템이 사용하지 않는 포트가 LISTENING 상태로 있는지 확인
                &lt;ul&gt;
                  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;telnet&lt;/code&gt; 이나 &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;nc&lt;/code&gt; 등의 명령어로 어떤 어플리케이션이 해당 포트를 구동중인지 확인&lt;/li&gt;
                &lt;/ul&gt;
              &lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;fpont&lt;/code&gt; (추가 다운로드 필요-foundstone.com)
            &lt;ul&gt;
              &lt;li&gt;해당 포트에서 사용하고 있는 프로세스 확인 가능&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;promiscdetect&lt;/code&gt; (추가 다운로드 필요 - tesecurity.nu)
            &lt;ul&gt;
              &lt;li&gt;NIC 카드가 promisc 인지 확인 필요 (스니핑, 모니터링 여부)&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;사용자/그룹 확인
        &lt;ul&gt;
          &lt;li&gt;공격자에 의해서 추가된 유저나 그룹이 있는지 확인
            &lt;ul&gt;
              &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;net user&lt;/code&gt; : 시스템에 존재하는 모든 계정 출력&lt;/li&gt;
              &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;net localgroup&lt;/code&gt; : 시스템에 있는 모든 그룹정보 출력&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;공유, 로그인 정보 확인
        &lt;ul&gt;
          &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;net&lt;/code&gt; : 시스템의 공유 정보, 현재 로그인되어 있는 사용자 정보 확인&lt;/li&gt;
          &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;nbtstat&lt;/code&gt; : NBT (Net Bios) 에 의해서 연결된 정보를 확인
            &lt;ul&gt;
              &lt;li&gt;NBT (Net Bios over TCP/IP)
                &lt;ul&gt;
                  &lt;li&gt;TCP/IP 사용 기기의 고유 IP주소가 있으면 통신이 가능&lt;/li&gt;
                  &lt;li&gt;Windows OS 의 경우 NetBios 기술을 사용
                    &lt;ul&gt;
                      &lt;li&gt;NetBios 의 이름 (컴퓨터 이름) 을 IP 보다 더 중요하게 사용&lt;/li&gt;
                      &lt;li&gt;NETBIOS 는 네트워크 통신을 위한 기본적인 명령어 세트&lt;/li&gt;
                      &lt;li&gt;BIOS : Basic Input Output System&lt;/li&gt;
                    &lt;/ul&gt;
                  &lt;/li&gt;
                  &lt;li&gt;NetBIOS 의 기능
                    &lt;ul&gt;
                      &lt;li&gt;컴퓨터 이름(네트워크 참여 시 식별자 이름) 등록/해제 (이름 삭제를 통한 네트워크 이탈)&lt;/li&gt;
                      &lt;li&gt;세션 서비스 - Session 지향 (1:1통신) 의 통신서비스 제공 (22:10)&lt;/li&gt;
                      &lt;li&gt;데이터그램 서비스 - Datagram 지향 (상대에게 일방적으로 데이터를 보냄) 의 통신서비스 제공&lt;/li&gt;
                    &lt;/ul&gt;
                  &lt;/li&gt;
                  &lt;li&gt;NetBIOS 통신
                    &lt;ul&gt;
                      &lt;li&gt;NetBIOS 이름 등록 (네트워크 참여)
                        &lt;ul&gt;
                          &lt;li&gt;중앙집중식 네트워크 관리서버가 존재하지 않음&lt;/li&gt;
                          &lt;li&gt;시스템이 켜지면 시스템이 가지고 있는 컴퓨터 이름을 Broadcasting
                            &lt;ul&gt;
                              &lt;li&gt;Network 상의 모든 컴퓨터에 통보&lt;/li&gt;
                              &lt;li&gt;이름 충돌이 없으면 사용&lt;/li&gt;
                            &lt;/ul&gt;
                          &lt;/li&gt;
                        &lt;/ul&gt;
                      &lt;/li&gt;
                      &lt;li&gt;NetBIOS 이름을 사용해서 통신상대를 식별, 통신 패킷을 송신&lt;/li&gt;
                      &lt;li&gt;시스템 종료시 NetBIOS 이름 삭제 (네트워크 이탈)&lt;/li&gt;
                    &lt;/ul&gt;
                  &lt;/li&gt;
                  &lt;li&gt;예전에는 순수한 NetBIOS 인터페이스를 사용하였으나 최근에는 컴퓨터 이름으로 사용&lt;/li&gt;
                  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;nbtstat -c&lt;/code&gt; : NBT에 연결된 세션정보 출력&lt;/li&gt;
                &lt;/ul&gt;
              &lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;윈도우 감사정책이 설정되어 있는 경우 &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ntlast&lt;/code&gt; (추가다운로드-foundstone.com) 명령어 사용
            &lt;ul&gt;
              &lt;li&gt;로그인/로그오프 성공, 실패 여부 확인&lt;/li&gt;
              &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ntlast -f&lt;/code&gt; : 원격 접속 로그정보 출력&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;net share&lt;/code&gt; : 시스템 공유정보 출력&lt;/li&gt;
          &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;net session&lt;/code&gt; : 공유자원에 접속된 컴퓨터 정보 출력&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Batch 스크립트를 만들어 결과를 파일로 저장하거나 자동화된 도구를 사용&lt;/li&gt;
&lt;/ul&gt;</content><author><name>HY03</name><email>hyunik03@gmail.com</email></author><category term="IS_Certification" /><category term="정보보안기사" /><category term="윈도우 침해사고" /><summary type="html">윈도우 침해사고 초기분석 초기분석 : 현재 피해시스템의 상황을 빠른 시간 안에 파악한다. (포렌식 툴을 사용하지 않는다는 가정 / 커맨드에서 실행) 시스템 시간 확인 공격자가 시스템 시간을 변경할 수 있음 date /T, time /T 등의 명령어 사용 uptime : 시스템의 부팅시간 정보를 알려줌 (추가 다운로드 필요-sysinternals.com) 시스템 정보 psinfo -h -s : OS 기본정보, 보안 업데이트 정보, 설치된 S/W 정보 (추가 다운로드 필요-sysinternals.com) 프로세스 정보 확인 (휘발성 증거) 공격자가 실행시킨 악성프로그램 확인 실행 프로세스명 프로세스 실행 파일 위치 프로세스 커맨드라인 프로세스 실행시간 프로세스 가 참조하고 있는 DLL 및 기타 파일 pslist 명령어사용 (추가 다운로드 필요-sysinternals.com) 현재 구동중인 프로세스 목록 조회 프로세스 실행시간 확인 -t : 트리구조 옵션 (자식프로세스) 정상적인 윈도우 프로세스인지 확인하기 위한 용도 흔히 볼수 없었던 프로세스명은 악성코드일 확률이 있음 정상파일로 위장을 해서 악성프로그램 실행을 하는 경우 실행파일 위치를 확인해야 함 프로그램들이 사용하는 DLL 을 자세히 점검할 필요가 있음 listdlls (추가 다운로드 필요-sysinternals.com) : dll 경로, 사이즈, 버전정보 프로세스들이 사용하는 DLL 정보 출력 handle 명령어 사용 (추가 다운로드 필요-sysinternals.com) 악성 봇 프로그램 같은 경우 프로세스가 참조하는 파일(설정파일 등)을 출력해야 함 네트워크 정보 확인 (휘발성 증거) - 공격자의 흔적 추적 피해시스템의 네트워크 정보 서비스를 열고 있는 어플리케이션 정보 서비스에 연결되어 있는 세션 정보 ipconfig /all 명령어 사용 - IP 확인 netstat -an 프로토콜의 상태 확인 IP 기반의 네트워크 연결 정보 확인 현재 열려있는 포트 포트에 연결되어 있는 IP 정보 시스템이 사용하지 않는 포트가 LISTENING 상태로 있는지 확인 telnet 이나 nc 등의 명령어로 어떤 어플리케이션이 해당 포트를 구동중인지 확인 fpont (추가 다운로드 필요-foundstone.com) 해당 포트에서 사용하고 있는 프로세스 확인 가능 promiscdetect (추가 다운로드 필요 - tesecurity.nu) NIC 카드가 promisc 인지 확인 필요 (스니핑, 모니터링 여부) 사용자/그룹 확인 공격자에 의해서 추가된 유저나 그룹이 있는지 확인 net user : 시스템에 존재하는 모든 계정 출력 net localgroup : 시스템에 있는 모든 그룹정보 출력 공유, 로그인 정보 확인 net : 시스템의 공유 정보, 현재 로그인되어 있는 사용자 정보 확인 nbtstat : NBT (Net Bios) 에 의해서 연결된 정보를 확인 NBT (Net Bios over TCP/IP) TCP/IP 사용 기기의 고유 IP주소가 있으면 통신이 가능 Windows OS 의 경우 NetBios 기술을 사용 NetBios 의 이름 (컴퓨터 이름) 을 IP 보다 더 중요하게 사용 NETBIOS 는 네트워크 통신을 위한 기본적인 명령어 세트 BIOS : Basic Input Output System NetBIOS 의 기능 컴퓨터 이름(네트워크 참여 시 식별자 이름) 등록/해제 (이름 삭제를 통한 네트워크 이탈) 세션 서비스 - Session 지향 (1:1통신) 의 통신서비스 제공 (22:10) 데이터그램 서비스 - Datagram 지향 (상대에게 일방적으로 데이터를 보냄) 의 통신서비스 제공 NetBIOS 통신 NetBIOS 이름 등록 (네트워크 참여) 중앙집중식 네트워크 관리서버가 존재하지 않음 시스템이 켜지면 시스템이 가지고 있는 컴퓨터 이름을 Broadcasting Network 상의 모든 컴퓨터에 통보 이름 충돌이 없으면 사용 NetBIOS 이름을 사용해서 통신상대를 식별, 통신 패킷을 송신 시스템 종료시 NetBIOS 이름 삭제 (네트워크 이탈) 예전에는 순수한 NetBIOS 인터페이스를 사용하였으나 최근에는 컴퓨터 이름으로 사용 nbtstat -c : NBT에 연결된 세션정보 출력 윈도우 감사정책이 설정되어 있는 경우 ntlast (추가다운로드-foundstone.com) 명령어 사용 로그인/로그오프 성공, 실패 여부 확인 ntlast -f : 원격 접속 로그정보 출력 net share : 시스템 공유정보 출력 net session : 공유자원에 접속된 컴퓨터 정보 출력 Batch 스크립트를 만들어 결과를 파일로 저장하거나 자동화된 도구를 사용</summary></entry><entry><title type="html">정보보안 - 침해사고 분석 절차</title><link href="https://bluesplatter.com/is_certification/IS-IncidentAnalysis-Procedure/" rel="alternate" type="text/html" title="정보보안 - 침해사고 분석 절차" /><published>2021-12-29T09:00:00+09:00</published><updated>2021-12-29T09:00:00+09:00</updated><id>https://bluesplatter.com/is_certification/IS-IncidentAnalysis-Procedure</id><content type="html" xml:base="https://bluesplatter.com/is_certification/IS-IncidentAnalysis-Procedure/">&lt;h1 id=&quot;침해사고-분석-절차&quot;&gt;침해사고 분석 절차&lt;/h1&gt;
&lt;ul&gt;
  &lt;li&gt;침해사고 분석의 목적
    &lt;ul&gt;
      &lt;li&gt;사고의 수습&lt;/li&gt;
      &lt;li&gt;누가 공격을 하였는지 파악
        &lt;ul&gt;
          &lt;li&gt;데이터 수집 -&amp;gt; 범행 단서 수집&lt;/li&gt;
          &lt;li&gt;법적 소송에 필요한 데이터 : 무결성, 적법성을 유지해야 함&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;수집하는 데이터 정보 종류
        &lt;ul&gt;
          &lt;li&gt;호스트 기반 정보 (증거)
            &lt;ul&gt;
              &lt;li&gt;시스템 시간&lt;/li&gt;
              &lt;li&gt;휘발성 데이터 (우선 수집 대상)
                &lt;ul&gt;
                  &lt;li&gt;수집하기 위해서 Live Response 수행 필요
                    &lt;ul&gt;
                      &lt;li&gt;살아있는 System 에서 휘발성 정보를 수집하는 행위&lt;/li&gt;
                      &lt;li&gt;Initial Live Response : 휘발성 데이터만 수집&lt;/li&gt;
                      &lt;li&gt;In-depth Response : 휘발성 데이터 + 충분한 부가정보 (법적대응에 필요한 정보-무결성,적법) 수집&lt;/li&gt;
                      &lt;li&gt;Full Live Response : Live System 의 완전조사&lt;/li&gt;
                    &lt;/ul&gt;
                  &lt;/li&gt;
                  &lt;li&gt;시스템의 날짜, 시간&lt;/li&gt;
                  &lt;li&gt;시스템에서 현재 동작 중인 어플리케이션&lt;/li&gt;
                  &lt;li&gt;현재 연결된 네트워크 상황&lt;/li&gt;
                  &lt;li&gt;현재 열려진 소켓(포트)&lt;/li&gt;
                  &lt;li&gt;열려진 소켓 상에서 대기하고 있던 어플리케이션&lt;/li&gt;
                  &lt;li&gt;네트워크 인터페이스의 상태&lt;/li&gt;
                  &lt;li&gt;메모리 정보, 현재 열려있는 파일, 시스템 패치 상황&lt;/li&gt;
                &lt;/ul&gt;
              &lt;/li&gt;
              &lt;li&gt;시스템의 모든 파일들의 생성,수정 시간/날짜 정보
                &lt;ul&gt;
                  &lt;li&gt;공격자에 의한 Upload 된 파일 식별을 위함&lt;/li&gt;
                  &lt;li&gt;시스템으로 Upload / Download 된 파일 식별&lt;/li&gt;
                &lt;/ul&gt;
              &lt;/li&gt;
              &lt;li&gt;출처 미확인 파일&lt;/li&gt;
              &lt;li&gt;디스크 백업 수집&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;네트워크 기반 정보 (증거)
            &lt;ul&gt;
              &lt;li&gt;IDS 로그 수집&lt;/li&gt;
              &lt;li&gt;IPS 로그 수집&lt;/li&gt;
              &lt;li&gt;라우터 로그 수집&lt;/li&gt;
              &lt;li&gt;방화벽 로그 수집&lt;/li&gt;
              &lt;li&gt;인증서버 로그 수집&lt;/li&gt;
              &lt;li&gt;중앙호스트 (Syslog) 로부터의 원격로그 수집&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;일반적 증거
            &lt;ul&gt;
              &lt;li&gt;증인으로부터의 수집&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;증거 수집 전략 (네트워크)
    &lt;ul&gt;
      &lt;li&gt;장비를 종료/재부팅 하는 것을 피함
        &lt;ul&gt;
          &lt;li&gt;네트워크 기반의 증거들이 장비의 메모리에 휘발성 데이터로 존재&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;네트워크를 통한 접근 (원격접근) 보다 콘솔을 통해 연결
        &lt;ul&gt;
          &lt;li&gt;조사의 흔적을 최소화 하기 위함&lt;/li&gt;
          &lt;li&gt;원격접근은 Traffic 을 발생시킴&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;시스템 시간 정보 기록
        &lt;ul&gt;
          &lt;li&gt;네트워크 장비와 신뢰할 만한 시스템의 시간 차이를 확인&lt;/li&gt;
          &lt;li&gt;대부분의 포렌식 툴은 로그의 시간 차이를 조정하는 기능이 제공되지 않음
            &lt;ul&gt;
              &lt;li&gt;수동으로 비교, Script 를 만들어 사용&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;휘발성 정도에 따라서 증거를 수집
        &lt;ul&gt;
          &lt;li&gt;휘발성이 높은 증거부터 수집&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;조사활동을 모두 기록
        &lt;ul&gt;
          &lt;li&gt;실수에 의한 기록을 남기더라도 가능한한 모든 기록을 남기는 것이 중요&lt;/li&gt;
          &lt;li&gt;GUI 접속은 화면캡처나 사진 등&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;네트워크 기반의 증거 수집
    &lt;ul&gt;
      &lt;li&gt;패시브 증거 수집 : 계층 이상의 상위 계층에 데이터를 송신하지 않고 포렌식 용 증거를 수집하는 방법
        &lt;ul&gt;
          &lt;li&gt;케이블을 이용하여 감청
            &lt;ul&gt;
              &lt;li&gt;트래픽 스니핑 툴 사용&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;주파수 감청 (무선)
            &lt;ul&gt;
              &lt;li&gt;무선 AP Mac 주소&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;허브 (1계층) / 스위치 (2계층) 이용
            &lt;ul&gt;
              &lt;li&gt;포트 미러링 : 하나 이상의 포트에서 다른 포트의 트래픽을 복제&lt;/li&gt;
              &lt;li&gt;MAC 플러딩 : 다량의 맥 주소를 사용하는 임의의 이더넷 패킷을 보내 CAM 테이블을 채워, MAC 포트를 연결할 수 없게 되었을 때 모든 포트에 트래픽을 전송&lt;/li&gt;
              &lt;li&gt;ARP 스푸핑 : 공격자의 MAC 주소를 희생자의 IP와 매핑 시켜 거짓 ARP 패킷을 송신&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;트래픽 수집 소프트웨어 사용
            &lt;ul&gt;
              &lt;li&gt;libpcap
                &lt;ul&gt;
                  &lt;li&gt;네트워크 상의 인터페이스에 대한 데이터링크 계층의 프레임을 캡쳐&lt;/li&gt;
                &lt;/ul&gt;
              &lt;/li&gt;
              &lt;li&gt;winpcap
                &lt;ul&gt;
                  &lt;li&gt;윈도우에서 돌아가는 libpcap&lt;/li&gt;
                &lt;/ul&gt;
              &lt;/li&gt;
              &lt;li&gt;패킷스니퍼
                &lt;ul&gt;
                  &lt;li&gt;libpcap 기반 동작&lt;/li&gt;
                &lt;/ul&gt;
              &lt;/li&gt;
              &lt;li&gt;tcpdump
                &lt;ul&gt;
                  &lt;li&gt;리눅스 기반 플랫폼에서 동작 / 윈도우의 경우 windump (winpcap)&lt;/li&gt;
                  &lt;li&gt;libpcap 기반 동작&lt;/li&gt;
                  &lt;li&gt;트래픽 캡처 / 필터링&lt;/li&gt;
                &lt;/ul&gt;
              &lt;/li&gt;
              &lt;li&gt;wireshark
                &lt;ul&gt;
                  &lt;li&gt;트래픽 캡처 / 필터링&lt;/li&gt;
                  &lt;li&gt;그래픽 기반 툴&lt;/li&gt;
                &lt;/ul&gt;
              &lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;액티브 (인터렉티브) 증거 수집
        &lt;ul&gt;
          &lt;li&gt;휘발성 증거는 시스템이 동작하고 네트워크가 연결된 상태에서 수집&lt;/li&gt;
          &lt;li&gt;네트워크 상의 스테이션과 상호 작용하여 증거를 수집하는 방법
            &lt;ul&gt;
              &lt;li&gt;콘솔로 직접 연결하는 방법
                &lt;ul&gt;
                  &lt;li&gt;트래픽이 발생하지 않음 (흔적이 덜 남게 됨)&lt;/li&gt;
                &lt;/ul&gt;
              &lt;/li&gt;
              &lt;li&gt;SSH / SCP,SFTP 를 이용하는 방법
                &lt;ul&gt;
                  &lt;li&gt;Telnet 이나 Rlogin, TFTP 같은 취약한 원격 연결 툴 (Plain Text 전송) 보다 감청을 당해도 안전&lt;/li&gt;
                &lt;/ul&gt;
              &lt;/li&gt;
              &lt;li&gt;SNMP 프로토콜 사용
                &lt;ul&gt;
                  &lt;li&gt;포렌식에서 사용되는 대부분의 툴이 SNMP 프로토콜을 사용&lt;/li&gt;
                &lt;/ul&gt;
              &lt;/li&gt;
              &lt;li&gt;SSL / TLS 를 이용한 웹데이터 수집&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;네트워크 접근을 하지 않고 조사하는 방법
            &lt;ul&gt;
              &lt;li&gt;포트 스캐닝&lt;/li&gt;
              &lt;li&gt;취약점 조사&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;데이터 분석 절차
    &lt;ul&gt;
      &lt;li&gt;포렌식 이미징 작업 : 사본 만들기&lt;/li&gt;
      &lt;li&gt;데이터의 준비
        &lt;ul&gt;
          &lt;li&gt;수집 이미지의 사본 제작&lt;/li&gt;
          &lt;li&gt;파일 리스트 생성&lt;/li&gt;
          &lt;li&gt;삭제 파일 복구&lt;/li&gt;
          &lt;li&gt;비 할당 공간 복구&lt;/li&gt;
          &lt;li&gt;파일 시그니처 분석 수행&lt;/li&gt;
          &lt;li&gt;알려진 시스템 파일 식별&lt;/li&gt;
          &lt;li&gt;통계적인 데이터 파티션 테이블 파일 시스템 수행&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;데이터의 분석
        &lt;ul&gt;
          &lt;li&gt;이메일과 첨부파일 뽑아내기&lt;/li&gt;
          &lt;li&gt;브라우저 히스토리 파일 재검토&lt;/li&gt;
          &lt;li&gt;설치된 어플리케이션 재검토&lt;/li&gt;
          &lt;li&gt;수집된 데이터 재검토&lt;/li&gt;
          &lt;li&gt;적절한 스트링 검색&lt;/li&gt;
          &lt;li&gt;모든 네트워크 기반 증거 재검토&lt;/li&gt;
          &lt;li&gt;소프트웨어 분석 수행&lt;/li&gt;
          &lt;li&gt;암호화된 파일 식별과 해독&lt;/li&gt;
          &lt;li&gt;파일 대 파일 재검토 수행&lt;/li&gt;
          &lt;li&gt;특성화된 분석 수행&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;</content><author><name>HY03</name><email>hyunik03@gmail.com</email></author><category term="IS_Certification" /><category term="정보보안기사" /><category term="침해사고" /><summary type="html">침해사고 분석 절차 침해사고 분석의 목적 사고의 수습 누가 공격을 하였는지 파악 데이터 수집 -&amp;gt; 범행 단서 수집 법적 소송에 필요한 데이터 : 무결성, 적법성을 유지해야 함 수집하는 데이터 정보 종류 호스트 기반 정보 (증거) 시스템 시간 휘발성 데이터 (우선 수집 대상) 수집하기 위해서 Live Response 수행 필요 살아있는 System 에서 휘발성 정보를 수집하는 행위 Initial Live Response : 휘발성 데이터만 수집 In-depth Response : 휘발성 데이터 + 충분한 부가정보 (법적대응에 필요한 정보-무결성,적법) 수집 Full Live Response : Live System 의 완전조사 시스템의 날짜, 시간 시스템에서 현재 동작 중인 어플리케이션 현재 연결된 네트워크 상황 현재 열려진 소켓(포트) 열려진 소켓 상에서 대기하고 있던 어플리케이션 네트워크 인터페이스의 상태 메모리 정보, 현재 열려있는 파일, 시스템 패치 상황 시스템의 모든 파일들의 생성,수정 시간/날짜 정보 공격자에 의한 Upload 된 파일 식별을 위함 시스템으로 Upload / Download 된 파일 식별 출처 미확인 파일 디스크 백업 수집 네트워크 기반 정보 (증거) IDS 로그 수집 IPS 로그 수집 라우터 로그 수집 방화벽 로그 수집 인증서버 로그 수집 중앙호스트 (Syslog) 로부터의 원격로그 수집 일반적 증거 증인으로부터의 수집 증거 수집 전략 (네트워크) 장비를 종료/재부팅 하는 것을 피함 네트워크 기반의 증거들이 장비의 메모리에 휘발성 데이터로 존재 네트워크를 통한 접근 (원격접근) 보다 콘솔을 통해 연결 조사의 흔적을 최소화 하기 위함 원격접근은 Traffic 을 발생시킴 시스템 시간 정보 기록 네트워크 장비와 신뢰할 만한 시스템의 시간 차이를 확인 대부분의 포렌식 툴은 로그의 시간 차이를 조정하는 기능이 제공되지 않음 수동으로 비교, Script 를 만들어 사용 휘발성 정도에 따라서 증거를 수집 휘발성이 높은 증거부터 수집 조사활동을 모두 기록 실수에 의한 기록을 남기더라도 가능한한 모든 기록을 남기는 것이 중요 GUI 접속은 화면캡처나 사진 등 네트워크 기반의 증거 수집 패시브 증거 수집 : 계층 이상의 상위 계층에 데이터를 송신하지 않고 포렌식 용 증거를 수집하는 방법 케이블을 이용하여 감청 트래픽 스니핑 툴 사용 주파수 감청 (무선) 무선 AP Mac 주소 허브 (1계층) / 스위치 (2계층) 이용 포트 미러링 : 하나 이상의 포트에서 다른 포트의 트래픽을 복제 MAC 플러딩 : 다량의 맥 주소를 사용하는 임의의 이더넷 패킷을 보내 CAM 테이블을 채워, MAC 포트를 연결할 수 없게 되었을 때 모든 포트에 트래픽을 전송 ARP 스푸핑 : 공격자의 MAC 주소를 희생자의 IP와 매핑 시켜 거짓 ARP 패킷을 송신 트래픽 수집 소프트웨어 사용 libpcap 네트워크 상의 인터페이스에 대한 데이터링크 계층의 프레임을 캡쳐 winpcap 윈도우에서 돌아가는 libpcap 패킷스니퍼 libpcap 기반 동작 tcpdump 리눅스 기반 플랫폼에서 동작 / 윈도우의 경우 windump (winpcap) libpcap 기반 동작 트래픽 캡처 / 필터링 wireshark 트래픽 캡처 / 필터링 그래픽 기반 툴 액티브 (인터렉티브) 증거 수집 휘발성 증거는 시스템이 동작하고 네트워크가 연결된 상태에서 수집 네트워크 상의 스테이션과 상호 작용하여 증거를 수집하는 방법 콘솔로 직접 연결하는 방법 트래픽이 발생하지 않음 (흔적이 덜 남게 됨) SSH / SCP,SFTP 를 이용하는 방법 Telnet 이나 Rlogin, TFTP 같은 취약한 원격 연결 툴 (Plain Text 전송) 보다 감청을 당해도 안전 SNMP 프로토콜 사용 포렌식에서 사용되는 대부분의 툴이 SNMP 프로토콜을 사용 SSL / TLS 를 이용한 웹데이터 수집 네트워크 접근을 하지 않고 조사하는 방법 포트 스캐닝 취약점 조사 데이터 분석 절차 포렌식 이미징 작업 : 사본 만들기 데이터의 준비 수집 이미지의 사본 제작 파일 리스트 생성 삭제 파일 복구 비 할당 공간 복구 파일 시그니처 분석 수행 알려진 시스템 파일 식별 통계적인 데이터 파티션 테이블 파일 시스템 수행 데이터의 분석 이메일과 첨부파일 뽑아내기 브라우저 히스토리 파일 재검토 설치된 어플리케이션 재검토 수집된 데이터 재검토 적절한 스트링 검색 모든 네트워크 기반 증거 재검토 소프트웨어 분석 수행 암호화된 파일 식별과 해독 파일 대 파일 재검토 수행 특성화된 분석 수행</summary></entry><entry><title type="html">정보보안 - 침해사고 개요</title><link href="https://bluesplatter.com/is_certification/IS-IncidentAnalysis-Outline/" rel="alternate" type="text/html" title="정보보안 - 침해사고 개요" /><published>2021-12-28T09:00:00+09:00</published><updated>2021-12-28T09:00:00+09:00</updated><id>https://bluesplatter.com/is_certification/IS-IncidentAnalysis-Outline</id><content type="html" xml:base="https://bluesplatter.com/is_certification/IS-IncidentAnalysis-Outline/">&lt;h1 id=&quot;침해사고-개요&quot;&gt;침해사고 개요&lt;/h1&gt;
&lt;ul&gt;
  &lt;li&gt;침해사고란?
    &lt;ul&gt;
      &lt;li&gt;정보통신망 이용촉진 및 정보보호 등에 관한 법률 제2조 1항 7조
        &lt;ul&gt;
          &lt;li&gt;“침해사고”란 해킹, 컴퓨터바이러스, 논리폭탄, 메일폭탄, 서비스 거부 또는 고출력 전자기파 등의 방법으로 정보통신망 또는 이와 관련된 정보시스템을 공격하는 행위를 하여 발생한 사태를 말한다.&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;바이러스, 트로이목마, 웜, 백도어, 악성코드 등을 이용한 공격&lt;/li&gt;
      &lt;li&gt;비인가된 System, 파일, 네트워크 정보 접근&lt;/li&gt;
      &lt;li&gt;비인가된 사용자가 서비스를 무단 이용&lt;/li&gt;
      &lt;li&gt;서비스 거부 등 네트워크, 시스템의 마비, 파괴&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;침해사고 대응 7단게
    &lt;ul&gt;
      &lt;li&gt;사고 발생,발견 또는 발생 시점 이전 단게
        &lt;ul&gt;
          &lt;li&gt;사고 전 준비&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;침해 사고 발생
        &lt;ul&gt;
          &lt;li&gt;사고 탐지&lt;/li&gt;
          &lt;li&gt;초기 대응 : 기록, 침해사고 대응팀에 신고, 해당 부서에 통지&lt;/li&gt;
          &lt;li&gt;대응 전략 체게화 : 최적의 전략을 결정 (정책, 기술, 법…)&lt;/li&gt;
          &lt;li&gt;사고 조사 : 언제, 누구에 의해서, 피해 규모는 어느정도인지, 피해확산을 어떻게 방지할 것인지, 최소화 방안, 재발방지
            &lt;ul&gt;
              &lt;li&gt;데이터 수집 : 증거의 완벽한 확보&lt;/li&gt;
              &lt;li&gt;데이터 분석&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;보고서 작성 : 경영진이 이해할 수 있는 내용으로 작성&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;복구, 해결 과정&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;KISA 분석 요청 시
    &lt;ul&gt;
      &lt;li&gt;악성코드, 프로세스 등을 제거하면 안됌&lt;/li&gt;
      &lt;li&gt;반드시 제거해야 하는 경우
        &lt;ul&gt;
          &lt;li&gt;악성파일 경로 확보&lt;/li&gt;
          &lt;li&gt;악성파일 백업&lt;/li&gt;
          &lt;li&gt;MAC Time 확보 (생성, 접근, 수정시간)&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&quot;사고-유형별-점검항목&quot;&gt;사고 유형별 점검항목&lt;/h1&gt;
&lt;ul&gt;
  &lt;li&gt;공통
    &lt;ul&gt;
      &lt;li&gt;계정
        &lt;ul&gt;
          &lt;li&gt;사용하지 않는 계정 확인 -&amp;gt; 삭제&lt;/li&gt;
          &lt;li&gt;숨겨진 계정 확인 -&amp;gt; 삭제&lt;/li&gt;
          &lt;li&gt;윈도우 : 관리도구 -&amp;gt; 컴퓨터 관리도구 -&amp;gt; 로컬사용자 및 그룹 -&amp;gt; 사용자&lt;/li&gt;
          &lt;li&gt;리눅스 : &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc/passwd&lt;/code&gt; 확인
            &lt;ul&gt;
              &lt;li&gt;패스워드가 없는 계정&lt;/li&gt;
              &lt;li&gt;/bin/bash 쉘 확인&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;로그파일
        &lt;ul&gt;
          &lt;li&gt;이벤트로그, 시스템로그 변조 유무 확인&lt;/li&gt;
          &lt;li&gt;윈도우 : 관리도구 -&amp;gt; 컴퓨터관리 -&amp;gt; 이벤트뷰어&lt;/li&gt;
          &lt;li&gt;리눅스
            &lt;ul&gt;
              &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/var/log/secure&lt;/code&gt;&lt;/li&gt;
              &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/var/log/meesage&lt;/code&gt;&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;웹쉘
        &lt;ul&gt;
          &lt;li&gt;공격자가 원격에서 웹서버의 악의적 명령을 수행할 수 있도록 만들어진 파일&lt;/li&gt;
          &lt;li&gt;웹쉘 Signature 점검&lt;/li&gt;
          &lt;li&gt;asp, aspx, php, jsp, jpeg 등&lt;/li&gt;
          &lt;li&gt;업로드된 경로를 파악, 취약점을 제거&lt;/li&gt;
          &lt;li&gt;WHISTL 프로그램 사용하여 탐지&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;백도어
        &lt;ul&gt;
          &lt;li&gt;nmap 이용 하여 의심가는 포트 확인&lt;/li&gt;
          &lt;li&gt;netstat, TCPview 등 이용&lt;/li&gt;
          &lt;li&gt;백도어 관련 서비스 삭제
            &lt;ul&gt;
              &lt;li&gt;방화벽 설정 (iptables, hosts.allow, hosts.deny)&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;해당 포트 차단&lt;/li&gt;
          &lt;li&gt;바이너리 변조 확인&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;루트킷
        &lt;ul&gt;
          &lt;li&gt;숨겨진 프로세스, 비정상적 프로세스 확인&lt;/li&gt;
          &lt;li&gt;변조된 파일, System 명령어 확인&lt;/li&gt;
          &lt;li&gt;윈도우 : IceSword&lt;/li&gt;
          &lt;li&gt;리눅스 : Rootkit Hunter, Check Rootkit&lt;/li&gt;
          &lt;li&gt;명령어 무결성 확인, 시스템 재설치 등&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;웹변조 (웹사이트 변조)
    &lt;ul&gt;
      &lt;li&gt;웹페이지
        &lt;ul&gt;
          &lt;li&gt;공통 확인 : index.html, main.html, default.html, index.php, main.php&lt;/li&gt;
          &lt;li&gt;IIS 계열 확인 : index.asp, main.asp, default.asp&lt;/li&gt;
          &lt;li&gt;메인페이지로 설정된 기타 파일 확인&lt;/li&gt;
          &lt;li&gt;웹페이지 내용이 변경된 경우 웹쉘의 감염 여부를 확인해야 함
            &lt;ul&gt;
              &lt;li&gt;WHISTL 프로그램을 통해 웹쉘 감염여부 확인&lt;/li&gt;
              &lt;li&gt;웹쉘이 발견된 경우 접속로그를 통해 웹쉘에 접근한 IP를 확인 / 차단&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;HTTP 메소드
        &lt;ul&gt;
          &lt;li&gt;윈도우 IIS 웹서버 : WebDAV 활성화 여부 확인
            &lt;ul&gt;
              &lt;li&gt;WebDAV : 사용자가 원격으로 서버에 저장되어 있는 파일을 편집, 관리하는 HTTP 확장 기능
                &lt;ul&gt;
                  &lt;li&gt;NAS 클라이언트를 사용해 HDD 드라이브처럼 사용&lt;/li&gt;
                &lt;/ul&gt;
              &lt;/li&gt;
              &lt;li&gt;관리도구 -&amp;gt; IIS 관리 -&amp;gt; 웹서비스 확장&lt;/li&gt;
              &lt;li&gt;활성화 되어 있는 경우 사용중지로 변경&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;리눅스 Apache 웹서버 : &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;httpd.conf&lt;/code&gt; 파일 확인
            &lt;ul&gt;
              &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;&amp;lt;Directory /&amp;gt;&lt;/code&gt; 의 MOVE, PUT 메서드 의 Allow 여부 확인
                &lt;ul&gt;
                  &lt;li&gt;GET, POST 를 제외한 메서드들을 허용하지 않는 것이 바람직함&lt;/li&gt;
                  &lt;li&gt;HEAD : 웹서버 다운유무, 웹서버의 정보를 얻기 위함 (헤더만 전송)&lt;/li&gt;
                  &lt;li&gt;OPTIONS : 시스템에서 지원하는 메서드의 종류를 확인&lt;/li&gt;
                  &lt;li&gt;DELETE, COPY, MOVE&lt;/li&gt;
                  &lt;li&gt;PUT : POST와 유사하나 파일을 변조시킬 수 있음&lt;/li&gt;
                  &lt;li&gt;TRACE : 원격지 서버의 루프백 메시지를 호출하여 사용&lt;/li&gt;
                &lt;/ul&gt;
              &lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;웹로그 : 생성, 수정 시간 확인
        &lt;ul&gt;
          &lt;li&gt;윈도우 : IIS&lt;/li&gt;
          &lt;li&gt;리눅스 : &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/usr/local/apache/logs&lt;/code&gt;&lt;/li&gt;
          &lt;li&gt;웹로그에서 특정 메서드의 사용유무를 확인 : grep&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;IIS, Apache 등의 설정이 변경된 경우
        &lt;ul&gt;
          &lt;li&gt;Admin / root 등 서버관리자 계정 변경 필수&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;악성코드 경유지/유포지
    &lt;ul&gt;
      &lt;li&gt;웹페이지 / 접속 IP
        &lt;ul&gt;
          &lt;li&gt;악성코드 유포지 URL 이 삽입된 페이지를 검출&lt;/li&gt;
          &lt;li&gt;grep 명령어 사용&lt;/li&gt;
          &lt;li&gt;유포 페이지 생성, 수정 시간 확인
            &lt;ul&gt;
              &lt;li&gt;해당 시점 기준 접속 로그, 시스템 로그 등을 분석, 또 다른 침해 여부 확인&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;접속 IP를 통해 좀비 PC를 찾아냄&lt;/li&gt;
          &lt;li&gt;WHISTL 을 이용해 웹쉘 감염 여부 확인, 삭제 조치&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;봇넷 C&amp;amp;C
    &lt;ul&gt;
      &lt;li&gt;네트워크 연결 확인
        &lt;ul&gt;
          &lt;li&gt;윈도우 :
            &lt;ul&gt;
              &lt;li&gt;netstat -an&lt;/li&gt;
              &lt;li&gt;6666,6667 포트 등 의심포트 확인
                &lt;ul&gt;
                  &lt;li&gt;IRC (Internet Relay Chatting) Port (6667,6668)&lt;/li&gt;
                  &lt;li&gt;사용자 몰래 특정 IRC 서버에 접속하도록 함&lt;/li&gt;
                &lt;/ul&gt;
              &lt;/li&gt;
              &lt;li&gt;wireshark 를 통한 패킷 분석&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;리눅스 :
            &lt;ul&gt;
              &lt;li&gt;netstat -an&lt;/li&gt;
              &lt;li&gt;lsof -i&lt;/li&gt;
              &lt;li&gt;tcpdump 를 통한 패킷 분석&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;외부 네트워크와 연결된 백도어 포트가 발견된 경우
        &lt;ul&gt;
          &lt;li&gt;방화벽을 이용해 해당 포트 접근 제한&lt;/li&gt;
          &lt;li&gt;해당 파일 삭제 조치&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;해킹 경유지
    &lt;ul&gt;
      &lt;li&gt;네트워크 연결
        &lt;ul&gt;
          &lt;li&gt;nmap, netstat 등을 활용하여 파악&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;윈도우
        &lt;ul&gt;
          &lt;li&gt;RRAS(Routing and Remote Access Service) 서비스 중지
            &lt;ul&gt;
              &lt;li&gt;내부 네트워크에서 외부 네트워크 연결 시 사용&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;이벤트 로그 분석을 통해 RRAS 를 실행한 서비스, IP를 확인&lt;/li&gt;
          &lt;li&gt;컴퓨터관리 -&amp;gt; 서비스 및 응용프로그램 -&amp;gt; 서비스 -&amp;gt; Routing And Remote Access Service 사용안함&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;리눅스
        &lt;ul&gt;
          &lt;li&gt;PPTP(Point-to-Point Tunneling Protocol) 서비스 중지
            &lt;ul&gt;
              &lt;li&gt;VPN 프로토콜, MS에서 개발&lt;/li&gt;
              &lt;li&gt;윈도우에서 오랫동안 사용&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;시스템 로그를 이용해 PPTP 를 실행한 로그, IP를 확인 (21:37)&lt;/li&gt;
          &lt;li&gt;
            &lt;table&gt;
              &lt;tbody&gt;
                &lt;tr&gt;
                  &lt;td&gt;ps -ef&lt;/td&gt;
                  &lt;td&gt;grep pptpd&lt;/td&gt;
                &lt;/tr&gt;
              &lt;/tbody&gt;
            &lt;/table&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;설치 프로그램
        &lt;ul&gt;
          &lt;li&gt;윈도우 : 제어판 -&amp;gt; 프로그램 추가/제거 -&amp;gt; CCProxy, RealVNC 등의 설치여부 확인&lt;/li&gt;
          &lt;li&gt;리눅스 : Rootkit Hunter 등을 활용&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&quot;사고-유형별-대응전략&quot;&gt;사고 유형별 대응전략&lt;/h1&gt;
&lt;ul&gt;
  &lt;li&gt;DoS 공격
    &lt;ul&gt;
      &lt;li&gt;라우터 재설정 (공격 완화)&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;비인가 사용
    &lt;ul&gt;
      &lt;li&gt;업무용 컴퓨터 오용 -&amp;gt; 포렌식 이미징 작업, 용의자와 면담, 범인 식별, 증거확보&lt;/li&gt;
      &lt;li&gt;징계 결정 (직위, 과거조직 등 고려)&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;파괴 행위
    &lt;ul&gt;
      &lt;li&gt;웹사이트가 손상이 되는 경우&lt;/li&gt;
      &lt;li&gt;복구 필요&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;정보의 도난
    &lt;ul&gt;
      &lt;li&gt;신용카드 도난, 고객정보 유출&lt;/li&gt;
      &lt;li&gt;관련시스템 이미지 확보&lt;/li&gt;
      &lt;li&gt;수사기관 참여&lt;/li&gt;
      &lt;li&gt;도난신고, 법적 대응&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;컴퓨터 침입
    &lt;ul&gt;
      &lt;li&gt;buffer overflow, IIS 등 으로 침입&lt;/li&gt;
      &lt;li&gt;비인가 접속 차단&lt;/li&gt;
      &lt;li&gt;취약점 식별&lt;/li&gt;
      &lt;li&gt;보안 패치&lt;/li&gt;
      &lt;li&gt;범인 식별&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;</content><author><name>HY03</name><email>hyunik03@gmail.com</email></author><category term="IS_Certification" /><category term="정보보안기사" /><category term="침해사고" /><summary type="html">침해사고 개요 침해사고란? 정보통신망 이용촉진 및 정보보호 등에 관한 법률 제2조 1항 7조 “침해사고”란 해킹, 컴퓨터바이러스, 논리폭탄, 메일폭탄, 서비스 거부 또는 고출력 전자기파 등의 방법으로 정보통신망 또는 이와 관련된 정보시스템을 공격하는 행위를 하여 발생한 사태를 말한다. 바이러스, 트로이목마, 웜, 백도어, 악성코드 등을 이용한 공격 비인가된 System, 파일, 네트워크 정보 접근 비인가된 사용자가 서비스를 무단 이용 서비스 거부 등 네트워크, 시스템의 마비, 파괴 침해사고 대응 7단게 사고 발생,발견 또는 발생 시점 이전 단게 사고 전 준비 침해 사고 발생 사고 탐지 초기 대응 : 기록, 침해사고 대응팀에 신고, 해당 부서에 통지 대응 전략 체게화 : 최적의 전략을 결정 (정책, 기술, 법…) 사고 조사 : 언제, 누구에 의해서, 피해 규모는 어느정도인지, 피해확산을 어떻게 방지할 것인지, 최소화 방안, 재발방지 데이터 수집 : 증거의 완벽한 확보 데이터 분석 보고서 작성 : 경영진이 이해할 수 있는 내용으로 작성 복구, 해결 과정 KISA 분석 요청 시 악성코드, 프로세스 등을 제거하면 안됌 반드시 제거해야 하는 경우 악성파일 경로 확보 악성파일 백업 MAC Time 확보 (생성, 접근, 수정시간) 사고 유형별 점검항목 공통 계정 사용하지 않는 계정 확인 -&amp;gt; 삭제 숨겨진 계정 확인 -&amp;gt; 삭제 윈도우 : 관리도구 -&amp;gt; 컴퓨터 관리도구 -&amp;gt; 로컬사용자 및 그룹 -&amp;gt; 사용자 리눅스 : /etc/passwd 확인 패스워드가 없는 계정 /bin/bash 쉘 확인 로그파일 이벤트로그, 시스템로그 변조 유무 확인 윈도우 : 관리도구 -&amp;gt; 컴퓨터관리 -&amp;gt; 이벤트뷰어 리눅스 /var/log/secure /var/log/meesage 웹쉘 공격자가 원격에서 웹서버의 악의적 명령을 수행할 수 있도록 만들어진 파일 웹쉘 Signature 점검 asp, aspx, php, jsp, jpeg 등 업로드된 경로를 파악, 취약점을 제거 WHISTL 프로그램 사용하여 탐지 백도어 nmap 이용 하여 의심가는 포트 확인 netstat, TCPview 등 이용 백도어 관련 서비스 삭제 방화벽 설정 (iptables, hosts.allow, hosts.deny) 해당 포트 차단 바이너리 변조 확인 루트킷 숨겨진 프로세스, 비정상적 프로세스 확인 변조된 파일, System 명령어 확인 윈도우 : IceSword 리눅스 : Rootkit Hunter, Check Rootkit 명령어 무결성 확인, 시스템 재설치 등 웹변조 (웹사이트 변조) 웹페이지 공통 확인 : index.html, main.html, default.html, index.php, main.php IIS 계열 확인 : index.asp, main.asp, default.asp 메인페이지로 설정된 기타 파일 확인 웹페이지 내용이 변경된 경우 웹쉘의 감염 여부를 확인해야 함 WHISTL 프로그램을 통해 웹쉘 감염여부 확인 웹쉘이 발견된 경우 접속로그를 통해 웹쉘에 접근한 IP를 확인 / 차단 HTTP 메소드 윈도우 IIS 웹서버 : WebDAV 활성화 여부 확인 WebDAV : 사용자가 원격으로 서버에 저장되어 있는 파일을 편집, 관리하는 HTTP 확장 기능 NAS 클라이언트를 사용해 HDD 드라이브처럼 사용 관리도구 -&amp;gt; IIS 관리 -&amp;gt; 웹서비스 확장 활성화 되어 있는 경우 사용중지로 변경 리눅스 Apache 웹서버 : httpd.conf 파일 확인 &amp;lt;Directory /&amp;gt; 의 MOVE, PUT 메서드 의 Allow 여부 확인 GET, POST 를 제외한 메서드들을 허용하지 않는 것이 바람직함 HEAD : 웹서버 다운유무, 웹서버의 정보를 얻기 위함 (헤더만 전송) OPTIONS : 시스템에서 지원하는 메서드의 종류를 확인 DELETE, COPY, MOVE PUT : POST와 유사하나 파일을 변조시킬 수 있음 TRACE : 원격지 서버의 루프백 메시지를 호출하여 사용 웹로그 : 생성, 수정 시간 확인 윈도우 : IIS 리눅스 : /usr/local/apache/logs 웹로그에서 특정 메서드의 사용유무를 확인 : grep IIS, Apache 등의 설정이 변경된 경우 Admin / root 등 서버관리자 계정 변경 필수 악성코드 경유지/유포지 웹페이지 / 접속 IP 악성코드 유포지 URL 이 삽입된 페이지를 검출 grep 명령어 사용 유포 페이지 생성, 수정 시간 확인 해당 시점 기준 접속 로그, 시스템 로그 등을 분석, 또 다른 침해 여부 확인 접속 IP를 통해 좀비 PC를 찾아냄 WHISTL 을 이용해 웹쉘 감염 여부 확인, 삭제 조치 봇넷 C&amp;amp;C 네트워크 연결 확인 윈도우 : netstat -an 6666,6667 포트 등 의심포트 확인 IRC (Internet Relay Chatting) Port (6667,6668) 사용자 몰래 특정 IRC 서버에 접속하도록 함 wireshark 를 통한 패킷 분석 리눅스 : netstat -an lsof -i tcpdump 를 통한 패킷 분석 외부 네트워크와 연결된 백도어 포트가 발견된 경우 방화벽을 이용해 해당 포트 접근 제한 해당 파일 삭제 조치 해킹 경유지 네트워크 연결 nmap, netstat 등을 활용하여 파악 윈도우 RRAS(Routing and Remote Access Service) 서비스 중지 내부 네트워크에서 외부 네트워크 연결 시 사용 이벤트 로그 분석을 통해 RRAS 를 실행한 서비스, IP를 확인 컴퓨터관리 -&amp;gt; 서비스 및 응용프로그램 -&amp;gt; 서비스 -&amp;gt; Routing And Remote Access Service 사용안함 리눅스 PPTP(Point-to-Point Tunneling Protocol) 서비스 중지 VPN 프로토콜, MS에서 개발 윈도우에서 오랫동안 사용 시스템 로그를 이용해 PPTP 를 실행한 로그, IP를 확인 (21:37) ps -ef grep pptpd 설치 프로그램 윈도우 : 제어판 -&amp;gt; 프로그램 추가/제거 -&amp;gt; CCProxy, RealVNC 등의 설치여부 확인 리눅스 : Rootkit Hunter 등을 활용</summary></entry></feed>